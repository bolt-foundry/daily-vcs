/* esm.sh - esbuild bundle(@neondatabase/serverless@0.9.1) denonext production */
var Yt=Object.create,me=Object.defineProperty,Zt=Object.getOwnPropertyDescriptor,Jt=Object.getOwnPropertyNames,Xt=Object.getPrototypeOf,er=Object.prototype.hasOwnProperty,tr=(E,f,a)=>f in E?me(E,f,{enumerable:!0,configurable:!0,writable:!0,value:a}):E[f]=a,l=(E,f)=>me(E,"name",{value:f,configurable:!0}),ie=(E,f)=>()=>(E&&(f=E(E=0)),f),H=(E,f)=>()=>(f||E((f={exports:{}}).exports,f),f.exports),ue=(E,f)=>{for(var a in f)me(E,a,{get:f[a],enumerable:!0})},ut=(E,f,a,h)=>{if(f&&typeof f=="object"||typeof f=="function")for(let i of Jt(f))!er.call(E,i)&&i!==a&&me(E,i,{get:()=>f[i],enumerable:!(h=Zt(f,i))||h.enumerable});return E},Ee=(E,f,a)=>(a=E!=null?Yt(Xt(E)):{},ut(f||!E||!E.__esModule?me(a,"default",{value:E,enumerable:!0}):a,E)),te=E=>ut(me({},"__esModule",{value:!0}),E),z=(E,f,a)=>(tr(E,typeof f!="symbol"?f+"":f,a),a),rr=H(E=>{"use strict";Q(),E.byteLength=d,E.toByteArray=_,E.fromByteArray=w;var f=[],a=[],h=typeof Uint8Array<"u"?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(n=0,u=i.length;n<u;++n)f[n]=i[n],a[i.charCodeAt(n)]=n;var n,u;a[45]=62,a[95]=63;function s(c){var t=c.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=c.indexOf("=");p===-1&&(p=t);var g=p===t?0:4-p%4;return[p,g]}l(s,"getLens");function d(c){var t=s(c),p=t[0],g=t[1];return(p+g)*3/4-g}l(d,"byteLength");function I(c,t,p){return(t+p)*3/4-p}l(I,"_byteLength");function _(c){var t,p=s(c),g=p[0],m=p[1],b=new h(I(c,g,m)),T=0,x=m>0?g-4:g,v;for(v=0;v<x;v+=4)t=a[c.charCodeAt(v)]<<18|a[c.charCodeAt(v+1)]<<12|a[c.charCodeAt(v+2)]<<6|a[c.charCodeAt(v+3)],b[T++]=t>>16&255,b[T++]=t>>8&255,b[T++]=t&255;return m===2&&(t=a[c.charCodeAt(v)]<<2|a[c.charCodeAt(v+1)]>>4,b[T++]=t&255),m===1&&(t=a[c.charCodeAt(v)]<<10|a[c.charCodeAt(v+1)]<<4|a[c.charCodeAt(v+2)]>>2,b[T++]=t>>8&255,b[T++]=t&255),b}l(_,"toByteArray");function S(c){return f[c>>18&63]+f[c>>12&63]+f[c>>6&63]+f[c&63]}l(S,"tripletToBase64");function y(c,t,p){for(var g,m=[],b=t;b<p;b+=3)g=(c[b]<<16&16711680)+(c[b+1]<<8&65280)+(c[b+2]&255),m.push(S(g));return m.join("")}l(y,"encodeChunk");function w(c){for(var t,p=c.length,g=p%3,m=[],b=16383,T=0,x=p-g;T<x;T+=b)m.push(y(c,T,T+b>x?x:T+b));return g===1?(t=c[p-1],m.push(f[t>>2]+f[t<<4&63]+"==")):g===2&&(t=(c[p-2]<<8)+c[p-1],m.push(f[t>>10]+f[t>>4&63]+f[t<<2&63]+"=")),m.join("")}l(w,"fromByteArray")}),nr=H(E=>{Q(),E.read=function(f,a,h,i,n){var u,s,d=n*8-i-1,I=(1<<d)-1,_=I>>1,S=-7,y=h?n-1:0,w=h?-1:1,c=f[a+y];for(y+=w,u=c&(1<<-S)-1,c>>=-S,S+=d;S>0;u=u*256+f[a+y],y+=w,S-=8);for(s=u&(1<<-S)-1,u>>=-S,S+=i;S>0;s=s*256+f[a+y],y+=w,S-=8);if(u===0)u=1-_;else{if(u===I)return s?NaN:(c?-1:1)*(1/0);s=s+Math.pow(2,i),u=u-_}return(c?-1:1)*s*Math.pow(2,u-i)},E.write=function(f,a,h,i,n,u){var s,d,I,_=u*8-n-1,S=(1<<_)-1,y=S>>1,w=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,c=i?0:u-1,t=i?1:-1,p=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(d=isNaN(a)?1:0,s=S):(s=Math.floor(Math.log(a)/Math.LN2),a*(I=Math.pow(2,-s))<1&&(s--,I*=2),s+y>=1?a+=w/I:a+=w*Math.pow(2,1-y),a*I>=2&&(s++,I/=2),s+y>=S?(d=0,s=S):s+y>=1?(d=(a*I-1)*Math.pow(2,n),s=s+y):(d=a*Math.pow(2,y-1)*Math.pow(2,n),s=0));n>=8;f[h+c]=d&255,c+=t,d/=256,n-=8);for(s=s<<n|d,_+=n;_>0;f[h+c]=s&255,c+=t,s/=256,_-=8);f[h+c-t]|=p*128}}),sr=H(E=>{"use strict";Q();var f=rr(),a=nr(),h=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;E.Buffer=s,E.SlowBuffer=m,E.INSPECT_MAX_BYTES=50;var i=2147483647;E.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=n(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function n(){try{let e=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(e,r),e.foo()===42}catch{return!1}}l(n,"typedArraySupport"),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function u(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');let r=new Uint8Array(e);return Object.setPrototypeOf(r,s.prototype),r}l(u,"createBuffer");function s(e,r,o){if(typeof e=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return S(e)}return d(e,r,o)}l(s,"Buffer"),s.poolSize=8192;function d(e,r,o){if(typeof e=="string")return y(e,r);if(ArrayBuffer.isView(e))return c(e);if(e==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(he(e,ArrayBuffer)||e&&he(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(he(e,SharedArrayBuffer)||e&&he(e.buffer,SharedArrayBuffer)))return t(e,r,o);if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let A=e.valueOf&&e.valueOf();if(A!=null&&A!==e)return s.from(A,r,o);let R=p(e);if(R)return R;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]=="function")return s.from(e[Symbol.toPrimitive]("string"),r,o);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}l(d,"from"),s.from=function(e,r,o){return d(e,r,o)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function I(e){if(typeof e!="number")throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}l(I,"assertSize");function _(e,r,o){return I(e),e<=0?u(e):r!==void 0?typeof o=="string"?u(e).fill(r,o):u(e).fill(r):u(e)}l(_,"alloc"),s.alloc=function(e,r,o){return _(e,r,o)};function S(e){return I(e),u(e<0?0:g(e)|0)}l(S,"allocUnsafe"),s.allocUnsafe=function(e){return S(e)},s.allocUnsafeSlow=function(e){return S(e)};function y(e,r){if((typeof r!="string"||r==="")&&(r="utf8"),!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);let o=b(e,r)|0,A=u(o),R=A.write(e,r);return R!==o&&(A=A.slice(0,R)),A}l(y,"fromString");function w(e){let r=e.length<0?0:g(e.length)|0,o=u(r);for(let A=0;A<r;A+=1)o[A]=e[A]&255;return o}l(w,"fromArrayLike");function c(e){if(he(e,Uint8Array)){let r=new Uint8Array(e);return t(r.buffer,r.byteOffset,r.byteLength)}return w(e)}l(c,"fromArrayView");function t(e,r,o){if(r<0||e.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(o||0))throw new RangeError('"length" is outside of buffer bounds');let A;return r===void 0&&o===void 0?A=new Uint8Array(e):o===void 0?A=new Uint8Array(e,r):A=new Uint8Array(e,r,o),Object.setPrototypeOf(A,s.prototype),A}l(t,"fromArrayBuffer");function p(e){if(s.isBuffer(e)){let r=g(e.length)|0,o=u(r);return o.length===0||e.copy(o,0,0,r),o}if(e.length!==void 0)return typeof e.length!="number"||Ce(e.length)?u(0):w(e);if(e.type==="Buffer"&&Array.isArray(e.data))return w(e.data)}l(p,"fromObject");function g(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return e|0}l(g,"checked");function m(e){return+e!=e&&(e=0),s.alloc(+e)}l(m,"SlowBuffer"),s.isBuffer=l(function(e){return e!=null&&e._isBuffer===!0&&e!==s.prototype},"isBuffer"),s.compare=l(function(e,r){if(he(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),he(r,Uint8Array)&&(r=s.from(r,r.offset,r.byteLength)),!s.isBuffer(e)||!s.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let o=e.length,A=r.length;for(let R=0,B=Math.min(o,A);R<B;++R)if(e[R]!==r[R]){o=e[R],A=r[R];break}return o<A?-1:A<o?1:0},"compare"),s.isEncoding=l(function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),s.concat=l(function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return s.alloc(0);let o;if(r===void 0)for(r=0,o=0;o<e.length;++o)r+=e[o].length;let A=s.allocUnsafe(r),R=0;for(o=0;o<e.length;++o){let B=e[o];if(he(B,Uint8Array))R+B.length>A.length?(s.isBuffer(B)||(B=s.from(B)),B.copy(A,R)):Uint8Array.prototype.set.call(A,B,R);else if(s.isBuffer(B))B.copy(A,R);else throw new TypeError('"list" argument must be an Array of Buffers');R+=B.length}return A},"concat");function b(e,r){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||he(e,ArrayBuffer))return e.byteLength;if(typeof e!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let o=e.length,A=arguments.length>2&&arguments[2]===!0;if(!A&&o===0)return 0;let R=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":return Ie(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o*2;case"hex":return o>>>1;case"base64":return Qe(e).length;default:if(R)return A?-1:Ie(e).length;r=(""+r).toLowerCase(),R=!0}}l(b,"byteLength"),s.byteLength=b;function T(e,r,o){let A=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((o===void 0||o>this.length)&&(o=this.length),o<=0)||(o>>>=0,r>>>=0,o<=r))return"";for(e||(e="utf8");;)switch(e){case"hex":return K(this,r,o);case"utf8":case"utf-8":return O(this,r,o);case"ascii":return W(this,r,o);case"latin1":case"binary":return V(this,r,o);case"base64":return F(this,r,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,r,o);default:if(A)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),A=!0}}l(T,"slowToString"),s.prototype._isBuffer=!0;function x(e,r,o){let A=e[r];e[r]=e[o],e[o]=A}l(x,"swap"),s.prototype.swap16=l(function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)x(this,r,r+1);return this},"swap16"),s.prototype.swap32=l(function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)x(this,r,r+3),x(this,r+1,r+2);return this},"swap32"),s.prototype.swap64=l(function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)x(this,r,r+7),x(this,r+1,r+6),x(this,r+2,r+5),x(this,r+3,r+4);return this},"swap64"),s.prototype.toString=l(function(){let e=this.length;return e===0?"":arguments.length===0?O(this,0,e):T.apply(this,arguments)},"toString"),s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=l(function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:s.compare(this,e)===0},"equals"),s.prototype.inspect=l(function(){let e="",r=E.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},"inspect"),h&&(s.prototype[h]=s.prototype.inspect),s.prototype.compare=l(function(e,r,o,A,R){if(he(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),o===void 0&&(o=e?e.length:0),A===void 0&&(A=0),R===void 0&&(R=this.length),r<0||o>e.length||A<0||R>this.length)throw new RangeError("out of range index");if(A>=R&&r>=o)return 0;if(A>=R)return-1;if(r>=o)return 1;if(r>>>=0,o>>>=0,A>>>=0,R>>>=0,this===e)return 0;let B=R-A,D=o-r,Y=Math.min(B,D),re=this.slice(A,R),J=e.slice(r,o);for(let Z=0;Z<Y;++Z)if(re[Z]!==J[Z]){B=re[Z],D=J[Z];break}return B<D?-1:D<B?1:0},"compare");function v(e,r,o,A,R){if(e.length===0)return-1;if(typeof o=="string"?(A=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,Ce(o)&&(o=R?0:e.length-1),o<0&&(o=e.length+o),o>=e.length){if(R)return-1;o=e.length-1}else if(o<0)if(R)o=0;else return-1;if(typeof r=="string"&&(r=s.from(r,A)),s.isBuffer(r))return r.length===0?-1:L(e,r,o,A,R);if(typeof r=="number")return r=r&255,typeof Uint8Array.prototype.indexOf=="function"?R?Uint8Array.prototype.indexOf.call(e,r,o):Uint8Array.prototype.lastIndexOf.call(e,r,o):L(e,[r],o,A,R);throw new TypeError("val must be string, number or Buffer")}l(v,"bidirectionalIndexOf");function L(e,r,o,A,R){let B=1,D=e.length,Y=r.length;if(A!==void 0&&(A=String(A).toLowerCase(),A==="ucs2"||A==="ucs-2"||A==="utf16le"||A==="utf-16le")){if(e.length<2||r.length<2)return-1;B=2,D/=2,Y/=2,o/=2}function re(Z,ee){return B===1?Z[ee]:Z.readUInt16BE(ee*B)}l(re,"read");let J;if(R){let Z=-1;for(J=o;J<D;J++)if(re(e,J)===re(r,Z===-1?0:J-Z)){if(Z===-1&&(Z=J),J-Z+1===Y)return Z*B}else Z!==-1&&(J-=J-Z),Z=-1}else for(o+Y>D&&(o=D-Y),J=o;J>=0;J--){let Z=!0;for(let ee=0;ee<Y;ee++)if(re(e,J+ee)!==re(r,ee)){Z=!1;break}if(Z)return J}return-1}l(L,"arrayIndexOf"),s.prototype.includes=l(function(e,r,o){return this.indexOf(e,r,o)!==-1},"includes"),s.prototype.indexOf=l(function(e,r,o){return v(this,e,r,o,!0)},"indexOf"),s.prototype.lastIndexOf=l(function(e,r,o){return v(this,e,r,o,!1)},"lastIndexOf");function P(e,r,o,A){o=Number(o)||0;let R=e.length-o;A?(A=Number(A),A>R&&(A=R)):A=R;let B=r.length;A>B/2&&(A=B/2);let D;for(D=0;D<A;++D){let Y=parseInt(r.substr(D*2,2),16);if(Ce(Y))return D;e[o+D]=Y}return D}l(P,"hexWrite");function C(e,r,o,A){return we(Ie(r,e.length-o),e,o,A)}l(C,"utf8Write");function k(e,r,o,A){return we(tt(r),e,o,A)}l(k,"asciiWrite");function M(e,r,o,A){return we(Qe(r),e,o,A)}l(M,"base64Write");function N(e,r,o,A){return we(rt(r,e.length-o),e,o,A)}l(N,"ucs2Write"),s.prototype.write=l(function(e,r,o,A){if(r===void 0)A="utf8",o=this.length,r=0;else if(o===void 0&&typeof r=="string")A=r,o=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(o)?(o=o>>>0,A===void 0&&(A="utf8")):(A=o,o=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let R=this.length-r;if((o===void 0||o>R)&&(o=R),e.length>0&&(o<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");let B=!1;for(;;)switch(A){case"hex":return P(this,e,r,o);case"utf8":case"utf-8":return C(this,e,r,o);case"ascii":case"latin1":case"binary":return k(this,e,r,o);case"base64":return M(this,e,r,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r,o);default:if(B)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),B=!0}},"write"),s.prototype.toJSON=l(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function F(e,r,o){return r===0&&o===e.length?f.fromByteArray(e):f.fromByteArray(e.slice(r,o))}l(F,"base64Slice");function O(e,r,o){o=Math.min(e.length,o);let A=[],R=r;for(;R<o;){let B=e[R],D=null,Y=B>239?4:B>223?3:B>191?2:1;if(R+Y<=o){let re,J,Z,ee;switch(Y){case 1:B<128&&(D=B);break;case 2:re=e[R+1],(re&192)===128&&(ee=(B&31)<<6|re&63,ee>127&&(D=ee));break;case 3:re=e[R+1],J=e[R+2],(re&192)===128&&(J&192)===128&&(ee=(B&15)<<12|(re&63)<<6|J&63,ee>2047&&(ee<55296||ee>57343)&&(D=ee));break;case 4:re=e[R+1],J=e[R+2],Z=e[R+3],(re&192)===128&&(J&192)===128&&(Z&192)===128&&(ee=(B&15)<<18|(re&63)<<12|(J&63)<<6|Z&63,ee>65535&&ee<1114112&&(D=ee))}}D===null?(D=65533,Y=1):D>65535&&(D-=65536,A.push(D>>>10&1023|55296),D=56320|D&1023),A.push(D),R+=Y}return q(A)}l(O,"utf8Slice");var U=4096;function q(e){let r=e.length;if(r<=U)return String.fromCharCode.apply(String,e);let o="",A=0;for(;A<r;)o+=String.fromCharCode.apply(String,e.slice(A,A+=U));return o}l(q,"decodeCodePointsArray");function W(e,r,o){let A="";o=Math.min(e.length,o);for(let R=r;R<o;++R)A+=String.fromCharCode(e[R]&127);return A}l(W,"asciiSlice");function V(e,r,o){let A="";o=Math.min(e.length,o);for(let R=r;R<o;++R)A+=String.fromCharCode(e[R]);return A}l(V,"latin1Slice");function K(e,r,o){let A=e.length;(!r||r<0)&&(r=0),(!o||o<0||o>A)&&(o=A);let R="";for(let B=r;B<o;++B)R+=Kt[e[B]];return R}l(K,"hexSlice");function oe(e,r,o){let A=e.slice(r,o),R="";for(let B=0;B<A.length-1;B+=2)R+=String.fromCharCode(A[B]+A[B+1]*256);return R}l(oe,"utf16leSlice"),s.prototype.slice=l(function(e,r){let o=this.length;e=~~e,r=r===void 0?o:~~r,e<0?(e+=o,e<0&&(e=0)):e>o&&(e=o),r<0?(r+=o,r<0&&(r=0)):r>o&&(r=o),r<e&&(r=e);let A=this.subarray(e,r);return Object.setPrototypeOf(A,s.prototype),A},"slice");function X(e,r,o){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+r>o)throw new RangeError("Trying to access beyond buffer length")}l(X,"checkOffset"),s.prototype.readUintLE=s.prototype.readUIntLE=l(function(e,r,o){e=e>>>0,r=r>>>0,o||X(e,r,this.length);let A=this[e],R=1,B=0;for(;++B<r&&(R*=256);)A+=this[e+B]*R;return A},"readUIntLE"),s.prototype.readUintBE=s.prototype.readUIntBE=l(function(e,r,o){e=e>>>0,r=r>>>0,o||X(e,r,this.length);let A=this[e+--r],R=1;for(;r>0&&(R*=256);)A+=this[e+--r]*R;return A},"readUIntBE"),s.prototype.readUint8=s.prototype.readUInt8=l(function(e,r){return e=e>>>0,r||X(e,1,this.length),this[e]},"readUInt8"),s.prototype.readUint16LE=s.prototype.readUInt16LE=l(function(e,r){return e=e>>>0,r||X(e,2,this.length),this[e]|this[e+1]<<8},"readUInt16LE"),s.prototype.readUint16BE=s.prototype.readUInt16BE=l(function(e,r){return e=e>>>0,r||X(e,2,this.length),this[e]<<8|this[e+1]},"readUInt16BE"),s.prototype.readUint32LE=s.prototype.readUInt32LE=l(function(e,r){return e=e>>>0,r||X(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},"readUInt32LE"),s.prototype.readUint32BE=s.prototype.readUInt32BE=l(function(e,r){return e=e>>>0,r||X(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},"readUInt32BE"),s.prototype.readBigUInt64LE=le(l(function(e){e=e>>>0,fe(e,"offset");let r=this[e],o=this[e+7];(r===void 0||o===void 0)&&ge(e,this.length-8);let A=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,R=this[++e]+this[++e]*2**8+this[++e]*2**16+o*2**24;return BigInt(A)+(BigInt(R)<<BigInt(32))},"readBigUInt64LE")),s.prototype.readBigUInt64BE=le(l(function(e){e=e>>>0,fe(e,"offset");let r=this[e],o=this[e+7];(r===void 0||o===void 0)&&ge(e,this.length-8);let A=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],R=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+o;return(BigInt(A)<<BigInt(32))+BigInt(R)},"readBigUInt64BE")),s.prototype.readIntLE=l(function(e,r,o){e=e>>>0,r=r>>>0,o||X(e,r,this.length);let A=this[e],R=1,B=0;for(;++B<r&&(R*=256);)A+=this[e+B]*R;return R*=128,A>=R&&(A-=Math.pow(2,8*r)),A},"readIntLE"),s.prototype.readIntBE=l(function(e,r,o){e=e>>>0,r=r>>>0,o||X(e,r,this.length);let A=r,R=1,B=this[e+--A];for(;A>0&&(R*=256);)B+=this[e+--A]*R;return R*=128,B>=R&&(B-=Math.pow(2,8*r)),B},"readIntBE"),s.prototype.readInt8=l(function(e,r){return e=e>>>0,r||X(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},"readInt8"),s.prototype.readInt16LE=l(function(e,r){e=e>>>0,r||X(e,2,this.length);let o=this[e]|this[e+1]<<8;return o&32768?o|4294901760:o},"readInt16LE"),s.prototype.readInt16BE=l(function(e,r){e=e>>>0,r||X(e,2,this.length);let o=this[e+1]|this[e]<<8;return o&32768?o|4294901760:o},"readInt16BE"),s.prototype.readInt32LE=l(function(e,r){return e=e>>>0,r||X(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},"readInt32LE"),s.prototype.readInt32BE=l(function(e,r){return e=e>>>0,r||X(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},"readInt32BE"),s.prototype.readBigInt64LE=le(l(function(e){e=e>>>0,fe(e,"offset");let r=this[e],o=this[e+7];(r===void 0||o===void 0)&&ge(e,this.length-8);let A=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(o<<24);return(BigInt(A)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)},"readBigInt64LE")),s.prototype.readBigInt64BE=le(l(function(e){e=e>>>0,fe(e,"offset");let r=this[e],o=this[e+7];(r===void 0||o===void 0)&&ge(e,this.length-8);let A=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(A)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+o)},"readBigInt64BE")),s.prototype.readFloatLE=l(function(e,r){return e=e>>>0,r||X(e,4,this.length),a.read(this,e,!0,23,4)},"readFloatLE"),s.prototype.readFloatBE=l(function(e,r){return e=e>>>0,r||X(e,4,this.length),a.read(this,e,!1,23,4)},"readFloatBE"),s.prototype.readDoubleLE=l(function(e,r){return e=e>>>0,r||X(e,8,this.length),a.read(this,e,!0,52,8)},"readDoubleLE"),s.prototype.readDoubleBE=l(function(e,r){return e=e>>>0,r||X(e,8,this.length),a.read(this,e,!1,52,8)},"readDoubleBE");function ne(e,r,o,A,R,B){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>R||r<B)throw new RangeError('"value" argument is out of bounds');if(o+A>e.length)throw new RangeError("Index out of range")}l(ne,"checkInt"),s.prototype.writeUintLE=s.prototype.writeUIntLE=l(function(e,r,o,A){if(e=+e,r=r>>>0,o=o>>>0,!A){let D=Math.pow(2,8*o)-1;ne(this,e,r,o,D,0)}let R=1,B=0;for(this[r]=e&255;++B<o&&(R*=256);)this[r+B]=e/R&255;return r+o},"writeUIntLE"),s.prototype.writeUintBE=s.prototype.writeUIntBE=l(function(e,r,o,A){if(e=+e,r=r>>>0,o=o>>>0,!A){let D=Math.pow(2,8*o)-1;ne(this,e,r,o,D,0)}let R=o-1,B=1;for(this[r+R]=e&255;--R>=0&&(B*=256);)this[r+R]=e/B&255;return r+o},"writeUIntBE"),s.prototype.writeUint8=s.prototype.writeUInt8=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,1,255,0),this[r]=e&255,r+1},"writeUInt8"),s.prototype.writeUint16LE=s.prototype.writeUInt16LE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2},"writeUInt16LE"),s.prototype.writeUint16BE=s.prototype.writeUInt16BE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2},"writeUInt16BE"),s.prototype.writeUint32LE=s.prototype.writeUInt32LE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4},"writeUInt32LE"),s.prototype.writeUint32BE=s.prototype.writeUInt32BE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4},"writeUInt32BE");function be(e,r,o,A,R){Fe(r,A,R,e,o,7);let B=Number(r&BigInt(4294967295));e[o++]=B,B=B>>8,e[o++]=B,B=B>>8,e[o++]=B,B=B>>8,e[o++]=B;let D=Number(r>>BigInt(32)&BigInt(4294967295));return e[o++]=D,D=D>>8,e[o++]=D,D=D>>8,e[o++]=D,D=D>>8,e[o++]=D,o}l(be,"wrtBigUInt64LE");function ke(e,r,o,A,R){Fe(r,A,R,e,o,7);let B=Number(r&BigInt(4294967295));e[o+7]=B,B=B>>8,e[o+6]=B,B=B>>8,e[o+5]=B,B=B>>8,e[o+4]=B;let D=Number(r>>BigInt(32)&BigInt(4294967295));return e[o+3]=D,D=D>>8,e[o+2]=D,D=D>>8,e[o+1]=D,D=D>>8,e[o]=D,o+8}l(ke,"wrtBigUInt64BE"),s.prototype.writeBigUInt64LE=le(l(function(e,r=0){return be(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),s.prototype.writeBigUInt64BE=le(l(function(e,r=0){return ke(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),s.prototype.writeIntLE=l(function(e,r,o,A){if(e=+e,r=r>>>0,!A){let Y=Math.pow(2,8*o-1);ne(this,e,r,o,Y-1,-Y)}let R=0,B=1,D=0;for(this[r]=e&255;++R<o&&(B*=256);)e<0&&D===0&&this[r+R-1]!==0&&(D=1),this[r+R]=(e/B>>0)-D&255;return r+o},"writeIntLE"),s.prototype.writeIntBE=l(function(e,r,o,A){if(e=+e,r=r>>>0,!A){let Y=Math.pow(2,8*o-1);ne(this,e,r,o,Y-1,-Y)}let R=o-1,B=1,D=0;for(this[r+R]=e&255;--R>=0&&(B*=256);)e<0&&D===0&&this[r+R+1]!==0&&(D=1),this[r+R]=(e/B>>0)-D&255;return r+o},"writeIntBE"),s.prototype.writeInt8=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1},"writeInt8"),s.prototype.writeInt16LE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2},"writeInt16LE"),s.prototype.writeInt16BE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2},"writeInt16BE"),s.prototype.writeInt32LE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4},"writeInt32LE"),s.prototype.writeInt32BE=l(function(e,r,o){return e=+e,r=r>>>0,o||ne(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4},"writeInt32BE"),s.prototype.writeBigInt64LE=le(l(function(e,r=0){return be(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),s.prototype.writeBigInt64BE=le(l(function(e,r=0){return ke(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function Oe(e,r,o,A,R,B){if(o+A>e.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}l(Oe,"checkIEEE754");function De(e,r,o,A,R){return r=+r,o=o>>>0,R||Oe(e,r,o,4,34028234663852886e22,-34028234663852886e22),a.write(e,r,o,A,23,4),o+4}l(De,"writeFloat"),s.prototype.writeFloatLE=l(function(e,r,o){return De(this,e,r,!0,o)},"writeFloatLE"),s.prototype.writeFloatBE=l(function(e,r,o){return De(this,e,r,!1,o)},"writeFloatBE");function Ue(e,r,o,A,R){return r=+r,o=o>>>0,R||Oe(e,r,o,8,17976931348623157e292,-17976931348623157e292),a.write(e,r,o,A,52,8),o+8}l(Ue,"writeDouble"),s.prototype.writeDoubleLE=l(function(e,r,o){return Ue(this,e,r,!0,o)},"writeDoubleLE"),s.prototype.writeDoubleBE=l(function(e,r,o){return Ue(this,e,r,!1,o)},"writeDoubleBE"),s.prototype.copy=l(function(e,r,o,A){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(o||(o=0),!A&&A!==0&&(A=this.length),r>=e.length&&(r=e.length),r||(r=0),A>0&&A<o&&(A=o),A===o||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(o<0||o>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),e.length-r<A-o&&(A=e.length-r+o);let R=A-o;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,o,A):Uint8Array.prototype.set.call(e,this.subarray(o,A),r),R},"copy"),s.prototype.fill=l(function(e,r,o,A){if(typeof e=="string"){if(typeof r=="string"?(A=r,r=0,o=this.length):typeof o=="string"&&(A=o,o=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!s.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(e.length===1){let B=e.charCodeAt(0);(A==="utf8"&&B<128||A==="latin1")&&(e=B)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<o)throw new RangeError("Out of range index");if(o<=r)return this;r=r>>>0,o=o===void 0?this.length:o>>>0,e||(e=0);let R;if(typeof e=="number")for(R=r;R<o;++R)this[R]=e;else{let B=s.isBuffer(e)?e:s.from(e,A),D=B.length;if(D===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(R=0;R<o-r;++R)this[R+r]=B[R%D]}return this},"fill");var ye={};function Ae(e,r,o){var A;ye[e]=(A=class extends o{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(R){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:R,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}},l(A,"NodeError"),A)}l(Ae,"E"),Ae("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ae("ERR_INVALID_ARG_TYPE",function(e,r){return`The "${e}" argument must be of type number. Received type ${typeof r}`},TypeError),Ae("ERR_OUT_OF_RANGE",function(e,r,o){let A=`The value of "${e}" is out of range.`,R=o;return Number.isInteger(o)&&Math.abs(o)>2**32?R=Ne(String(o)):typeof o=="bigint"&&(R=String(o),(o>BigInt(2)**BigInt(32)||o<-(BigInt(2)**BigInt(32)))&&(R=Ne(R)),R+="n"),A+=` It must be ${r}. Received ${R}`,A},RangeError);function Ne(e){let r="",o=e.length,A=e[0]==="-"?1:0;for(;o>=A+4;o-=3)r=`_${e.slice(o-3,o)}${r}`;return`${e.slice(0,o)}${r}`}l(Ne,"addNumericalSeparator");function Xe(e,r,o){fe(r,"offset"),(e[r]===void 0||e[r+o]===void 0)&&ge(r,e.length-(o+1))}l(Xe,"checkBounds");function Fe(e,r,o,A,R,B){if(e>o||e<r){let D=typeof r=="bigint"?"n":"",Y;throw B>3?r===0||r===BigInt(0)?Y=`>= 0${D} and < 2${D} ** ${(B+1)*8}${D}`:Y=`>= -(2${D} ** ${(B+1)*8-1}${D}) and < 2 ** ${(B+1)*8-1}${D}`:Y=`>= ${r}${D} and <= ${o}${D}`,new ye.ERR_OUT_OF_RANGE("value",Y,e)}Xe(A,R,B)}l(Fe,"checkIntBI");function fe(e,r){if(typeof e!="number")throw new ye.ERR_INVALID_ARG_TYPE(r,"number",e)}l(fe,"validateNumber");function ge(e,r,o){throw Math.floor(e)!==e?(fe(e,o),new ye.ERR_OUT_OF_RANGE(o||"offset","an integer",e)):r<0?new ye.ERR_BUFFER_OUT_OF_BOUNDS:new ye.ERR_OUT_OF_RANGE(o||"offset",`>= ${o?1:0} and <= ${r}`,e)}l(ge,"boundsError");var zt=/[^+/0-9A-Za-z-_]/g;function et(e){if(e=e.split("=")[0],e=e.trim().replace(zt,""),e.length<2)return"";for(;e.length%4!==0;)e=e+"=";return e}l(et,"base64clean");function Ie(e,r){r=r||1/0;let o,A=e.length,R=null,B=[];for(let D=0;D<A;++D){if(o=e.charCodeAt(D),o>55295&&o<57344){if(!R){if(o>56319){(r-=3)>-1&&B.push(239,191,189);continue}else if(D+1===A){(r-=3)>-1&&B.push(239,191,189);continue}R=o;continue}if(o<56320){(r-=3)>-1&&B.push(239,191,189),R=o;continue}o=(R-55296<<10|o-56320)+65536}else R&&(r-=3)>-1&&B.push(239,191,189);if(R=null,o<128){if((r-=1)<0)break;B.push(o)}else if(o<2048){if((r-=2)<0)break;B.push(o>>6|192,o&63|128)}else if(o<65536){if((r-=3)<0)break;B.push(o>>12|224,o>>6&63|128,o&63|128)}else if(o<1114112){if((r-=4)<0)break;B.push(o>>18|240,o>>12&63|128,o>>6&63|128,o&63|128)}else throw new Error("Invalid code point")}return B}l(Ie,"utf8ToBytes");function tt(e){let r=[];for(let o=0;o<e.length;++o)r.push(e.charCodeAt(o)&255);return r}l(tt,"asciiToBytes");function rt(e,r){let o,A,R,B=[];for(let D=0;D<e.length&&!((r-=2)<0);++D)o=e.charCodeAt(D),A=o>>8,R=o%256,B.push(R),B.push(A);return B}l(rt,"utf16leToBytes");function Qe(e){return f.toByteArray(et(e))}l(Qe,"base64ToBytes");function we(e,r,o,A){let R;for(R=0;R<A&&!(R+o>=r.length||R>=e.length);++R)r[R+o]=e[R];return R}l(we,"blitBuffer");function he(e,r){return e instanceof r||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===r.name}l(he,"isInstance");function Ce(e){return e!==e}l(Ce,"numberIsNaN");var Kt=function(){let e="0123456789abcdef",r=new Array(256);for(let o=0;o<16;++o){let A=o*16;for(let R=0;R<16;++R)r[A+R]=e[o]+e[R]}return r}();function le(e){return typeof BigInt>"u"?nt:e}l(le,"defineBigIntMethod");function nt(){throw new Error("BigInt not supported")}l(nt,"BufferBigIntNotDefined")}),Le,$e,ir,se,$,G,Q=ie(()=>{"use strict";Le=globalThis,$e=globalThis.setImmediate??(E=>setTimeout(E,0)),ir=globalThis.clearImmediate??(E=>clearTimeout(E)),se=globalThis.crypto??{},se.subtle??(se.subtle={}),$=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:sr().Buffer,G=globalThis.process??{},G.env??(G.env={});try{G.nextTick(()=>{})}catch{let E=Promise.resolve();G.nextTick=E.then.bind(E)}}),pe=H((E,f)=>{"use strict";Q();var a=typeof Reflect=="object"?Reflect:null,h=a&&typeof a.apply=="function"?a.apply:l(function(v,L,P){return Function.prototype.apply.call(v,L,P)},"ReflectApply"),i;a&&typeof a.ownKeys=="function"?i=a.ownKeys:Object.getOwnPropertySymbols?i=l(function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))},"ReflectOwnKeys"):i=l(function(v){return Object.getOwnPropertyNames(v)},"ReflectOwnKeys");function n(v){console&&console.warn&&console.warn(v)}l(n,"ProcessEmitWarning");var u=Number.isNaN||l(function(v){return v!==v},"NumberIsNaN");function s(){s.init.call(this)}l(s,"EventEmitter"),f.exports=s,f.exports.once=b,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var d=10;function I(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}l(I,"checkListener"),Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(v){if(typeof v!="number"||v<0||u(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");d=v}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=l(function(v){if(typeof v!="number"||v<0||u(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this},"setMaxListeners");function _(v){return v._maxListeners===void 0?s.defaultMaxListeners:v._maxListeners}l(_,"_getMaxListeners"),s.prototype.getMaxListeners=l(function(){return _(this)},"getMaxListeners"),s.prototype.emit=l(function(v){for(var L=[],P=1;P<arguments.length;P++)L.push(arguments[P]);var C=v==="error",k=this._events;if(k!==void 0)C=C&&k.error===void 0;else if(!C)return!1;if(C){var M;if(L.length>0&&(M=L[0]),M instanceof Error)throw M;var N=new Error("Unhandled error."+(M?" ("+M.message+")":""));throw N.context=M,N}var F=k[v];if(F===void 0)return!1;if(typeof F=="function")h(F,this,L);else for(var O=F.length,U=p(F,O),P=0;P<O;++P)h(U[P],this,L);return!0},"emit");function S(v,L,P,C){var k,M,N;if(I(P),M=v._events,M===void 0?(M=v._events=Object.create(null),v._eventsCount=0):(M.newListener!==void 0&&(v.emit("newListener",L,P.listener?P.listener:P),M=v._events),N=M[L]),N===void 0)N=M[L]=P,++v._eventsCount;else if(typeof N=="function"?N=M[L]=C?[P,N]:[N,P]:C?N.unshift(P):N.push(P),k=_(v),k>0&&N.length>k&&!N.warned){N.warned=!0;var F=new Error("Possible EventEmitter memory leak detected. "+N.length+" "+String(L)+" listeners added. Use emitter.setMaxListeners() to increase limit");F.name="MaxListenersExceededWarning",F.emitter=v,F.type=L,F.count=N.length,n(F)}return v}l(S,"_addListener"),s.prototype.addListener=l(function(v,L){return S(this,v,L,!1)},"addListener"),s.prototype.on=s.prototype.addListener,s.prototype.prependListener=l(function(v,L){return S(this,v,L,!0)},"prependListener");function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}l(y,"onceWrapper");function w(v,L,P){var C={fired:!1,wrapFn:void 0,target:v,type:L,listener:P},k=y.bind(C);return k.listener=P,C.wrapFn=k,k}l(w,"_onceWrap"),s.prototype.once=l(function(v,L){return I(L),this.on(v,w(this,v,L)),this},"once"),s.prototype.prependOnceListener=l(function(v,L){return I(L),this.prependListener(v,w(this,v,L)),this},"prependOnceListener"),s.prototype.removeListener=l(function(v,L){var P,C,k,M,N;if(I(L),C=this._events,C===void 0)return this;if(P=C[v],P===void 0)return this;if(P===L||P.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete C[v],C.removeListener&&this.emit("removeListener",v,P.listener||L));else if(typeof P!="function"){for(k=-1,M=P.length-1;M>=0;M--)if(P[M]===L||P[M].listener===L){N=P[M].listener,k=M;break}if(k<0)return this;k===0?P.shift():g(P,k),P.length===1&&(C[v]=P[0]),C.removeListener!==void 0&&this.emit("removeListener",v,N||L)}return this},"removeListener"),s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=l(function(v){var L,P,C;if(P=this._events,P===void 0)return this;if(P.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):P[v]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete P[v]),this;if(arguments.length===0){var k=Object.keys(P),M;for(C=0;C<k.length;++C)M=k[C],M!=="removeListener"&&this.removeAllListeners(M);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=P[v],typeof L=="function")this.removeListener(v,L);else if(L!==void 0)for(C=L.length-1;C>=0;C--)this.removeListener(v,L[C]);return this},"removeAllListeners");function c(v,L,P){var C=v._events;if(C===void 0)return[];var k=C[L];return k===void 0?[]:typeof k=="function"?P?[k.listener||k]:[k]:P?m(k):p(k,k.length)}l(c,"_listeners"),s.prototype.listeners=l(function(v){return c(this,v,!0)},"listeners"),s.prototype.rawListeners=l(function(v){return c(this,v,!1)},"rawListeners"),s.listenerCount=function(v,L){return typeof v.listenerCount=="function"?v.listenerCount(L):t.call(v,L)},s.prototype.listenerCount=t;function t(v){var L=this._events;if(L!==void 0){var P=L[v];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}l(t,"listenerCount"),s.prototype.eventNames=l(function(){return this._eventsCount>0?i(this._events):[]},"eventNames");function p(v,L){for(var P=new Array(L),C=0;C<L;++C)P[C]=v[C];return P}l(p,"arrayClone");function g(v,L){for(;L+1<v.length;L++)v[L]=v[L+1];v.pop()}l(g,"spliceOne");function m(v){for(var L=new Array(v.length),P=0;P<L.length;++P)L[P]=v[P].listener||v[P];return L}l(m,"unwrapListeners");function b(v,L){return new Promise(function(P,C){function k(N){v.removeListener(L,M),C(N)}l(k,"errorListener");function M(){typeof v.removeListener=="function"&&v.removeListener("error",k),P([].slice.call(arguments))}l(M,"resolver"),x(v,L,M,{once:!0}),L!=="error"&&T(v,k,{once:!0})})}l(b,"once");function T(v,L,P){typeof v.on=="function"&&x(v,"error",L,P)}l(T,"addErrorHandlerIfEventEmitter");function x(v,L,P,C){if(typeof v.on=="function")C.once?v.once(L,P):v.on(L,P);else if(typeof v.addEventListener=="function")v.addEventListener(L,l(function k(M){C.once&&v.removeEventListener(L,k),P(M)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v)}l(x,"eventTargetAgnosticAddListener")}),_e={};ue(_e,{default:()=>ht});var ht,Pe=ie(()=>{"use strict";Q(),ht={}});function Se(E){let f=1779033703,a=3144134277,h=1013904242,i=2773480762,n=1359893119,u=2600822924,s=528734635,d=1541459225,I=0,_=0,S=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],y=l((m,b)=>m>>>b|m<<32-b,"rrot"),w=new Uint32Array(64),c=new Uint8Array(64),t=l(()=>{for(let k=0,M=0;k<16;k++,M+=4)w[k]=c[M]<<24|c[M+1]<<16|c[M+2]<<8|c[M+3];for(let k=16;k<64;k++){let M=y(w[k-15],7)^y(w[k-15],18)^w[k-15]>>>3,N=y(w[k-2],17)^y(w[k-2],19)^w[k-2]>>>10;w[k]=w[k-16]+M+w[k-7]+N|0}let m=f,b=a,T=h,x=i,v=n,L=u,P=s,C=d;for(let k=0;k<64;k++){let M=y(v,6)^y(v,11)^y(v,25),N=v&L^~v&P,F=C+M+N+S[k]+w[k]|0,O=y(m,2)^y(m,13)^y(m,22),U=m&b^m&T^b&T,q=O+U|0;C=P,P=L,L=v,v=x+F|0,x=T,T=b,b=m,m=F+q|0}f=f+m|0,a=a+b|0,h=h+T|0,i=i+x|0,n=n+v|0,u=u+L|0,s=s+P|0,d=d+C|0,_=0},"process"),p=l(m=>{typeof m=="string"&&(m=new TextEncoder().encode(m));for(let b=0;b<m.length;b++)c[_++]=m[b],_===64&&t();I+=m.length},"add"),g=l(()=>{if(c[_++]=128,_==64&&t(),_+8>64){for(;_<64;)c[_++]=0;t()}for(;_<58;)c[_++]=0;let m=I*8;c[_++]=m/1099511627776&255,c[_++]=m/4294967296&255,c[_++]=m>>>24,c[_++]=m>>>16&255,c[_++]=m>>>8&255,c[_++]=m&255,t();let b=new Uint8Array(32);return b[0]=f>>>24,b[1]=f>>>16&255,b[2]=f>>>8&255,b[3]=f&255,b[4]=a>>>24,b[5]=a>>>16&255,b[6]=a>>>8&255,b[7]=a&255,b[8]=h>>>24,b[9]=h>>>16&255,b[10]=h>>>8&255,b[11]=h&255,b[12]=i>>>24,b[13]=i>>>16&255,b[14]=i>>>8&255,b[15]=i&255,b[16]=n>>>24,b[17]=n>>>16&255,b[18]=n>>>8&255,b[19]=n&255,b[20]=u>>>24,b[21]=u>>>16&255,b[22]=u>>>8&255,b[23]=u&255,b[24]=s>>>24,b[25]=s>>>16&255,b[26]=s>>>8&255,b[27]=s&255,b[28]=d>>>24,b[29]=d>>>16&255,b[30]=d>>>8&255,b[31]=d&255,b},"digest");return E===void 0?{add:p,digest:g}:(p(E),g())}var or=ie(()=>{"use strict";Q(),l(Se,"sha256")}),ce,je,ar=ie(()=>{"use strict";Q(),ce=class ae{constructor(){z(this,"_dataLength",0),z(this,"_bufferLength",0),z(this,"_state",new Int32Array(4)),z(this,"_buffer",new ArrayBuffer(68)),z(this,"_buffer8"),z(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(f,a=!1){return this.onePassHasher.start().appendByteArray(f).end(a)}static hashStr(f,a=!1){return this.onePassHasher.start().appendStr(f).end(a)}static hashAsciiStr(f,a=!1){return this.onePassHasher.start().appendAsciiStr(f).end(a)}static _hex(f){let a=ae.hexChars,h=ae.hexOut,i,n,u,s;for(s=0;s<4;s+=1)for(n=s*8,i=f[s],u=0;u<8;u+=2)h[n+1+u]=a.charAt(i&15),i>>>=4,h[n+0+u]=a.charAt(i&15),i>>>=4;return h.join("")}static _md5cycle(f,a){let h=f[0],i=f[1],n=f[2],u=f[3];h+=(i&n|~i&u)+a[0]-680876936|0,h=(h<<7|h>>>25)+i|0,u+=(h&i|~h&n)+a[1]-389564586|0,u=(u<<12|u>>>20)+h|0,n+=(u&h|~u&i)+a[2]+606105819|0,n=(n<<17|n>>>15)+u|0,i+=(n&u|~n&h)+a[3]-1044525330|0,i=(i<<22|i>>>10)+n|0,h+=(i&n|~i&u)+a[4]-176418897|0,h=(h<<7|h>>>25)+i|0,u+=(h&i|~h&n)+a[5]+1200080426|0,u=(u<<12|u>>>20)+h|0,n+=(u&h|~u&i)+a[6]-1473231341|0,n=(n<<17|n>>>15)+u|0,i+=(n&u|~n&h)+a[7]-45705983|0,i=(i<<22|i>>>10)+n|0,h+=(i&n|~i&u)+a[8]+1770035416|0,h=(h<<7|h>>>25)+i|0,u+=(h&i|~h&n)+a[9]-1958414417|0,u=(u<<12|u>>>20)+h|0,n+=(u&h|~u&i)+a[10]-42063|0,n=(n<<17|n>>>15)+u|0,i+=(n&u|~n&h)+a[11]-1990404162|0,i=(i<<22|i>>>10)+n|0,h+=(i&n|~i&u)+a[12]+1804603682|0,h=(h<<7|h>>>25)+i|0,u+=(h&i|~h&n)+a[13]-40341101|0,u=(u<<12|u>>>20)+h|0,n+=(u&h|~u&i)+a[14]-1502002290|0,n=(n<<17|n>>>15)+u|0,i+=(n&u|~n&h)+a[15]+1236535329|0,i=(i<<22|i>>>10)+n|0,h+=(i&u|n&~u)+a[1]-165796510|0,h=(h<<5|h>>>27)+i|0,u+=(h&n|i&~n)+a[6]-1069501632|0,u=(u<<9|u>>>23)+h|0,n+=(u&i|h&~i)+a[11]+643717713|0,n=(n<<14|n>>>18)+u|0,i+=(n&h|u&~h)+a[0]-373897302|0,i=(i<<20|i>>>12)+n|0,h+=(i&u|n&~u)+a[5]-701558691|0,h=(h<<5|h>>>27)+i|0,u+=(h&n|i&~n)+a[10]+38016083|0,u=(u<<9|u>>>23)+h|0,n+=(u&i|h&~i)+a[15]-660478335|0,n=(n<<14|n>>>18)+u|0,i+=(n&h|u&~h)+a[4]-405537848|0,i=(i<<20|i>>>12)+n|0,h+=(i&u|n&~u)+a[9]+568446438|0,h=(h<<5|h>>>27)+i|0,u+=(h&n|i&~n)+a[14]-1019803690|0,u=(u<<9|u>>>23)+h|0,n+=(u&i|h&~i)+a[3]-187363961|0,n=(n<<14|n>>>18)+u|0,i+=(n&h|u&~h)+a[8]+1163531501|0,i=(i<<20|i>>>12)+n|0,h+=(i&u|n&~u)+a[13]-1444681467|0,h=(h<<5|h>>>27)+i|0,u+=(h&n|i&~n)+a[2]-51403784|0,u=(u<<9|u>>>23)+h|0,n+=(u&i|h&~i)+a[7]+1735328473|0,n=(n<<14|n>>>18)+u|0,i+=(n&h|u&~h)+a[12]-1926607734|0,i=(i<<20|i>>>12)+n|0,h+=(i^n^u)+a[5]-378558|0,h=(h<<4|h>>>28)+i|0,u+=(h^i^n)+a[8]-2022574463|0,u=(u<<11|u>>>21)+h|0,n+=(u^h^i)+a[11]+1839030562|0,n=(n<<16|n>>>16)+u|0,i+=(n^u^h)+a[14]-35309556|0,i=(i<<23|i>>>9)+n|0,h+=(i^n^u)+a[1]-1530992060|0,h=(h<<4|h>>>28)+i|0,u+=(h^i^n)+a[4]+1272893353|0,u=(u<<11|u>>>21)+h|0,n+=(u^h^i)+a[7]-155497632|0,n=(n<<16|n>>>16)+u|0,i+=(n^u^h)+a[10]-1094730640|0,i=(i<<23|i>>>9)+n|0,h+=(i^n^u)+a[13]+681279174|0,h=(h<<4|h>>>28)+i|0,u+=(h^i^n)+a[0]-358537222|0,u=(u<<11|u>>>21)+h|0,n+=(u^h^i)+a[3]-722521979|0,n=(n<<16|n>>>16)+u|0,i+=(n^u^h)+a[6]+76029189|0,i=(i<<23|i>>>9)+n|0,h+=(i^n^u)+a[9]-640364487|0,h=(h<<4|h>>>28)+i|0,u+=(h^i^n)+a[12]-421815835|0,u=(u<<11|u>>>21)+h|0,n+=(u^h^i)+a[15]+530742520|0,n=(n<<16|n>>>16)+u|0,i+=(n^u^h)+a[2]-995338651|0,i=(i<<23|i>>>9)+n|0,h+=(n^(i|~u))+a[0]-198630844|0,h=(h<<6|h>>>26)+i|0,u+=(i^(h|~n))+a[7]+1126891415|0,u=(u<<10|u>>>22)+h|0,n+=(h^(u|~i))+a[14]-1416354905|0,n=(n<<15|n>>>17)+u|0,i+=(u^(n|~h))+a[5]-57434055|0,i=(i<<21|i>>>11)+n|0,h+=(n^(i|~u))+a[12]+1700485571|0,h=(h<<6|h>>>26)+i|0,u+=(i^(h|~n))+a[3]-1894986606|0,u=(u<<10|u>>>22)+h|0,n+=(h^(u|~i))+a[10]-1051523|0,n=(n<<15|n>>>17)+u|0,i+=(u^(n|~h))+a[1]-2054922799|0,i=(i<<21|i>>>11)+n|0,h+=(n^(i|~u))+a[8]+1873313359|0,h=(h<<6|h>>>26)+i|0,u+=(i^(h|~n))+a[15]-30611744|0,u=(u<<10|u>>>22)+h|0,n+=(h^(u|~i))+a[6]-1560198380|0,n=(n<<15|n>>>17)+u|0,i+=(u^(n|~h))+a[13]+1309151649|0,i=(i<<21|i>>>11)+n|0,h+=(n^(i|~u))+a[4]-145523070|0,h=(h<<6|h>>>26)+i|0,u+=(i^(h|~n))+a[11]-1120210379|0,u=(u<<10|u>>>22)+h|0,n+=(h^(u|~i))+a[2]+718787259|0,n=(n<<15|n>>>17)+u|0,i+=(u^(n|~h))+a[9]-343485551|0,i=(i<<21|i>>>11)+n|0,f[0]=h+f[0]|0,f[1]=i+f[1]|0,f[2]=n+f[2]|0,f[3]=u+f[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(ae.stateIdentity),this}appendStr(f){let a=this._buffer8,h=this._buffer32,i=this._bufferLength,n,u;for(u=0;u<f.length;u+=1){if(n=f.charCodeAt(u),n<128)a[i++]=n;else if(n<2048)a[i++]=(n>>>6)+192,a[i++]=n&63|128;else if(n<55296||n>56319)a[i++]=(n>>>12)+224,a[i++]=n>>>6&63|128,a[i++]=n&63|128;else{if(n=(n-55296)*1024+(f.charCodeAt(++u)-56320)+65536,n>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");a[i++]=(n>>>18)+240,a[i++]=n>>>12&63|128,a[i++]=n>>>6&63|128,a[i++]=n&63|128}i>=64&&(this._dataLength+=64,ae._md5cycle(this._state,h),i-=64,h[0]=h[16])}return this._bufferLength=i,this}appendAsciiStr(f){let a=this._buffer8,h=this._buffer32,i=this._bufferLength,n,u=0;for(;;){for(n=Math.min(f.length-u,64-i);n--;)a[i++]=f.charCodeAt(u++);if(i<64)break;this._dataLength+=64,ae._md5cycle(this._state,h),i=0}return this._bufferLength=i,this}appendByteArray(f){let a=this._buffer8,h=this._buffer32,i=this._bufferLength,n,u=0;for(;;){for(n=Math.min(f.length-u,64-i);n--;)a[i++]=f[u++];if(i<64)break;this._dataLength+=64,ae._md5cycle(this._state,h),i=0}return this._bufferLength=i,this}getState(){let f=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[f[0],f[1],f[2],f[3]]}}setState(f){let a=f.buffer,h=f.state,i=this._state,n;for(this._dataLength=f.length,this._bufferLength=f.buflen,i[0]=h[0],i[1]=h[1],i[2]=h[2],i[3]=h[3],n=0;n<a.length;n+=1)this._buffer8[n]=a.charCodeAt(n)}end(f=!1){let a=this._bufferLength,h=this._buffer8,i=this._buffer32,n=(a>>2)+1;this._dataLength+=a;let u=this._dataLength*8;if(h[a]=128,h[a+1]=h[a+2]=h[a+3]=0,i.set(ae.buffer32Identity.subarray(n),n),a>55&&(ae._md5cycle(this._state,i),i.set(ae.buffer32Identity)),u<=4294967295)i[14]=u;else{let s=u.toString(16).match(/(.*?)(.{0,8})$/);if(s===null)return;let d=parseInt(s[2],16),I=parseInt(s[1],16)||0;i[14]=d,i[15]=I}return ae._md5cycle(this._state,i),f?this._state:ae._hex(this._state)}},l(ce,"Md5"),z(ce,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),z(ce,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),z(ce,"hexChars","0123456789abcdef"),z(ce,"hexOut",[]),z(ce,"onePassHasher",new ce),je=ce}),Ge={};ue(Ge,{createHash:()=>ct,createHmac:()=>ft,randomBytes:()=>lt});function lt(E){return se.getRandomValues($.alloc(E))}function ct(E){if(E==="sha256")return{update:function(f){return{digest:function(){return $.from(Se(f))}}}};if(E==="md5")return{update:function(f){return{digest:function(){return typeof f=="string"?je.hashStr(f):je.hashByteArray(f)}}}};throw new Error(`Hash type '${E}' not supported`)}function ft(E,f){if(E!=="sha256")throw new Error(`Only sha256 is supported (requested: '${E}')`);return{update:function(a){return{digest:function(){typeof f=="string"&&(f=new TextEncoder().encode(f)),typeof a=="string"&&(a=new TextEncoder().encode(a));let h=f.length;if(h>64)f=Se(f);else if(h<64){let d=new Uint8Array(64);d.set(f),f=d}let i=new Uint8Array(64),n=new Uint8Array(64);for(let d=0;d<64;d++)i[d]=54^f[d],n[d]=92^f[d];let u=new Uint8Array(a.length+64);u.set(i,0),u.set(a,64);let s=new Uint8Array(96);return s.set(n,0),s.set(Se(u),64),$.from(Se(s))}}}}}var pt=ie(()=>{"use strict";Q(),or(),ar(),l(lt,"randomBytes"),l(ct,"createHash"),l(ft,"createHmac")}),dt=H(E=>{"use strict";Q(),E.parse=function(i,n){return new a(i,n).parse()};var f=class yt{constructor(n,u){this.source=n,this.transform=u||h,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var n=this.source[this.position++];return n==="\\"?{value:this.source[this.position++],escaped:!0}:{value:n,escaped:!1}}record(n){this.recorded.push(n)}newEntry(n){var u;(this.recorded.length>0||n)&&(u=this.recorded.join(""),u==="NULL"&&!n&&(u=null),u!==null&&(u=this.transform(u)),this.entries.push(u),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var n=this.nextCharacter();if(n.value==="=")break}}parse(n){var u,s,d;for(this.consumeDimensions();!this.isEof();)if(u=this.nextCharacter(),u.value==="{"&&!d)this.dimension++,this.dimension>1&&(s=new yt(this.source.substr(this.position-1),this.transform),this.entries.push(s.parse(!0)),this.position+=s.position-2);else if(u.value==="}"&&!d){if(this.dimension--,!this.dimension&&(this.newEntry(),n))return this.entries}else u.value==='"'&&!u.escaped?(d&&this.newEntry(!0),d=!d):u.value===","&&!d?this.newEntry():this.record(u.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};l(f,"ArrayParser");var a=f;function h(i){return i}l(h,"identity")}),gt=H((E,f)=>{Q();var a=dt();f.exports={create:function(h,i){return{parse:function(){return a.parse(h,i)}}}}}),ur=H((E,f)=>{"use strict";Q();var a=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,h=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,i=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,n=/^-?infinity$/;f.exports=l(function(_){if(n.test(_))return Number(_.replace("i","I"));var S=a.exec(_);if(!S)return u(_)||null;var y=!!S[8],w=parseInt(S[1],10);y&&(w=d(w));var c=parseInt(S[2],10)-1,t=S[3],p=parseInt(S[4],10),g=parseInt(S[5],10),m=parseInt(S[6],10),b=S[7];b=b?1e3*parseFloat(b):0;var T,x=s(_);return x!=null?(T=new Date(Date.UTC(w,c,t,p,g,m,b)),I(w)&&T.setUTCFullYear(w),x!==0&&T.setTime(T.getTime()-x)):(T=new Date(w,c,t,p,g,m,b),I(w)&&T.setFullYear(w)),T},"parseDate");function u(_){var S=h.exec(_);if(S){var y=parseInt(S[1],10),w=!!S[4];w&&(y=d(y));var c=parseInt(S[2],10)-1,t=S[3],p=new Date(y,c,t);return I(y)&&p.setFullYear(y),p}}l(u,"getDate");function s(_){if(_.endsWith("+00"))return 0;var S=i.exec(_.split(" ")[1]);if(S){var y=S[1];if(y==="Z")return 0;var w=y==="-"?-1:1,c=parseInt(S[2],10)*3600+parseInt(S[3]||0,10)*60+parseInt(S[4]||0,10);return c*w*1e3}}l(s,"timeZoneOffset");function d(_){return-(_-1)}l(d,"bcYearToNegativeYear");function I(_){return _>=0&&_<100}l(I,"is0To99")}),hr=H((E,f)=>{Q(),f.exports=h;var a=Object.prototype.hasOwnProperty;function h(i){for(var n=1;n<arguments.length;n++){var u=arguments[n];for(var s in u)a.call(u,s)&&(i[s]=u[s])}return i}l(h,"extend")}),lr=H((E,f)=>{"use strict";Q();var a=hr();f.exports=h;function h(m){if(!(this instanceof h))return new h(m);a(this,g(m))}l(h,"PostgresInterval");var i=["seconds","minutes","hours","days","months","years"];h.prototype.toPostgres=function(){var m=i.filter(this.hasOwnProperty,this);return this.milliseconds&&m.indexOf("seconds")<0&&m.push("seconds"),m.length===0?"0":m.map(function(b){var T=this[b]||0;return b==="seconds"&&this.milliseconds&&(T=(T+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),T+" "+b},this).join(" ")};var n={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},u=["years","months","days"],s=["hours","minutes","seconds"];h.prototype.toISOString=h.prototype.toISO=function(){var m=u.map(T,this).join(""),b=s.map(T,this).join("");return"P"+m+"T"+b;function T(x){var v=this[x]||0;return x==="seconds"&&this.milliseconds&&(v=(v+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),v+n[x]}};var d="([+-]?\\d+)",I=d+"\\s+years?",_=d+"\\s+mons?",S=d+"\\s+days?",y="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",w=new RegExp([I,_,S,y].map(function(m){return"("+m+")?"}).join("\\s*")),c={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},t=["hours","minutes","seconds","milliseconds"];function p(m){var b=m+"000000".slice(m.length);return parseInt(b,10)/1e3}l(p,"parseMilliseconds");function g(m){if(!m)return{};var b=w.exec(m),T=b[8]==="-";return Object.keys(c).reduce(function(x,v){var L=c[v],P=b[L];return!P||(P=v==="milliseconds"?p(P):parseInt(P,10),!P)||(T&&~t.indexOf(v)&&(P*=-1),x[v]=P),x},{})}l(g,"parse")}),cr=H((E,f)=>{"use strict";Q(),f.exports=l(function(a){if(/^\\x/.test(a))return new $(a.substr(2),"hex");for(var h="",i=0;i<a.length;)if(a[i]!=="\\")h+=a[i],++i;else if(/[0-7]{3}/.test(a.substr(i+1,3)))h+=String.fromCharCode(parseInt(a.substr(i+1,3),8)),i+=4;else{for(var n=1;i+n<a.length&&a[i+n]==="\\";)n++;for(var u=0;u<Math.floor(n/2);++u)h+="\\";i+=Math.floor(n/2)*2}return new $(h,"binary")},"parseBytea")}),fr=H((E,f)=>{Q();var a=dt(),h=gt(),i=ur(),n=lr(),u=cr();function s(C){return l(function(k){return k===null?k:C(k)},"nullAllowed")}l(s,"allowNull");function d(C){return C===null?C:C==="TRUE"||C==="t"||C==="true"||C==="y"||C==="yes"||C==="on"||C==="1"}l(d,"parseBool");function I(C){return C?a.parse(C,d):null}l(I,"parseBoolArray");function _(C){return parseInt(C,10)}l(_,"parseBaseTenInt");function S(C){return C?a.parse(C,s(_)):null}l(S,"parseIntegerArray");function y(C){return C?a.parse(C,s(function(k){return T(k).trim()})):null}l(y,"parseBigIntegerArray");var w=l(function(C){if(!C)return null;var k=h.create(C,function(M){return M!==null&&(M=v(M)),M});return k.parse()},"parsePointArray"),c=l(function(C){if(!C)return null;var k=h.create(C,function(M){return M!==null&&(M=parseFloat(M)),M});return k.parse()},"parseFloatArray"),t=l(function(C){if(!C)return null;var k=h.create(C);return k.parse()},"parseStringArray"),p=l(function(C){if(!C)return null;var k=h.create(C,function(M){return M!==null&&(M=i(M)),M});return k.parse()},"parseDateArray"),g=l(function(C){if(!C)return null;var k=h.create(C,function(M){return M!==null&&(M=n(M)),M});return k.parse()},"parseIntervalArray"),m=l(function(C){return C?a.parse(C,s(u)):null},"parseByteAArray"),b=l(function(C){return parseInt(C,10)},"parseInteger"),T=l(function(C){var k=String(C);return/^\d+$/.test(k)?k:C},"parseBigInteger"),x=l(function(C){return C?a.parse(C,s(JSON.parse)):null},"parseJsonArray"),v=l(function(C){return C[0]!=="("?null:(C=C.substring(1,C.length-1).split(","),{x:parseFloat(C[0]),y:parseFloat(C[1])})},"parsePoint"),L=l(function(C){if(C[0]!=="<"&&C[1]!=="(")return null;for(var k="(",M="",N=!1,F=2;F<C.length-1;F++){if(N||(k+=C[F]),C[F]===")"){N=!0;continue}else if(!N)continue;C[F]!==","&&(M+=C[F])}var O=v(k);return O.radius=parseFloat(M),O},"parseCircle"),P=l(function(C){C(20,T),C(21,b),C(23,b),C(26,b),C(700,parseFloat),C(701,parseFloat),C(16,d),C(1082,i),C(1114,i),C(1184,i),C(600,v),C(651,t),C(718,L),C(1e3,I),C(1001,m),C(1005,S),C(1007,S),C(1028,S),C(1016,y),C(1017,w),C(1021,c),C(1022,c),C(1231,c),C(1014,t),C(1015,t),C(1008,t),C(1009,t),C(1040,t),C(1041,t),C(1115,p),C(1182,p),C(1185,p),C(1186,n),C(1187,g),C(17,u),C(114,JSON.parse.bind(JSON)),C(3802,JSON.parse.bind(JSON)),C(199,x),C(3807,x),C(3907,t),C(2951,t),C(791,t),C(1183,t),C(1270,t)},"init");f.exports={init:P}}),pr=H((E,f)=>{"use strict";Q();var a=1e6;function h(i){var n=i.readInt32BE(0),u=i.readUInt32BE(4),s="";n<0&&(n=~n+(u===0),u=~u+1>>>0,s="-");var d="",I,_,S,y,w,c;{if(I=n%a,n=n/a>>>0,_=4294967296*I+u,u=_/a>>>0,S=""+(_-a*u),u===0&&n===0)return s+S+d;for(y="",w=6-S.length,c=0;c<w;c++)y+="0";d=y+S+d}{if(I=n%a,n=n/a>>>0,_=4294967296*I+u,u=_/a>>>0,S=""+(_-a*u),u===0&&n===0)return s+S+d;for(y="",w=6-S.length,c=0;c<w;c++)y+="0";d=y+S+d}{if(I=n%a,n=n/a>>>0,_=4294967296*I+u,u=_/a>>>0,S=""+(_-a*u),u===0&&n===0)return s+S+d;for(y="",w=6-S.length,c=0;c<w;c++)y+="0";d=y+S+d}return I=n%a,_=4294967296*I+u,S=""+_%a,s+S+d}l(h,"readInt8"),f.exports=h}),dr=H((E,f)=>{Q();var a=pr(),h=l(function(t,p,g,m,b){g=g||0,m=m||!1,b=b||function(N,F,O){return N*Math.pow(2,O)+F};var T=g>>3,x=l(function(N){return m?~N&255:N},"inv"),v=255,L=8-g%8;p<L&&(v=255<<8-p&255,L=p),g&&(v=v>>g%8);var P=0;g%8+p>=8&&(P=b(0,x(t[T])&v,L));for(var C=p+g>>3,k=T+1;k<C;k++)P=b(P,x(t[k]),8);var M=(p+g)%8;return M>0&&(P=b(P,x(t[C])>>8-M,M)),P},"parseBits"),i=l(function(t,p,g){var m=Math.pow(2,g-1)-1,b=h(t,1),T=h(t,g,1);if(T===0)return 0;var x=1,v=l(function(P,C,k){P===0&&(P=1);for(var M=1;M<=k;M++)x/=2,(C&1<<k-M)>0&&(P+=x);return P},"parsePrecisionBits"),L=h(t,p,g+1,!1,v);return T==Math.pow(2,g+1)-1?L===0?b===0?1/0:-1/0:NaN:(b===0?1:-1)*Math.pow(2,T-m)*L},"parseFloatFromBits"),n=l(function(t){return h(t,1)==1?-1*(h(t,15,1,!0)+1):h(t,15,1)},"parseInt16"),u=l(function(t){return h(t,1)==1?-1*(h(t,31,1,!0)+1):h(t,31,1)},"parseInt32"),s=l(function(t){return i(t,23,8)},"parseFloat32"),d=l(function(t){return i(t,52,11)},"parseFloat64"),I=l(function(t){var p=h(t,16,32);if(p==49152)return NaN;for(var g=Math.pow(1e4,h(t,16,16)),m=0,b=[],T=h(t,16),x=0;x<T;x++)m+=h(t,16,64+16*x)*g,g/=1e4;var v=Math.pow(10,h(t,16,48));return(p===0?1:-1)*Math.round(m*v)/v},"parseNumeric"),_=l(function(t,p){var g=h(p,1),m=h(p,63,1),b=new Date((g===0?1:-1)*m/1e3+9466848e5);return t||b.setTime(b.getTime()+b.getTimezoneOffset()*6e4),b.usec=m%1e3,b.getMicroSeconds=function(){return this.usec},b.setMicroSeconds=function(T){this.usec=T},b.getUTCMicroSeconds=function(){return this.usec},b},"parseDate"),S=l(function(t){for(var p=h(t,32),g=h(t,32,32),m=h(t,32,64),b=96,T=[],x=0;x<p;x++)T[x]=h(t,32,b),b+=32,b+=32;var v=l(function(P){var C=h(t,32,b);if(b+=32,C==4294967295)return null;var k;if(P==23||P==20)return k=h(t,C*8,b),b+=C*8,k;if(P==25)return k=t.toString(this.encoding,b>>3,(b+=C<<3)>>3),k;console.log("ERROR: ElementType not implemented: "+P)},"parseElement"),L=l(function(P,C){var k=[],M;if(P.length>1){var N=P.shift();for(M=0;M<N;M++)k[M]=L(P,C);P.unshift(N)}else for(M=0;M<P[0];M++)k[M]=v(C);return k},"parse");return L(T,m)},"parseArray"),y=l(function(t){return t.toString("utf8")},"parseText"),w=l(function(t){return t===null?null:h(t,8)>0},"parseBool"),c=l(function(t){t(20,a),t(21,n),t(23,u),t(26,u),t(1700,I),t(700,s),t(701,d),t(16,w),t(1114,_.bind(null,!1)),t(1184,_.bind(null,!0)),t(1e3,S),t(1007,S),t(1016,S),t(1008,S),t(1009,S),t(25,y)},"init");f.exports={init:c}}),yr=H((E,f)=>{Q(),f.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),Te=H(E=>{Q();var f=fr(),a=dr(),h=gt(),i=yr();E.getTypeParser=s,E.setTypeParser=d,E.arrayParser=h,E.builtins=i;var n={text:{},binary:{}};function u(I){return String(I)}l(u,"noParse");function s(I,_){return _=_||"text",n[_]&&n[_][I]||u}l(s,"getTypeParser");function d(I,_,S){typeof _=="function"&&(S=_,_="text"),n[_][I]=S}l(d,"setTypeParser"),f.init(function(I,_){n.text[I]=_}),a.init(function(I,_){n.binary[I]=_})}),Me=H((E,f)=>{"use strict";Q(),f.exports={host:"localhost",user:G.platform==="win32"?G.env.USERNAME:G.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var a=Te(),h=a.getTypeParser(20,"text"),i=a.getTypeParser(1016,"text");f.exports.__defineSetter__("parseInt8",function(n){a.setTypeParser(20,"text",n?a.getTypeParser(23,"text"):h),a.setTypeParser(1016,"text",n?a.getTypeParser(1007,"text"):i)})}),xe=H((E,f)=>{"use strict";Q();var a=(pt(),te(Ge)),h=Me();function i(c){var t=c.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+t+'"'}l(i,"escapeElement");function n(c){for(var t="{",p=0;p<c.length;p++)p>0&&(t=t+","),c[p]===null||typeof c[p]>"u"?t=t+"NULL":Array.isArray(c[p])?t=t+n(c[p]):c[p]instanceof $?t+="\\\\x"+c[p].toString("hex"):t+=i(u(c[p]));return t=t+"}",t}l(n,"arrayString");var u=l(function(c,t){if(c==null)return null;if(c instanceof $)return c;if(ArrayBuffer.isView(c)){var p=$.from(c.buffer,c.byteOffset,c.byteLength);return p.length===c.byteLength?p:p.slice(c.byteOffset,c.byteOffset+c.byteLength)}return c instanceof Date?h.parseInputDatesAsUTC?_(c):I(c):Array.isArray(c)?n(c):typeof c=="object"?s(c,t):c.toString()},"prepareValue");function s(c,t){if(c&&typeof c.toPostgres=="function"){if(t=t||[],t.indexOf(c)!==-1)throw new Error('circular reference detected while preparing "'+c+'" for query');return t.push(c),u(c.toPostgres(u),t)}return JSON.stringify(c)}l(s,"prepareObject");function d(c,t){for(c=""+c;c.length<t;)c="0"+c;return c}l(d,"pad");function I(c){var t=-c.getTimezoneOffset(),p=c.getFullYear(),g=p<1;g&&(p=Math.abs(p)+1);var m=d(p,4)+"-"+d(c.getMonth()+1,2)+"-"+d(c.getDate(),2)+"T"+d(c.getHours(),2)+":"+d(c.getMinutes(),2)+":"+d(c.getSeconds(),2)+"."+d(c.getMilliseconds(),3);return t<0?(m+="-",t*=-1):m+="+",m+=d(Math.floor(t/60),2)+":"+d(t%60,2),g&&(m+=" BC"),m}l(I,"dateToString");function _(c){var t=c.getUTCFullYear(),p=t<1;p&&(t=Math.abs(t)+1);var g=d(t,4)+"-"+d(c.getUTCMonth()+1,2)+"-"+d(c.getUTCDate(),2)+"T"+d(c.getUTCHours(),2)+":"+d(c.getUTCMinutes(),2)+":"+d(c.getUTCSeconds(),2)+"."+d(c.getUTCMilliseconds(),3);return g+="+00:00",p&&(g+=" BC"),g}l(_,"dateToStringUTC");function S(c,t,p){return c=typeof c=="string"?{text:c}:c,t&&(typeof t=="function"?c.callback=t:c.values=t),p&&(c.callback=p),c}l(S,"normalizeQueryConfig");var y=l(function(c){return a.createHash("md5").update(c,"utf-8").digest("hex")},"md5"),w=l(function(c,t,p){var g=y(t+c),m=y($.concat([$.from(g),p]));return"md5"+m},"postgresMd5PasswordHash");f.exports={prepareValue:l(function(c){return u(c)},"prepareValueWrapper"),normalizeQueryConfig:S,postgresMd5PasswordHash:w,md5:y}}),gr=H((E,f)=>{"use strict";Q();var a=(pt(),te(Ge));function h(t){if(t.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let p=a.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:p,response:"n,,n=*,r="+p,message:"SASLInitialResponse"}}l(h,"startSession");function i(t,p,g){if(t.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof p!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof g!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let m=I(g);if(m.nonce.startsWith(t.clientNonce)){if(m.nonce.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var b=$.from(m.salt,"base64"),T=c(p,b,m.iteration),x=w(T,"Client Key"),v=y(x),L="n=*,r="+t.clientNonce,P="r="+m.nonce+",s="+m.salt+",i="+m.iteration,C="c=biws,r="+m.nonce,k=L+","+P+","+C,M=w(v,k),N=S(x,M),F=N.toString("base64"),O=w(T,"Server Key"),U=w(O,k);t.message="SASLResponse",t.serverSignature=U.toString("base64"),t.response=C+",p="+F}l(i,"continueSession");function n(t,p){if(t.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof p!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:g}=_(p);if(g!==t.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}l(n,"finalizeSession");function u(t){if(typeof t!="string")throw new TypeError("SASL: text must be a string");return t.split("").map((p,g)=>t.charCodeAt(g)).every(p=>p>=33&&p<=43||p>=45&&p<=126)}l(u,"isPrintableChars");function s(t){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(t)}l(s,"isBase64");function d(t){if(typeof t!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(t.split(",").map(p=>{if(!/^.=/.test(p))throw new Error("SASL: Invalid attribute pair entry");let g=p[0],m=p.substring(2);return[g,m]}))}l(d,"parseAttributePairs");function I(t){let p=d(t),g=p.get("r");if(g){if(!u(g))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let m=p.get("s");if(m){if(!s(m))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let b=p.get("i");if(b){if(!/^[1-9][0-9]*$/.test(b))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let T=parseInt(b,10);return{nonce:g,salt:m,iteration:T}}l(I,"parseServerFirstMessage");function _(t){let p=d(t).get("v");if(p){if(!s(p))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:p}}l(_,"parseServerFinalMessage");function S(t,p){if(!$.isBuffer(t))throw new TypeError("first argument must be a Buffer");if(!$.isBuffer(p))throw new TypeError("second argument must be a Buffer");if(t.length!==p.length)throw new Error("Buffer lengths must match");if(t.length===0)throw new Error("Buffers cannot be empty");return $.from(t.map((g,m)=>t[m]^p[m]))}l(S,"xorBuffers");function y(t){return a.createHash("sha256").update(t).digest()}l(y,"sha256");function w(t,p){return a.createHmac("sha256",t).update(p).digest()}l(w,"hmacSha256");function c(t,p,g){for(var m=w(t,$.concat([p,$.from([0,0,0,1])])),b=m,T=0;T<g-1;T++)m=w(t,m),b=S(b,m);return b}l(c,"Hi"),f.exports={startSession:h,continueSession:i,finalizeSession:n}}),He={};ue(He,{join:()=>mt});function mt(...E){return E.join("/")}var bt=ie(()=>{"use strict";Q(),l(mt,"join")}),Ve={};ue(Ve,{stat:()=>wt});function wt(E,f){f(new Error("No filesystem"))}var vt=ie(()=>{"use strict";Q(),l(wt,"stat")}),ze={};ue(ze,{default:()=>St});var St,Et=ie(()=>{"use strict";Q(),St={}}),_t={};ue(_t,{StringDecoder:()=>At});var qe,At,mr=ie(()=>{"use strict";Q(),qe=class{constructor(f){z(this,"td"),this.td=new TextDecoder(f)}write(f){return this.td.decode(f,{stream:!0})}end(f){return this.td.decode(f)}},l(qe,"StringDecoder"),At=qe}),br=H((E,f)=>{"use strict";Q();var{Transform:a}=(Et(),te(ze)),{StringDecoder:h}=(mr(),te(_t)),i=Symbol("last"),n=Symbol("decoder");function u(S,y,w){let c;if(this.overflow){if(c=this[n].write(S).split(this.matcher),c.length===1)return w();c.shift(),this.overflow=!1}else this[i]+=this[n].write(S),c=this[i].split(this.matcher);this[i]=c.pop();for(let t=0;t<c.length;t++)try{d(this,this.mapper(c[t]))}catch(p){return w(p)}if(this.overflow=this[i].length>this.maxLength,this.overflow&&!this.skipOverflow){w(new Error("maximum buffer reached"));return}w()}l(u,"transform");function s(S){if(this[i]+=this[n].end(),this[i])try{d(this,this.mapper(this[i]))}catch(y){return S(y)}S()}l(s,"flush");function d(S,y){y!==void 0&&S.push(y)}l(d,"push");function I(S){return S}l(I,"noop");function _(S,y,w){switch(S=S||/\r?\n/,y=y||I,w=w||{},arguments.length){case 1:typeof S=="function"?(y=S,S=/\r?\n/):typeof S=="object"&&!(S instanceof RegExp)&&!S[Symbol.split]&&(w=S,S=/\r?\n/);break;case 2:typeof S=="function"?(w=y,y=S,S=/\r?\n/):typeof y=="object"&&(w=y,y=I)}w=Object.assign({},w),w.autoDestroy=!0,w.transform=u,w.flush=s,w.readableObjectMode=!0;let c=new a(w);return c[i]="",c[n]=new h("utf8"),c.matcher=S,c.mapper=y,c.maxLength=w.maxLength,c.skipOverflow=w.skipOverflow||!1,c.overflow=!1,c._destroy=function(t,p){this._writableState.errorEmitted=!1,p(t)},c}l(_,"split"),f.exports=_}),wr=H((E,f)=>{"use strict";Q();var a=(bt(),te(He)),h=(Et(),te(ze)).Stream,i=br(),n=(Pe(),te(_e)),u=5432,s=G.platform==="win32",d=G.stderr,I=56,_=7,S=61440,y=32768;function w(x){return(x&S)==y}l(w,"isRegFile");var c=["host","port","database","user","password"],t=c.length,p=c[t-1];function g(){var x=d instanceof h&&d.writable===!0;if(x){var v=Array.prototype.slice.call(arguments).concat(`
`);d.write(n.format.apply(n,v))}}l(g,"warn"),Object.defineProperty(f.exports,"isWin",{get:function(){return s},set:function(x){s=x}}),f.exports.warnTo=function(x){var v=d;return d=x,v},f.exports.getFileName=function(x){var v=x||G.env,L=v.PGPASSFILE||(s?a.join(v.APPDATA||"./","postgresql","pgpass.conf"):a.join(v.HOME||"./",".pgpass"));return L},f.exports.usePgPass=function(x,v){return Object.prototype.hasOwnProperty.call(G.env,"PGPASSWORD")?!1:s?!0:(v=v||"<unkn>",w(x.mode)?x.mode&(I|_)?(g('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',v),!1):!0:(g('WARNING: password file "%s" is not a plain file',v),!1))};var m=f.exports.match=function(x,v){return c.slice(0,-1).reduce(function(L,P,C){return C==1&&Number(x[P]||u)===Number(v[P])?L&&!0:L&&(v[P]==="*"||v[P]===x[P])},!0)};f.exports.getPassword=function(x,v,L){var P,C=v.pipe(i());function k(F){var O=b(F);O&&T(O)&&m(x,O)&&(P=O[p],C.end())}l(k,"onLine");var M=l(function(){v.destroy(),L(P)},"onEnd"),N=l(function(F){v.destroy(),g("WARNING: error on reading file: %s",F),L(void 0)},"onErr");v.on("error",N),C.on("data",k).on("end",M).on("error",N)};var b=f.exports.parseLine=function(x){if(x.length<11||x.match(/^\s+#/))return null;for(var v="",L="",P=0,C=0,k=0,M={},N=!1,F=l(function(U,q,W){var V=x.substring(q,W);Object.hasOwnProperty.call(G.env,"PGPASS_NO_DEESCAPE")||(V=V.replace(/\\([:\\])/g,"$1")),M[c[U]]=V},"addToObj"),O=0;O<x.length-1;O+=1){if(v=x.charAt(O+1),L=x.charAt(O),N=P==t-1,N){F(P,C);break}O>=0&&v==":"&&L!=="\\"&&(F(P,C,O+1),C=O+2,P+=1)}return M=Object.keys(M).length===t?M:null,M},T=f.exports.isValidEntry=function(x){for(var v={0:function(M){return M.length>0},1:function(M){return M==="*"?!0:(M=Number(M),isFinite(M)&&M>0&&M<9007199254740992&&Math.floor(M)===M)},2:function(M){return M.length>0},3:function(M){return M.length>0},4:function(M){return M.length>0}},L=0;L<c.length;L+=1){var P=v[L],C=x[c[L]]||"",k=P(C);if(!k)return!1}return!0}}),vr=H((E,f)=>{"use strict";Q();var a=(bt(),te(He)),h=(vt(),te(Ve)),i=wr();f.exports=function(n,u){var s=i.getFileName();h.stat(s,function(d,I){if(d||!i.usePgPass(I,s))return u(void 0);var _=h.createReadStream(s);i.getPassword(n,_,u)})},f.exports.warnTo=i.warnTo}),It=H((E,f)=>{"use strict";Q();var a=Te();function h(i){this._types=i||a,this.text={},this.binary={}}l(h,"TypeOverrides"),h.prototype.getOverrides=function(i){switch(i){case"text":return this.text;case"binary":return this.binary;default:return{}}},h.prototype.setTypeParser=function(i,n,u){typeof n=="function"&&(u=n,n="text"),this.getOverrides(n)[i]=u},h.prototype.getTypeParser=function(i,n){return n=n||"text",this.getOverrides(n)[i]||this._types.getTypeParser(i,n)},f.exports=h}),Ct={};ue(Ct,{default:()=>Rt});var Rt,Sr=ie(()=>{"use strict";Q(),Rt={}}),Lt={};ue(Lt,{parse:()=>Ke});function Ke(E,f=!1){let{protocol:a}=new URL(E),h="http:"+E.substring(a.length),{username:i,password:n,host:u,hostname:s,port:d,pathname:I,search:_,searchParams:S,hash:y}=new URL(h);n=decodeURIComponent(n),i=decodeURIComponent(i),I=decodeURIComponent(I);let w=i+":"+n,c=f?Object.fromEntries(S.entries()):_;return{href:E,protocol:a,auth:w,username:i,password:n,host:u,hostname:s,port:d,pathname:I,search:_,query:c,hash:y}}var Pt=ie(()=>{"use strict";Q(),l(Ke,"parse")}),Er=H((E,f)=>{"use strict";Q();var a=(Pt(),te(Lt)),h=(vt(),te(Ve));function i(n){if(n.charAt(0)==="/"){var s=n.split(" ");return{host:s[0],database:s[1]}}var u=a.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(n)?encodeURI(n).replace(/\%25(\d\d)/g,"%$1"):n,!0),s=u.query;for(var d in s)Array.isArray(s[d])&&(s[d]=s[d][s[d].length-1]);var I=(u.auth||":").split(":");if(s.user=I[0],s.password=I.splice(1).join(":"),s.port=u.port,u.protocol=="socket:")return s.host=decodeURI(u.pathname),s.database=u.query.db,s.client_encoding=u.query.encoding,s;s.host||(s.host=u.hostname);var _=u.pathname;if(!s.host&&_&&/^%2f/i.test(_)){var S=_.split("/");s.host=decodeURIComponent(S[0]),_=S.splice(1).join("/")}switch(_&&_.charAt(0)==="/"&&(_=_.slice(1)||null),s.database=_&&decodeURI(_),(s.ssl==="true"||s.ssl==="1")&&(s.ssl=!0),s.ssl==="0"&&(s.ssl=!1),(s.sslcert||s.sslkey||s.sslrootcert||s.sslmode)&&(s.ssl={}),s.sslcert&&(s.ssl.cert=h.readFileSync(s.sslcert).toString()),s.sslkey&&(s.ssl.key=h.readFileSync(s.sslkey).toString()),s.sslrootcert&&(s.ssl.ca=h.readFileSync(s.sslrootcert).toString()),s.sslmode){case"disable":{s.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{s.ssl.rejectUnauthorized=!1;break}}return s}l(i,"parse"),f.exports=i,i.parse=i}),Ye=H((E,f)=>{"use strict";Q();var a=(Sr(),te(Ct)),h=Me(),i=Er().parse,n=l(function(S,y,w){return w===void 0?w=G.env["PG"+S.toUpperCase()]:w===!1||(w=G.env[w]),y[S]||w||h[S]},"val"),u=l(function(){switch(G.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return h.ssl},"readSSLConfigFromEnvironment"),s=l(function(S){return"'"+(""+S).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),d=l(function(S,y,w){var c=y[w];c!=null&&S.push(w+"="+s(c))},"add"),I=class{constructor(y){y=typeof y=="string"?i(y):y||{},y.connectionString&&(y=Object.assign({},y,i(y.connectionString))),this.user=n("user",y),this.database=n("database",y),this.database===void 0&&(this.database=this.user),this.port=parseInt(n("port",y),10),this.host=n("host",y),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:n("password",y)}),this.binary=n("binary",y),this.options=n("options",y),this.ssl=typeof y.ssl>"u"?u():y.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=n("client_encoding",y),this.replication=n("replication",y),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=n("application_name",y,"PGAPPNAME"),this.fallback_application_name=n("fallback_application_name",y,!1),this.statement_timeout=n("statement_timeout",y,!1),this.lock_timeout=n("lock_timeout",y,!1),this.idle_in_transaction_session_timeout=n("idle_in_transaction_session_timeout",y,!1),this.query_timeout=n("query_timeout",y,!1),y.connectionTimeoutMillis===void 0?this.connect_timeout=G.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(y.connectionTimeoutMillis/1e3),y.keepAlive===!1?this.keepalives=0:y.keepAlive===!0&&(this.keepalives=1),typeof y.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(y.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(y){var w=[];d(w,this,"user"),d(w,this,"password"),d(w,this,"port"),d(w,this,"application_name"),d(w,this,"fallback_application_name"),d(w,this,"connect_timeout"),d(w,this,"options");var c=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(d(w,c,"sslmode"),d(w,c,"sslca"),d(w,c,"sslkey"),d(w,c,"sslcert"),d(w,c,"sslrootcert"),this.database&&w.push("dbname="+s(this.database)),this.replication&&w.push("replication="+s(this.replication)),this.host&&w.push("host="+s(this.host)),this.isDomainSocket)return y(null,w.join(" "));this.client_encoding&&w.push("client_encoding="+s(this.client_encoding)),a.lookup(this.host,function(t,p){return t?y(t,null):(w.push("hostaddr="+s(p)),y(null,w.join(" ")))})}};l(I,"ConnectionParameters");var _=I;f.exports=_}),_r=H((E,f)=>{"use strict";Q();var a=Te(),h=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,i=class{constructor(s,d){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=d,this.RowCtor=null,this.rowAsArray=s==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(s){var d;s.text?d=h.exec(s.text):d=h.exec(s.command),d&&(this.command=d[1],d[3]?(this.oid=parseInt(d[2],10),this.rowCount=parseInt(d[3],10)):d[2]&&(this.rowCount=parseInt(d[2],10)))}_parseRowAsArray(s){for(var d=new Array(s.length),I=0,_=s.length;I<_;I++){var S=s[I];S!==null?d[I]=this._parsers[I](S):d[I]=null}return d}parseRow(s){for(var d={},I=0,_=s.length;I<_;I++){var S=s[I],y=this.fields[I].name;S!==null?d[y]=this._parsers[I](S):d[y]=null}return d}addRow(s){this.rows.push(s)}addFields(s){this.fields=s,this.fields.length&&(this._parsers=new Array(s.length));for(var d=0;d<s.length;d++){var I=s[d];this._types?this._parsers[d]=this._types.getTypeParser(I.dataTypeID,I.format||"text"):this._parsers[d]=a.getTypeParser(I.dataTypeID,I.format||"text")}}};l(i,"Result");var n=i;f.exports=n}),Ar=H((E,f)=>{"use strict";Q();var{EventEmitter:a}=pe(),h=_r(),i=xe(),n=class extends a{constructor(d,I,_){super(),d=i.normalizeQueryConfig(d,I,_),this.text=d.text,this.values=d.values,this.rows=d.rows,this.types=d.types,this.name=d.name,this.binary=d.binary,this.portal=d.portal||"",this.callback=d.callback,this._rowMode=d.rowMode,G.domain&&d.callback&&(this.callback=G.domain.bind(d.callback)),this._result=new h(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new h(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(d){this._checkForMultirow(),this._result.addFields(d.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(d){let I;if(!this._canceledDueToError){try{I=this._result.parseRow(d.fields)}catch(_){this._canceledDueToError=_;return}this.emit("row",I,this._result),this._accumulateRows&&this._result.addRow(I)}}handleCommandComplete(d,I){this._checkForMultirow(),this._result.addCommandComplete(d),this.rows&&I.sync()}handleEmptyQuery(d){this.rows&&d.sync()}handleError(d,I){if(this._canceledDueToError&&(d=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(d);this.emit("error",d)}handleReadyForQuery(d){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,d);if(this.callback)try{this.callback(null,this._results)}catch(I){G.nextTick(()=>{throw I})}this.emit("end",this._results)}submit(d){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let I=d.parsedStatements[this.name];return this.text&&I&&this.text!==I?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(d):d.query(this.text),null)}hasBeenParsed(d){return this.name&&d.parsedStatements[this.name]}handlePortalSuspended(d){this._getRows(d,this.rows)}_getRows(d,I){d.execute({portal:this.portal,rows:I}),I?d.flush():d.sync()}prepare(d){this.isPreparedStatement=!0,this.hasBeenParsed(d)||d.parse({text:this.text,name:this.name,types:this.types});try{d.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:i.prepareValue})}catch(I){this.handleError(I,d);return}d.describe({type:"P",name:this.portal||""}),this._getRows(d,this.rows)}handleCopyInResponse(d){d.sendCopyFail("No source stream defined")}handleCopyData(d,I){}};l(n,"Query");var u=n;f.exports=u}),Tt={};ue(Tt,{Socket:()=>Be,isIP:()=>Mt});function Mt(E){return 0}var st,it,ve,Be,Ze=ie(()=>{"use strict";Q(),st=Ee(pe(),1),l(Mt,"isIP"),it=l(E=>E.replace(/^[^.]+\./,"api."),"transformHost"),ve=class j extends st.EventEmitter{constructor(){super(...arguments),z(this,"opts",{}),z(this,"connecting",!1),z(this,"pending",!0),z(this,"writable",!0),z(this,"encrypted",!1),z(this,"authorized",!1),z(this,"destroyed",!1),z(this,"ws",null),z(this,"writeBuffer"),z(this,"tlsState",0),z(this,"tlsRead"),z(this,"tlsWrite")}static get poolQueryViaFetch(){return j.opts.poolQueryViaFetch??j.defaults.poolQueryViaFetch}static set poolQueryViaFetch(f){j.opts.poolQueryViaFetch=f}static get fetchEndpoint(){return j.opts.fetchEndpoint??j.defaults.fetchEndpoint}static set fetchEndpoint(f){j.opts.fetchEndpoint=f}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(f){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return j.opts.fetchFunction??j.defaults.fetchFunction}static set fetchFunction(f){j.opts.fetchFunction=f}static get webSocketConstructor(){return j.opts.webSocketConstructor??j.defaults.webSocketConstructor}static set webSocketConstructor(f){j.opts.webSocketConstructor=f}get webSocketConstructor(){return this.opts.webSocketConstructor??j.webSocketConstructor}set webSocketConstructor(f){this.opts.webSocketConstructor=f}static get wsProxy(){return j.opts.wsProxy??j.defaults.wsProxy}static set wsProxy(f){j.opts.wsProxy=f}get wsProxy(){return this.opts.wsProxy??j.wsProxy}set wsProxy(f){this.opts.wsProxy=f}static get coalesceWrites(){return j.opts.coalesceWrites??j.defaults.coalesceWrites}static set coalesceWrites(f){j.opts.coalesceWrites=f}get coalesceWrites(){return this.opts.coalesceWrites??j.coalesceWrites}set coalesceWrites(f){this.opts.coalesceWrites=f}static get useSecureWebSocket(){return j.opts.useSecureWebSocket??j.defaults.useSecureWebSocket}static set useSecureWebSocket(f){j.opts.useSecureWebSocket=f}get useSecureWebSocket(){return this.opts.useSecureWebSocket??j.useSecureWebSocket}set useSecureWebSocket(f){this.opts.useSecureWebSocket=f}static get forceDisablePgSSL(){return j.opts.forceDisablePgSSL??j.defaults.forceDisablePgSSL}static set forceDisablePgSSL(f){j.opts.forceDisablePgSSL=f}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??j.forceDisablePgSSL}set forceDisablePgSSL(f){this.opts.forceDisablePgSSL=f}static get disableSNI(){return j.opts.disableSNI??j.defaults.disableSNI}static set disableSNI(f){j.opts.disableSNI=f}get disableSNI(){return this.opts.disableSNI??j.disableSNI}set disableSNI(f){this.opts.disableSNI=f}static get pipelineConnect(){return j.opts.pipelineConnect??j.defaults.pipelineConnect}static set pipelineConnect(f){j.opts.pipelineConnect=f}get pipelineConnect(){return this.opts.pipelineConnect??j.pipelineConnect}set pipelineConnect(f){this.opts.pipelineConnect=f}static get subtls(){return j.opts.subtls??j.defaults.subtls}static set subtls(f){j.opts.subtls=f}get subtls(){return this.opts.subtls??j.subtls}set subtls(f){this.opts.subtls=f}static get pipelineTLS(){return j.opts.pipelineTLS??j.defaults.pipelineTLS}static set pipelineTLS(f){j.opts.pipelineTLS=f}get pipelineTLS(){return this.opts.pipelineTLS??j.pipelineTLS}set pipelineTLS(f){this.opts.pipelineTLS=f}static get rootCerts(){return j.opts.rootCerts??j.defaults.rootCerts}static set rootCerts(f){j.opts.rootCerts=f}get rootCerts(){return this.opts.rootCerts??j.rootCerts}set rootCerts(f){this.opts.rootCerts=f}wsProxyAddrForHost(f,a){let h=this.wsProxy;if(h===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof h=="function"?h(f,a):`${h}?address=${f}:${a}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(f,a,h){this.connecting=!0,h&&this.once("connect",h);let i=l(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),n=l((s,d=!1)=>{s.binaryType="arraybuffer",s.addEventListener("error",I=>{this.emit("error",I),this.emit("close")}),s.addEventListener("message",I=>{if(this.tlsState===0){let _=$.from(I.data);this.emit("data",_)}}),s.addEventListener("close",()=>{this.emit("close")}),d?i():s.addEventListener("open",i)},"configureWebSocket"),u;try{u=this.wsProxyAddrForHost(a,typeof f=="string"?parseInt(f,10):f)}catch(s){this.emit("error",s),this.emit("close");return}try{let s=(this.useSecureWebSocket?"wss:":"ws:")+"//"+u;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(s),n(this.ws);else try{this.ws=new WebSocket(s),n(this.ws)}catch{this.ws=new __unstable_WebSocket(s),n(this.ws)}}catch(s){let d=(this.useSecureWebSocket?"https:":"http:")+"//"+u;fetch(d,{headers:{Upgrade:"websocket"}}).then(I=>{if(this.ws=I.webSocket,this.ws==null)throw s;this.ws.accept(),n(this.ws,!0)}).catch(I=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${I.message}`)),this.emit("close")})}}async startTls(f){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let a=this.subtls.TrustedCert.fromPEM(this.rootCerts),h=new this.subtls.WebSocketReadQueue(this.ws),i=h.read.bind(h),n=this.rawWrite.bind(this),[u,s]=await this.subtls.startTls(f,a,i,n,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=u,this.tlsWrite=s,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let f=await this.tlsRead();if(f===void 0)break;{let a=$.from(f);this.emit("data",a)}}}rawWrite(f){if(!this.coalesceWrites){this.ws.send(f);return}if(this.writeBuffer===void 0)this.writeBuffer=f,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let a=new Uint8Array(this.writeBuffer.length+f.length);a.set(this.writeBuffer),a.set(f,this.writeBuffer.length),this.writeBuffer=a}}write(f,a="utf8",h=i=>{}){return f.length===0?(h(),!0):(typeof f=="string"&&(f=$.from(f,a)),this.tlsState===0?(this.rawWrite(f),h()):this.tlsState===1?this.once("secureConnection",()=>{this.write(f,a,h)}):(this.tlsWrite(f),h()),!0)}end(f=$.alloc(0),a="utf8",h=()=>{}){return this.write(f,a,()=>{this.ws.close(),h()}),this}destroy(){return this.destroyed=!0,this.end()}},l(ve,"Socket"),z(ve,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:E=>"https://"+it(E)+"/sql",fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:E=>E+"/v2",useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),z(ve,"opts",{}),Be=ve}),xt=H(E=>{"use strict";Q(),Object.defineProperty(E,"__esModule",{value:!0}),E.NoticeMessage=E.DataRowMessage=E.CommandCompleteMessage=E.ReadyForQueryMessage=E.NotificationResponseMessage=E.BackendKeyDataMessage=E.AuthenticationMD5Password=E.ParameterStatusMessage=E.ParameterDescriptionMessage=E.RowDescriptionMessage=E.Field=E.CopyResponse=E.CopyDataMessage=E.DatabaseError=E.copyDone=E.emptyQuery=E.replicationStart=E.portalSuspended=E.noData=E.closeComplete=E.bindComplete=E.parseComplete=void 0,E.parseComplete={name:"parseComplete",length:5},E.bindComplete={name:"bindComplete",length:5},E.closeComplete={name:"closeComplete",length:5},E.noData={name:"noData",length:5},E.portalSuspended={name:"portalSuspended",length:5},E.replicationStart={name:"replicationStart",length:4},E.emptyQuery={name:"emptyQuery",length:4},E.copyDone={name:"copyDone",length:4};var f=class extends Error{constructor(O,U,q){super(O),this.length=U,this.name=q}};l(f,"DatabaseError");var a=f;E.DatabaseError=a;var h=class{constructor(O,U){this.length=O,this.chunk=U,this.name="copyData"}};l(h,"CopyDataMessage");var i=h;E.CopyDataMessage=i;var n=class{constructor(O,U,q,W){this.length=O,this.name=U,this.binary=q,this.columnTypes=new Array(W)}};l(n,"CopyResponse");var u=n;E.CopyResponse=u;var s=class{constructor(O,U,q,W,V,K,oe){this.name=O,this.tableID=U,this.columnID=q,this.dataTypeID=W,this.dataTypeSize=V,this.dataTypeModifier=K,this.format=oe}};l(s,"Field");var d=s;E.Field=d;var I=class{constructor(O,U){this.length=O,this.fieldCount=U,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};l(I,"RowDescriptionMessage");var _=I;E.RowDescriptionMessage=_;var S=class{constructor(O,U){this.length=O,this.parameterCount=U,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};l(S,"ParameterDescriptionMessage");var y=S;E.ParameterDescriptionMessage=y;var w=class{constructor(O,U,q){this.length=O,this.parameterName=U,this.parameterValue=q,this.name="parameterStatus"}};l(w,"ParameterStatusMessage");var c=w;E.ParameterStatusMessage=c;var t=class{constructor(O,U){this.length=O,this.salt=U,this.name="authenticationMD5Password"}};l(t,"AuthenticationMD5Password");var p=t;E.AuthenticationMD5Password=p;var g=class{constructor(O,U,q){this.length=O,this.processID=U,this.secretKey=q,this.name="backendKeyData"}};l(g,"BackendKeyDataMessage");var m=g;E.BackendKeyDataMessage=m;var b=class{constructor(O,U,q,W){this.length=O,this.processId=U,this.channel=q,this.payload=W,this.name="notification"}};l(b,"NotificationResponseMessage");var T=b;E.NotificationResponseMessage=T;var x=class{constructor(O,U){this.length=O,this.status=U,this.name="readyForQuery"}};l(x,"ReadyForQueryMessage");var v=x;E.ReadyForQueryMessage=v;var L=class{constructor(O,U){this.length=O,this.text=U,this.name="commandComplete"}};l(L,"CommandCompleteMessage");var P=L;E.CommandCompleteMessage=P;var C=class{constructor(O,U){this.length=O,this.fields=U,this.name="dataRow",this.fieldCount=U.length}};l(C,"DataRowMessage");var k=C;E.DataRowMessage=k;var M=class{constructor(O,U){this.length=O,this.message=U,this.name="notice"}};l(M,"NoticeMessage");var N=M;E.NoticeMessage=N}),Ir=H(E=>{"use strict";Q(),Object.defineProperty(E,"__esModule",{value:!0}),E.Writer=void 0;var f=class{constructor(i=256){this.size=i,this.offset=5,this.headerPosition=0,this.buffer=$.allocUnsafe(i)}ensure(i){var n=this.buffer.length-this.offset;if(n<i){var u=this.buffer,s=u.length+(u.length>>1)+i;this.buffer=$.allocUnsafe(s),u.copy(this.buffer)}}addInt32(i){return this.ensure(4),this.buffer[this.offset++]=i>>>24&255,this.buffer[this.offset++]=i>>>16&255,this.buffer[this.offset++]=i>>>8&255,this.buffer[this.offset++]=i>>>0&255,this}addInt16(i){return this.ensure(2),this.buffer[this.offset++]=i>>>8&255,this.buffer[this.offset++]=i>>>0&255,this}addCString(i){if(!i)this.ensure(1);else{var n=$.byteLength(i);this.ensure(n+1),this.buffer.write(i,this.offset,"utf-8"),this.offset+=n}return this.buffer[this.offset++]=0,this}addString(i=""){var n=$.byteLength(i);return this.ensure(n),this.buffer.write(i,this.offset),this.offset+=n,this}add(i){return this.ensure(i.length),i.copy(this.buffer,this.offset),this.offset+=i.length,this}join(i){if(i){this.buffer[this.headerPosition]=i;let n=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(n,this.headerPosition+1)}return this.buffer.slice(i?0:5,this.offset)}flush(i){var n=this.join(i);return this.offset=5,this.headerPosition=0,this.buffer=$.allocUnsafe(this.size),n}};l(f,"Writer");var a=f;E.Writer=a}),Cr=H(E=>{"use strict";Q(),Object.defineProperty(E,"__esModule",{value:!0}),E.serialize=void 0;var f=Ir(),a=new f.Writer,h=l(O=>{a.addInt16(3).addInt16(0);for(let W of Object.keys(O))a.addCString(W).addCString(O[W]);a.addCString("client_encoding").addCString("UTF8");var U=a.addCString("").flush(),q=U.length+4;return new f.Writer().addInt32(q).add(U).flush()},"startup"),i=l(()=>{let O=$.allocUnsafe(8);return O.writeInt32BE(8,0),O.writeInt32BE(80877103,4),O},"requestSsl"),n=l(O=>a.addCString(O).flush(112),"password"),u=l(function(O,U){return a.addCString(O).addInt32($.byteLength(U)).addString(U),a.flush(112)},"sendSASLInitialResponseMessage"),s=l(function(O){return a.addString(O).flush(112)},"sendSCRAMClientFinalMessage"),d=l(O=>a.addCString(O).flush(81),"query"),I=[],_=l(O=>{let U=O.name||"";U.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",U,U.length),console.error("This can cause conflicts and silent errors executing queries"));let q=O.types||I;for(var W=q.length,V=a.addCString(U).addCString(O.text).addInt16(W),K=0;K<W;K++)V.addInt32(q[K]);return a.flush(80)},"parse"),S=new f.Writer,y=l(function(O,U){for(let q=0;q<O.length;q++){let W=U?U(O[q],q):O[q];W==null?(a.addInt16(0),S.addInt32(-1)):W instanceof $?(a.addInt16(1),S.addInt32(W.length),S.add(W)):(a.addInt16(0),S.addInt32($.byteLength(W)),S.addString(W))}},"writeValues"),w=l((O={})=>{let U=O.portal||"",q=O.statement||"",W=O.binary||!1,V=O.values||I,K=V.length;return a.addCString(U).addCString(q),a.addInt16(K),y(V,O.valueMapper),a.addInt16(K),a.add(S.flush()),a.addInt16(W?1:0),a.flush(66)},"bind"),c=$.from([69,0,0,0,9,0,0,0,0,0]),t=l(O=>{if(!O||!O.portal&&!O.rows)return c;let U=O.portal||"",q=O.rows||0,W=$.byteLength(U),V=4+W+1+4,K=$.allocUnsafe(1+V);return K[0]=69,K.writeInt32BE(V,1),K.write(U,5,"utf-8"),K[W+5]=0,K.writeUInt32BE(q,K.length-4),K},"execute"),p=l((O,U)=>{let q=$.allocUnsafe(16);return q.writeInt32BE(16,0),q.writeInt16BE(1234,4),q.writeInt16BE(5678,6),q.writeInt32BE(O,8),q.writeInt32BE(U,12),q},"cancel"),g=l((O,U)=>{let q=4+$.byteLength(U)+1,W=$.allocUnsafe(1+q);return W[0]=O,W.writeInt32BE(q,1),W.write(U,5,"utf-8"),W[q]=0,W},"cstringMessage"),m=a.addCString("P").flush(68),b=a.addCString("S").flush(68),T=l(O=>O.name?g(68,`${O.type}${O.name||""}`):O.type==="P"?m:b,"describe"),x=l(O=>{let U=`${O.type}${O.name||""}`;return g(67,U)},"close"),v=l(O=>a.add(O).flush(100),"copyData"),L=l(O=>g(102,O),"copyFail"),P=l(O=>$.from([O,0,0,0,4]),"codeOnlyBuffer"),C=P(72),k=P(83),M=P(88),N=P(99),F={startup:h,password:n,requestSsl:i,sendSASLInitialResponseMessage:u,sendSCRAMClientFinalMessage:s,query:d,parse:_,bind:w,execute:t,describe:T,close:x,flush:()=>C,sync:()=>k,end:()=>M,copyData:v,copyDone:()=>N,copyFail:L,cancel:p};E.serialize=F}),Rr=H(E=>{"use strict";Q(),Object.defineProperty(E,"__esModule",{value:!0}),E.BufferReader=void 0;var f=$.allocUnsafe(0),a=class{constructor(n=0){this.offset=n,this.buffer=f,this.encoding="utf-8"}setBuffer(n,u){this.offset=n,this.buffer=u}int16(){let n=this.buffer.readInt16BE(this.offset);return this.offset+=2,n}byte(){let n=this.buffer[this.offset];return this.offset++,n}int32(){let n=this.buffer.readInt32BE(this.offset);return this.offset+=4,n}string(n){let u=this.buffer.toString(this.encoding,this.offset,this.offset+n);return this.offset+=n,u}cstring(){let n=this.offset,u=n;for(;this.buffer[u++]!==0;);return this.offset=u,this.buffer.toString(this.encoding,n,u-1)}bytes(n){let u=this.buffer.slice(this.offset,this.offset+n);return this.offset+=n,u}};l(a,"BufferReader");var h=a;E.BufferReader=h}),Bt={};ue(Bt,{default:()=>kt});var kt,Lr=ie(()=>{"use strict";Q(),kt={}}),Pr=H(E=>{"use strict";Q();var f=E&&E.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(E,"__esModule",{value:!0}),E.Parser=void 0;var a=xt(),h=Rr(),i=f((Lr(),te(Bt))),n=1,u=4,s=n+u,d=$.allocUnsafe(0),I=class{constructor(y){if(this.buffer=d,this.bufferLength=0,this.bufferOffset=0,this.reader=new h.BufferReader,y?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=y?.mode||"text"}parse(y,w){this.mergeBuffer(y);let c=this.bufferOffset+this.bufferLength,t=this.bufferOffset;for(;t+s<=c;){let p=this.buffer[t],g=this.buffer.readUInt32BE(t+n),m=n+g;if(m+t<=c){let b=this.handlePacket(t+s,p,g,this.buffer);w(b),t+=m}else break}t===c?(this.buffer=d,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=c-t,this.bufferOffset=t)}mergeBuffer(y){if(this.bufferLength>0){let w=this.bufferLength+y.byteLength;if(w+this.bufferOffset>this.buffer.byteLength){let c;if(w<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)c=this.buffer;else{let t=this.buffer.byteLength*2;for(;w>=t;)t*=2;c=$.allocUnsafe(t)}this.buffer.copy(c,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=c,this.bufferOffset=0}y.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=w}else this.buffer=y,this.bufferOffset=0,this.bufferLength=y.byteLength}handlePacket(y,w,c,t){switch(w){case 50:return a.bindComplete;case 49:return a.parseComplete;case 51:return a.closeComplete;case 110:return a.noData;case 115:return a.portalSuspended;case 99:return a.copyDone;case 87:return a.replicationStart;case 73:return a.emptyQuery;case 68:return this.parseDataRowMessage(y,c,t);case 67:return this.parseCommandCompleteMessage(y,c,t);case 90:return this.parseReadyForQueryMessage(y,c,t);case 65:return this.parseNotificationMessage(y,c,t);case 82:return this.parseAuthenticationResponse(y,c,t);case 83:return this.parseParameterStatusMessage(y,c,t);case 75:return this.parseBackendKeyData(y,c,t);case 69:return this.parseErrorMessage(y,c,t,"error");case 78:return this.parseErrorMessage(y,c,t,"notice");case 84:return this.parseRowDescriptionMessage(y,c,t);case 116:return this.parseParameterDescriptionMessage(y,c,t);case 71:return this.parseCopyInMessage(y,c,t);case 72:return this.parseCopyOutMessage(y,c,t);case 100:return this.parseCopyData(y,c,t);default:i.default.fail(`unknown message code: ${w.toString(16)}`)}}parseReadyForQueryMessage(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.string(1);return new a.ReadyForQueryMessage(w,t)}parseCommandCompleteMessage(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.cstring();return new a.CommandCompleteMessage(w,t)}parseCopyData(y,w,c){let t=c.slice(y,y+(w-4));return new a.CopyDataMessage(w,t)}parseCopyInMessage(y,w,c){return this.parseCopyMessage(y,w,c,"copyInResponse")}parseCopyOutMessage(y,w,c){return this.parseCopyMessage(y,w,c,"copyOutResponse")}parseCopyMessage(y,w,c,t){this.reader.setBuffer(y,c);let p=this.reader.byte()!==0,g=this.reader.int16(),m=new a.CopyResponse(w,t,p,g);for(let b=0;b<g;b++)m.columnTypes[b]=this.reader.int16();return m}parseNotificationMessage(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.int32(),p=this.reader.cstring(),g=this.reader.cstring();return new a.NotificationResponseMessage(w,t,p,g)}parseRowDescriptionMessage(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.int16(),p=new a.RowDescriptionMessage(w,t);for(let g=0;g<t;g++)p.fields[g]=this.parseField();return p}parseField(){let y=this.reader.cstring(),w=this.reader.int32(),c=this.reader.int16(),t=this.reader.int32(),p=this.reader.int16(),g=this.reader.int32(),m=this.reader.int16()===0?"text":"binary";return new a.Field(y,w,c,t,p,g,m)}parseParameterDescriptionMessage(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.int16(),p=new a.ParameterDescriptionMessage(w,t);for(let g=0;g<t;g++)p.dataTypeIDs[g]=this.reader.int32();return p}parseDataRowMessage(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.int16(),p=new Array(t);for(let g=0;g<t;g++){let m=this.reader.int32();p[g]=m===-1?null:this.reader.string(m)}return new a.DataRowMessage(w,p)}parseParameterStatusMessage(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.cstring(),p=this.reader.cstring();return new a.ParameterStatusMessage(w,t,p)}parseBackendKeyData(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.int32(),p=this.reader.int32();return new a.BackendKeyDataMessage(w,t,p)}parseAuthenticationResponse(y,w,c){this.reader.setBuffer(y,c);let t=this.reader.int32(),p={name:"authenticationOk",length:w};switch(t){case 0:break;case 3:p.length===8&&(p.name="authenticationCleartextPassword");break;case 5:if(p.length===12){p.name="authenticationMD5Password";let m=this.reader.bytes(4);return new a.AuthenticationMD5Password(w,m)}break;case 10:p.name="authenticationSASL",p.mechanisms=[];let g;do g=this.reader.cstring(),g&&p.mechanisms.push(g);while(g);break;case 11:p.name="authenticationSASLContinue",p.data=this.reader.string(w-8);break;case 12:p.name="authenticationSASLFinal",p.data=this.reader.string(w-8);break;default:throw new Error("Unknown authenticationOk message type "+t)}return p}parseErrorMessage(y,w,c,t){this.reader.setBuffer(y,c);let p={},g=this.reader.string(1);for(;g!=="\0";)p[g]=this.reader.cstring(),g=this.reader.string(1);let m=p.M,b=t==="notice"?new a.NoticeMessage(w,m):new a.DatabaseError(m,w,t);return b.severity=p.S,b.code=p.C,b.detail=p.D,b.hint=p.H,b.position=p.P,b.internalPosition=p.p,b.internalQuery=p.q,b.where=p.W,b.schema=p.s,b.table=p.t,b.column=p.c,b.dataType=p.d,b.constraint=p.n,b.file=p.F,b.line=p.L,b.routine=p.R,b}};l(I,"Parser");var _=I;E.Parser=_}),Ot=H(E=>{"use strict";Q(),Object.defineProperty(E,"__esModule",{value:!0}),E.DatabaseError=E.serialize=E.parse=void 0;var f=xt();Object.defineProperty(E,"DatabaseError",{enumerable:!0,get:function(){return f.DatabaseError}});var a=Cr();Object.defineProperty(E,"serialize",{enumerable:!0,get:function(){return a.serialize}});var h=Pr();function i(n,u){let s=new h.Parser;return n.on("data",d=>s.parse(d,u)),new Promise(d=>n.on("end",()=>d()))}l(i,"parse"),E.parse=i}),Dt={};ue(Dt,{connect:()=>Ut});function Ut({socket:E,servername:f}){return E.startTls(f),E}var Tr=ie(()=>{"use strict";Q(),l(Ut,"connect")}),Nt=H((E,f)=>{"use strict";Q();var a=(Ze(),te(Tt)),h=pe().EventEmitter,{parse:i,serialize:n}=Ot(),u=n.flush(),s=n.sync(),d=n.end(),I=class extends h{constructor(y){super(),y=y||{},this.stream=y.stream||new a.Socket,this._keepAlive=y.keepAlive,this._keepAliveInitialDelayMillis=y.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=y.ssl||!1,this._ending=!1,this._emitMessage=!1;var w=this;this.on("newListener",function(c){c==="message"&&(w._emitMessage=!0)})}connect(y,w){var c=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(y,w),this.stream.once("connect",function(){c._keepAlive&&c.stream.setKeepAlive(!0,c._keepAliveInitialDelayMillis),c.emit("connect")});let t=l(function(p){c._ending&&(p.code==="ECONNRESET"||p.code==="EPIPE")||c.emit("error",p)},"reportStreamError");if(this.stream.on("error",t),this.stream.on("close",function(){c.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(p){var g=p.toString("utf8");switch(g){case"S":break;case"N":return c.stream.end(),c.emit("error",new Error("The server does not support SSL connections"));default:return c.stream.end(),c.emit("error",new Error("There was an error establishing an SSL connection"))}var m=(Tr(),te(Dt));let b={socket:c.stream};c.ssl!==!0&&(Object.assign(b,c.ssl),"key"in c.ssl&&(b.key=c.ssl.key)),a.isIP(w)===0&&(b.servername=w);try{c.stream=m.connect(b)}catch(T){return c.emit("error",T)}c.attachListeners(c.stream),c.stream.on("error",t),c.emit("sslconnect")})}attachListeners(y){y.on("end",()=>{this.emit("end")}),i(y,w=>{var c=w.name==="error"?"errorMessage":w.name;this._emitMessage&&this.emit("message",w),this.emit(c,w)})}requestSsl(){this.stream.write(n.requestSsl())}startup(y){this.stream.write(n.startup(y))}cancel(y,w){this._send(n.cancel(y,w))}password(y){this._send(n.password(y))}sendSASLInitialResponseMessage(y,w){this._send(n.sendSASLInitialResponseMessage(y,w))}sendSCRAMClientFinalMessage(y){this._send(n.sendSCRAMClientFinalMessage(y))}_send(y){return this.stream.writable?this.stream.write(y):!1}query(y){this._send(n.query(y))}parse(y){this._send(n.parse(y))}bind(y){this._send(n.bind(y))}execute(y){this._send(n.execute(y))}flush(){this.stream.writable&&this.stream.write(u)}sync(){this._ending=!0,this._send(u),this._send(s)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(d,()=>{this.stream.end()})}close(y){this._send(n.close(y))}describe(y){this._send(n.describe(y))}sendCopyFromChunk(y){this._send(n.copyData(y))}endCopyFrom(){this._send(n.copyDone())}sendCopyFail(y){this._send(n.copyFail(y))}};l(I,"Connection");var _=I;f.exports=_}),Mr=H((E,f)=>{"use strict";Q();var a=pe().EventEmitter,h=(Pe(),te(_e)),i=xe(),n=gr(),u=vr(),s=It(),d=Ye(),I=Ar(),_=Me(),S=Nt(),y=class extends a{constructor(t){super(),this.connectionParameters=new d(t),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var p=t||{};this._Promise=p.Promise||Le.Promise,this._types=new s(p.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=p.connection||new S({stream:p.stream,ssl:this.connectionParameters.ssl,keepAlive:p.keepAlive||!1,keepAliveInitialDelayMillis:p.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=p.binary||_.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=p.connectionTimeoutMillis||0}_errorAllQueries(t){let p=l(g=>{G.nextTick(()=>{g.handleError(t,this.connection)})},"enqueueError");this.activeQuery&&(p(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(p),this.queryQueue.length=0}_connect(t){var p=this,g=this.connection;if(this._connectionCallback=t,this._connecting||this._connected){let m=new Error("Client has already been connected. You cannot reuse a client.");G.nextTick(()=>{t(m)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{g._ending=!0,g.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?g.connect(this.host+"/.s.PGSQL."+this.port):g.connect(this.port,this.host),g.on("connect",function(){p.ssl?g.requestSsl():g.startup(p.getStartupConf())}),g.on("sslconnect",function(){g.startup(p.getStartupConf())}),this._attachListeners(g),g.once("end",()=>{let m=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(m),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(m):this._handleErrorEvent(m):this._connectionError||this._handleErrorEvent(m)),G.nextTick(()=>{this.emit("end")})})}connect(t){if(t){this._connect(t);return}return new this._Promise((p,g)=>{this._connect(m=>{m?g(m):p()})})}_attachListeners(t){t.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),t.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),t.on("authenticationSASL",this._handleAuthSASL.bind(this)),t.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),t.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),t.on("backendKeyData",this._handleBackendKeyData.bind(this)),t.on("error",this._handleErrorEvent.bind(this)),t.on("errorMessage",this._handleErrorMessage.bind(this)),t.on("readyForQuery",this._handleReadyForQuery.bind(this)),t.on("notice",this._handleNotice.bind(this)),t.on("rowDescription",this._handleRowDescription.bind(this)),t.on("dataRow",this._handleDataRow.bind(this)),t.on("portalSuspended",this._handlePortalSuspended.bind(this)),t.on("emptyQuery",this._handleEmptyQuery.bind(this)),t.on("commandComplete",this._handleCommandComplete.bind(this)),t.on("parseComplete",this._handleParseComplete.bind(this)),t.on("copyInResponse",this._handleCopyInResponse.bind(this)),t.on("copyData",this._handleCopyData.bind(this)),t.on("notification",this._handleNotification.bind(this))}_checkPgPass(t){let p=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(g=>{if(g!==void 0){if(typeof g!="string"){p.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=g}else this.connectionParameters.password=this.password=null;t()}).catch(g=>{p.emit("error",g)}):this.password!==null?t():u(this.connectionParameters,g=>{g!==void 0&&(this.connectionParameters.password=this.password=g),t()})}_handleAuthCleartextPassword(t){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(t){this._checkPgPass(()=>{let p=i.postgresMd5PasswordHash(this.user,this.password,t.salt);this.connection.password(p)})}_handleAuthSASL(t){this._checkPgPass(()=>{this.saslSession=n.startSession(t.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(t){n.continueSession(this.saslSession,this.password,t.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(t){n.finalizeSession(this.saslSession,t.data),this.saslSession=null}_handleBackendKeyData(t){this.processID=t.processID,this.secretKey=t.secretKey}_handleReadyForQuery(t){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:p}=this;this.activeQuery=null,this.readyForQuery=!0,p&&p.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(t){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(t);this.emit("error",t)}}_handleErrorEvent(t){if(this._connecting)return this._handleErrorWhileConnecting(t);this._queryable=!1,this._errorAllQueries(t),this.emit("error",t)}_handleErrorMessage(t){if(this._connecting)return this._handleErrorWhileConnecting(t);let p=this.activeQuery;if(!p){this._handleErrorEvent(t);return}this.activeQuery=null,p.handleError(t,this.connection)}_handleRowDescription(t){this.activeQuery.handleRowDescription(t)}_handleDataRow(t){this.activeQuery.handleDataRow(t)}_handlePortalSuspended(t){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(t){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(t){this.activeQuery.handleCommandComplete(t,this.connection)}_handleParseComplete(t){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(t){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(t){this.activeQuery.handleCopyData(t,this.connection)}_handleNotification(t){this.emit("notification",t)}_handleNotice(t){this.emit("notice",t)}getStartupConf(){var t=this.connectionParameters,p={user:t.user,database:t.database},g=t.application_name||t.fallback_application_name;return g&&(p.application_name=g),t.replication&&(p.replication=""+t.replication),t.statement_timeout&&(p.statement_timeout=String(parseInt(t.statement_timeout,10))),t.lock_timeout&&(p.lock_timeout=String(parseInt(t.lock_timeout,10))),t.idle_in_transaction_session_timeout&&(p.idle_in_transaction_session_timeout=String(parseInt(t.idle_in_transaction_session_timeout,10))),t.options&&(p.options=t.options),p}cancel(t,p){if(t.activeQuery===p){var g=this.connection;this.host&&this.host.indexOf("/")===0?g.connect(this.host+"/.s.PGSQL."+this.port):g.connect(this.port,this.host),g.on("connect",function(){g.cancel(t.processID,t.secretKey)})}else t.queryQueue.indexOf(p)!==-1&&t.queryQueue.splice(t.queryQueue.indexOf(p),1)}setTypeParser(t,p,g){return this._types.setTypeParser(t,p,g)}getTypeParser(t,p){return this._types.getTypeParser(t,p)}escapeIdentifier(t){return'"'+t.replace(/"/g,'""')+'"'}escapeLiteral(t){for(var p=!1,g="'",m=0;m<t.length;m++){var b=t[m];b==="'"?g+=b+b:b==="\\"?(g+=b+b,p=!0):g+=b}return g+="'",p===!0&&(g=" E"+g),g}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let t=this.activeQuery.submit(this.connection);t&&G.nextTick(()=>{this.activeQuery.handleError(t,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(t,p,g){var m,b,T,x,v;if(t==null)throw new TypeError("Client was passed a null or undefined query");return typeof t.submit=="function"?(T=t.query_timeout||this.connectionParameters.query_timeout,b=m=t,typeof p=="function"&&(m.callback=m.callback||p)):(T=this.connectionParameters.query_timeout,m=new I(t,p,g),m.callback||(b=new this._Promise((L,P)=>{m.callback=(C,k)=>C?P(C):L(k)}))),T&&(v=m.callback,x=setTimeout(()=>{var L=new Error("Query read timeout");G.nextTick(()=>{m.handleError(L,this.connection)}),v(L),m.callback=()=>{};var P=this.queryQueue.indexOf(m);P>-1&&this.queryQueue.splice(P,1),this._pulseQueryQueue()},T),m.callback=(L,P)=>{clearTimeout(x),v(L,P)}),this.binary&&!m.binary&&(m.binary=!0),m._result&&!m._result._types&&(m._result._types=this._types),this._queryable?this._ending?(G.nextTick(()=>{m.handleError(new Error("Client was closed and is not queryable"),this.connection)}),b):(this.queryQueue.push(m),this._pulseQueryQueue(),b):(G.nextTick(()=>{m.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),b)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(t){if(this._ending=!0,!this.connection._connecting)if(t)t();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),t)this.connection.once("end",t);else return new this._Promise(p=>{this.connection.once("end",p)})}};l(y,"Client");var w=y;w.Query=I,f.exports=w}),xr=H((E,f)=>{"use strict";Q();var a=pe().EventEmitter,h=l(function(){},"NOOP"),i=l((c,t)=>{let p=c.findIndex(t);return p===-1?void 0:c.splice(p,1)[0]},"removeWhere"),n=class{constructor(t,p,g){this.client=t,this.idleListener=p,this.timeoutId=g}};l(n,"IdleItem");var u=n,s=class{constructor(t){this.callback=t}};l(s,"PendingItem");var d=s;function I(){throw new Error("Release called on client which has already been released to the pool.")}l(I,"throwOnDoubleRelease");function _(c,t){if(t)return{callback:t,result:void 0};let p,g,m=l(function(T,x){T?p(T):g(x)},"cb"),b=new c(function(T,x){g=T,p=x}).catch(T=>{throw Error.captureStackTrace(T),T});return{callback:m,result:b}}l(_,"promisify");function S(c,t){return l(function p(g){g.client=t,t.removeListener("error",p),t.on("error",()=>{c.log("additional client error after disconnection due to error",g)}),c._remove(t),c.emit("error",g,t)},"idleListener")}l(S,"makeIdleListener");var y=class extends a{constructor(t,p){super(),this.options=Object.assign({},t),t!=null&&"password"in t&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:t.password}),t!=null&&t.ssl&&t.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||p||Je().Client,this.Promise=this.options.Promise||Le.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(p=>{this._remove(p.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let t=this._pendingQueue.shift();if(this._idle.length){let p=this._idle.pop();clearTimeout(p.timeoutId);let g=p.client;g.ref&&g.ref();let m=p.idleListener;return this._acquireClient(g,t,m,!1)}if(!this._isFull())return this.newClient(t);throw new Error("unexpected condition")}_remove(t){let p=i(this._idle,g=>g.client===t);p!==void 0&&clearTimeout(p.timeoutId),this._clients=this._clients.filter(g=>g!==t),t.end(),this.emit("remove",t)}connect(t){if(this.ending){let m=new Error("Cannot use a pool after calling end on the pool");return t?t(m):this.Promise.reject(m)}let p=_(this.Promise,t),g=p.result;if(this._isFull()||this._idle.length){if(this._idle.length&&G.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new d(p.callback)),g;let m=l((x,v,L)=>{clearTimeout(T),p.callback(x,v,L)},"queueCallback"),b=new d(m),T=setTimeout(()=>{i(this._pendingQueue,x=>x.callback===m),b.timedOut=!0,p.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(b),g}return this.newClient(new d(p.callback)),g}newClient(t){let p=new this.Client(this.options);this._clients.push(p);let g=S(this,p);this.log("checking client timeout");let m,b=!1;this.options.connectionTimeoutMillis&&(m=setTimeout(()=>{this.log("ending client due to timeout"),b=!0,p.connection?p.connection.stream.destroy():p.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),p.connect(T=>{if(m&&clearTimeout(m),p.on("error",g),T)this.log("client failed to connect",T),this._clients=this._clients.filter(x=>x!==p),b&&(T.message="Connection terminated due to connection timeout"),this._pulseQueue(),t.timedOut||t.callback(T,void 0,h);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let x=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(p),this._idle.findIndex(v=>v.client===p)!==-1&&this._acquireClient(p,new d((v,L,P)=>P()),g,!1)},this.options.maxLifetimeSeconds*1e3);x.unref(),p.once("end",()=>clearTimeout(x))}return this._acquireClient(p,t,g,!0)}})}_acquireClient(t,p,g,m){m&&this.emit("connect",t),this.emit("acquire",t),t.release=this._releaseOnce(t,g),t.removeListener("error",g),p.timedOut?m&&this.options.verify?this.options.verify(t,t.release):t.release():m&&this.options.verify?this.options.verify(t,b=>{if(b)return t.release(b),p.callback(b,void 0,h);p.callback(void 0,t,t.release)}):p.callback(void 0,t,t.release)}_releaseOnce(t,p){let g=!1;return m=>{g&&I(),g=!0,this._release(t,p,m)}}_release(t,p,g){if(t.on("error",p),t._poolUseCount=(t._poolUseCount||0)+1,this.emit("release",g,t),g||this.ending||!t._queryable||t._ending||t._poolUseCount>=this.options.maxUses){t._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(t),this._pulseQueue();return}if(this._expired.has(t)){this.log("remove expired client"),this._expired.delete(t),this._remove(t),this._pulseQueue();return}let m;this.options.idleTimeoutMillis&&(m=setTimeout(()=>{this.log("remove idle client"),this._remove(t)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&m.unref()),this.options.allowExitOnIdle&&t.unref(),this._idle.push(new u(t,p,m)),this._pulseQueue()}query(t,p,g){if(typeof t=="function"){let b=_(this.Promise,t);return $e(function(){return b.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),b.result}typeof p=="function"&&(g=p,p=void 0);let m=_(this.Promise,g);return g=m.callback,this.connect((b,T)=>{if(b)return g(b);let x=!1,v=l(L=>{x||(x=!0,T.release(L),g(L))},"onError");T.once("error",v),this.log("dispatching query");try{T.query(t,p,(L,P)=>{if(this.log("query dispatched"),T.removeListener("error",v),!x)return x=!0,T.release(L),L?g(L):g(void 0,P)})}catch(L){return T.release(L),g(L)}}),m.result}end(t){if(this.log("ending"),this.ending){let g=new Error("Called end on pool more than once");return t?t(g):this.Promise.reject(g)}this.ending=!0;let p=_(this.Promise,t);return this._endCallback=p.callback,this._pulseQueue(),p.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((t,p)=>t+(this._expired.has(p)?1:0),0)}get totalCount(){return this._clients.length}};l(y,"Pool");var w=y;f.exports=w}),Ft={};ue(Ft,{default:()=>Qt});var Qt,Br=ie(()=>{"use strict";Q(),Qt={}}),kr=H((E,f)=>{f.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),Or=H((E,f)=>{"use strict";Q();var a=pe().EventEmitter,h=(Pe(),te(_e)),i=xe(),n=f.exports=function(s,d,I){a.call(this),s=i.normalizeQueryConfig(s,d,I),this.text=s.text,this.values=s.values,this.name=s.name,this.callback=s.callback,this.state="new",this._arrayMode=s.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(_){_==="row"&&(this._emitRowEvents=!0)}.bind(this))};h.inherits(n,a);var u={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};n.prototype.handleError=function(s){var d=this.native.pq.resultErrorFields();if(d)for(var I in d){var _=u[I]||I;s[_]=d[I]}this.callback?this.callback(s):this.emit("error",s),this.state="error"},n.prototype.then=function(s,d){return this._getPromise().then(s,d)},n.prototype.catch=function(s){return this._getPromise().catch(s)},n.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(s,d){this._once("end",s),this._once("error",d)}.bind(this)),this._promise)},n.prototype.submit=function(s){this.state="running";var d=this;this.native=s.native,s.native.arrayMode=this._arrayMode;var I=l(function(y,w,c){if(s.native.arrayMode=!1,$e(function(){d.emit("_done")}),y)return d.handleError(y);d._emitRowEvents&&(c.length>1?w.forEach((t,p)=>{t.forEach(g=>{d.emit("row",g,c[p])})}):w.forEach(function(t){d.emit("row",t,c)})),d.state="end",d.emit("end",c),d.callback&&d.callback(null,c)},"after");if(G.domain&&(I=G.domain.bind(I)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var _=(this.values||[]).map(i.prepareValue);if(s.namedQueries[this.name]){if(this.text&&s.namedQueries[this.name]!==this.text){let y=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return I(y)}return s.native.execute(this.name,_,I)}return s.native.prepare(this.name,this.text,_.length,function(y){return y?I(y):(s.namedQueries[d.name]=d.text,d.native.execute(d.name,_,I))})}else if(this.values){if(!Array.isArray(this.values)){let y=new Error("Query values must be an array");return I(y)}var S=this.values.map(i.prepareValue);s.native.query(this.text,S,I)}else s.native.query(this.text,I)}}),Dr=H((E,f)=>{"use strict";Q();var a=(Br(),te(Ft)),h=It(),i=kr(),n=pe().EventEmitter,u=(Pe(),te(_e)),s=Ye(),d=Or(),I=f.exports=function(_){n.call(this),_=_||{},this._Promise=_.Promise||Le.Promise,this._types=new h(_.types),this.native=new a({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var S=this.connectionParameters=new s(_);this.user=S.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:S.password}),this.database=S.database,this.host=S.host,this.port=S.port,this.namedQueries={}};I.Query=d,u.inherits(I,n),I.prototype._errorAllQueries=function(_){let S=l(y=>{G.nextTick(()=>{y.native=this.native,y.handleError(_)})},"enqueueError");this._hasActiveQuery()&&(S(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(S),this._queryQueue.length=0},I.prototype._connect=function(_){var S=this;if(this._connecting){G.nextTick(()=>_(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(y,w){if(y)return _(y);S.native.connect(w,function(c){if(c)return S.native.end(),_(c);S._connected=!0,S.native.on("error",function(t){S._queryable=!1,S._errorAllQueries(t),S.emit("error",t)}),S.native.on("notification",function(t){S.emit("notification",{channel:t.relname,payload:t.extra})}),S.emit("connect"),S._pulseQueryQueue(!0),_()})})},I.prototype.connect=function(_){if(_){this._connect(_);return}return new this._Promise((S,y)=>{this._connect(w=>{w?y(w):S()})})},I.prototype.query=function(_,S,y){var w,c,t,p,g;if(_==null)throw new TypeError("Client was passed a null or undefined query");if(typeof _.submit=="function")t=_.query_timeout||this.connectionParameters.query_timeout,c=w=_,typeof S=="function"&&(_.callback=S);else if(t=this.connectionParameters.query_timeout,w=new d(_,S,y),!w.callback){let m,b;c=new this._Promise((T,x)=>{m=T,b=x}),w.callback=(T,x)=>T?b(T):m(x)}return t&&(g=w.callback,p=setTimeout(()=>{var m=new Error("Query read timeout");G.nextTick(()=>{w.handleError(m,this.connection)}),g(m),w.callback=()=>{};var b=this._queryQueue.indexOf(w);b>-1&&this._queryQueue.splice(b,1),this._pulseQueryQueue()},t),w.callback=(m,b)=>{clearTimeout(p),g(m,b)}),this._queryable?this._ending?(w.native=this.native,G.nextTick(()=>{w.handleError(new Error("Client was closed and is not queryable"))}),c):(this._queryQueue.push(w),this._pulseQueryQueue(),c):(w.native=this.native,G.nextTick(()=>{w.handleError(new Error("Client has encountered a connection error and is not queryable"))}),c)},I.prototype.end=function(_){var S=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,_));var y;return _||(y=new this._Promise(function(w,c){_=l(t=>t?c(t):w(),"cb")})),this.native.end(function(){S._errorAllQueries(new Error("Connection terminated")),G.nextTick(()=>{S.emit("end"),_&&_()})}),y},I.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},I.prototype._pulseQueryQueue=function(_){if(this._connected&&!this._hasActiveQuery()){var S=this._queryQueue.shift();if(!S){_||this.emit("drain");return}this._activeQuery=S,S.submit(this);var y=this;S.once("_done",function(){y._pulseQueryQueue()})}},I.prototype.cancel=function(_){this._activeQuery===_?this.native.cancel(function(){}):this._queryQueue.indexOf(_)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(_),1)},I.prototype.ref=function(){},I.prototype.unref=function(){},I.prototype.setTypeParser=function(_,S,y){return this._types.setTypeParser(_,S,y)},I.prototype.getTypeParser=function(_,S){return this._types.getTypeParser(_,S)}}),ot=H((E,f)=>{"use strict";Q(),f.exports=Dr()}),Je=H((E,f)=>{"use strict";Q();var a=Mr(),h=Me(),i=Nt(),n=xr(),{DatabaseError:u}=Ot(),s=l(I=>{var _;return _=class extends n{constructor(S){super(S,I)}},l(_,"BoundPool"),_},"poolFactory"),d=l(function(I){this.defaults=h,this.Client=I,this.Query=this.Client.Query,this.Pool=s(this.Client),this._pools=[],this.Connection=i,this.types=Te(),this.DatabaseError=u},"PG");typeof G.env.NODE_PG_FORCE_NATIVE<"u"?f.exports=new d(ot()):(f.exports=new d(a),Object.defineProperty(f.exports,"native",{configurable:!0,enumerable:!1,get(){var I=null;try{I=new d(ot())}catch(_){if(_.code!=="MODULE_NOT_FOUND")throw _}return Object.defineProperty(f.exports,"native",{value:I}),I}}))});Q();var qt=Ee(Je());Ze();Q();Pt();Ze();var Ur=Ee(xe()),jt=class extends Error{constructor(){super(...arguments),z(this,"name","NeonDbError"),z(this,"code",null),z(this,"sourceError")}};l(jt,"NeonDbError");var Re=jt,at="transaction() expects an array of queries, or a function returning an array of queries";function Wt(E,{arrayMode:f,fullResults:a,fetchOptions:h,isolationLevel:i,readOnly:n,deferrable:u,queryCallback:s,resultCallback:d}={}){if(!E)throw new Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");let I;try{I=Ke(E)}catch{throw new Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(E))}let{protocol:_,username:S,password:y,hostname:w,port:c,pathname:t}=I;if(_!=="postgres:"&&_!=="postgresql:"||!S||!y||!w||!t)throw new Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function p(m,...b){let T,x;if(typeof m=="string")T=m,x=b[1],b=b[0]??[];else{T="";for(let L=0;L<m.length;L++)T+=m[L],L<b.length&&(T+="$"+(L+1))}b=b.map(L=>(0,Ur.prepareValue)(L));let v={query:T,params:b};return s&&s(v),$t(g,v,x)}l(p,"resolve"),p.transaction=async(m,b)=>{if(typeof m=="function"&&(m=m(p)),!Array.isArray(m))throw new Error(at);m.forEach(v=>{if(v[Symbol.toStringTag]!=="NeonQueryPromise")throw new Error(at)});let T=m.map(v=>v.parameterizedQuery),x=m.map(v=>v.opts??{});return g(T,x,b)};async function g(m,b,T){let{fetchEndpoint:x,fetchFunction:v}=Be,L=typeof x=="function"?x(w,c):x,P=Array.isArray(m)?{queries:m}:m,C=h??{},k=f??!1,M=a??!1,N=i,F=n,O=u;T!==void 0&&(T.fetchOptions!==void 0&&(C={...C,...T.fetchOptions}),T.arrayMode!==void 0&&(k=T.arrayMode),T.fullResults!==void 0&&(M=T.fullResults),T.isolationLevel!==void 0&&(N=T.isolationLevel),T.readOnly!==void 0&&(F=T.readOnly),T.deferrable!==void 0&&(O=T.deferrable)),b!==void 0&&!Array.isArray(b)&&b.fetchOptions!==void 0&&(C={...C,...b.fetchOptions});let U={"Neon-Connection-String":E,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"};Array.isArray(m)&&(N!==void 0&&(U["Neon-Batch-Isolation-Level"]=N),F!==void 0&&(U["Neon-Batch-Read-Only"]=String(F)),O!==void 0&&(U["Neon-Batch-Deferrable"]=String(O)));let q;try{q=await(v??fetch)(L,{method:"POST",body:JSON.stringify(P),headers:U,...C})}catch(W){let V=new Re(`Error connecting to database: ${W.message}`);throw V.sourceError=W,V}if(q.ok){let W=await q.json();if(Array.isArray(m)){let V=W.results;if(!Array.isArray(V))throw new Re("Neon internal error: unexpected result format");return V.map((K,oe)=>{let X=b[oe]??{},ne=X.arrayMode??k,be=X.fullResults??M;return We(K,{arrayMode:ne,fullResults:be,parameterizedQuery:m[oe],resultCallback:d})})}else{let V=b??{},K=V.arrayMode??k,oe=V.fullResults??M;return We(W,{arrayMode:K,fullResults:oe,parameterizedQuery:m,resultCallback:d})}}else{let{status:W}=q;if(W===400){let{message:V,code:K}=await q.json(),oe=new Re(V);throw oe.code=K,oe}else{let V=await q.text();throw new Re(`Server error (HTTP status ${W}): ${V}`)}}}return l(g,"execute"),p}l(Wt,"neon");function $t(E,f,a){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:f,opts:a,then:(h,i)=>E(f,a).then(h,i),catch:h=>E(f,a).catch(h),finally:h=>E(f,a).finally(h)}}l($t,"createNeonQueryPromise");function We(E,{arrayMode:f,fullResults:a,parameterizedQuery:h,resultCallback:i}){let n=E.fields.map(d=>d.name),u=E.fields.map(d=>de.types.getTypeParser(d.dataTypeID)),s=f===!0?E.rows.map(d=>d.map((I,_)=>I===null?null:u[_](I))):E.rows.map(d=>Object.fromEntries(d.map((I,_)=>[n[_],I===null?null:u[_](I)])));return i&&i(h,E,s,{arrayMode:f,fullResults:a}),a?(E.viaNeonFetch=!0,E.rowAsArray=f,E.rows=s,E):s}l(We,"processQueryResult");var Nr=Ee(Ye()),de=Ee(Je()),Gt=class extends qt.Client{constructor(f){super(f),this.config=f}get neonConfig(){return this.connection.stream}connect(f){let{neonConfig:a}=this;a.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&a.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let h=this.config?.host!==void 0||this.config?.connectionString!==void 0||G.env.PGHOST!==void 0,i=G.env.USER??G.env.USERNAME;if(!h&&this.host==="localhost"&&this.user===i&&this.database===i&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${i}, db: ${i}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let n=super.connect(f),u=a.pipelineTLS&&this.ssl,s=a.pipelineConnect==="password";if(!u&&!a.pipelineConnect)return n;let d=this.connection;if(u&&d.on("connect",()=>d.stream.emit("data","S")),s){d.removeAllListeners("authenticationCleartextPassword"),d.removeAllListeners("readyForQuery"),d.once("readyForQuery",()=>d.on("readyForQuery",this._handleReadyForQuery.bind(this)));let I=this.ssl?"sslconnect":"connect";d.on(I,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return n}async _handleAuthSASLContinue(f){let a=this.saslSession,h=this.password,i=f.data;if(a.message!=="SASLInitialResponse"||typeof h!="string"||typeof i!="string")throw new Error("SASL: protocol error");let n=Object.fromEntries(i.split(",").map(W=>{if(!/^.=/.test(W))throw new Error("SASL: Invalid attribute pair entry");let V=W[0],K=W.substring(2);return[V,K]})),u=n.r,s=n.s,d=n.i;if(!u||!/^[!-+--~]+$/.test(u))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!s||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!d||!/^[1-9][0-9]*$/.test(d))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!u.startsWith(a.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(u.length===a.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let I=parseInt(d,10),_=$.from(s,"base64"),S=new TextEncoder,y=S.encode(h),w=await se.subtle.importKey("raw",y,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),c=new Uint8Array(await se.subtle.sign("HMAC",w,$.concat([_,$.from([0,0,0,1])]))),t=c;for(var p=0;p<I-1;p++)c=new Uint8Array(await se.subtle.sign("HMAC",w,c)),t=$.from(t.map((W,V)=>t[V]^c[V]));let g=t,m=await se.subtle.importKey("raw",g,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),b=new Uint8Array(await se.subtle.sign("HMAC",m,S.encode("Client Key"))),T=await se.subtle.digest("SHA-256",b),x="n=*,r="+a.clientNonce,v="r="+u+",s="+s+",i="+I,L="c=biws,r="+u,P=x+","+v+","+L,C=await se.subtle.importKey("raw",T,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var k=new Uint8Array(await se.subtle.sign("HMAC",C,S.encode(P))),M=$.from(b.map((W,V)=>b[V]^k[V])),N=M.toString("base64");let F=await se.subtle.importKey("raw",g,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),O=await se.subtle.sign("HMAC",F,S.encode("Server Key")),U=await se.subtle.importKey("raw",O,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var q=$.from(await se.subtle.sign("HMAC",U,S.encode(P)));a.message="SASLResponse",a.serverSignature=q.toString("base64"),a.response=L+",p="+N,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};l(Gt,"NeonClient");var Fr=Gt;function Ht(E,f){if(f)return{callback:f,result:void 0};let a,h,i=l(function(u,s){u?a(u):h(s)},"cb"),n=new E(function(u,s){h=u,a=s});return{callback:i,result:n}}l(Ht,"promisify");var Vt=class extends qt.Pool{constructor(){super(...arguments),z(this,"Client",Fr),z(this,"hasFetchUnsupportedListeners",!1)}on(f,a){return f!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(f,a)}query(f,a,h){if(!Be.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof f=="function")return super.query(f,a,h);typeof a=="function"&&(h=a,a=void 0);let i=Ht(this.Promise,h);h=i.callback;try{let n=new Nr.default(this.options),u=encodeURIComponent,s=encodeURI,d=`postgresql://${u(n.user)}:${u(n.password)}@${u(n.host)}/${s(n.database)}`,I=typeof f=="string"?f:f.text,_=a??f.values??[];Wt(d,{fullResults:!0,arrayMode:f.rowMode==="array"})(I,_).then(S=>h(void 0,S)).catch(S=>h(S))}catch(n){h(n)}return i.result}};l(Vt,"NeonPool");var gn=Vt,mn=de.ClientBase,bn=de.Connection,wn=de.DatabaseError,vn=de.Query,Sn=de.defaults,En=de.types;export{Fr as Client,mn as ClientBase,bn as Connection,wn as DatabaseError,Re as NeonDbError,gn as Pool,vn as Query,Sn as defaults,Wt as neon,Be as neonConfig,En as types};
/*! Bundled license information:

@neondatabase/serverless/index.mjs:
  (*! Bundled license information:
  
  ieee754/index.js:
    (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  
  buffer/index.js:
    (*!
     * The buffer module from node.js, for the browser.
     *
     * @author   Feross Aboukhadijeh <https://feross.org>
     * @license  MIT
     *)
  *)
*/
//# sourceMappingURL=serverless.mjs.map