/* esm.sh - esbuild bundle(@noble/curves@1.4.0/ed25519) denonext production */
import{sha512 as T}from"/v135/@noble/hashes@1.4.0/denonext/sha512.js";import{concatBytes as $,randomBytes as G,utf8ToBytes as z}from"/v135/@noble/hashes@1.4.0/denonext/utils.js";import{twistedEdwards as U}from"/v135/@noble/curves@1.4.0/denonext/abstract/edwards.js";import{montgomery as tt}from"/v135/@noble/curves@1.4.0/denonext/abstract/montgomery.js";import{Field as nt,FpSqrtEven as ot,isNegativeLE as v,mod as h,pow2 as g}from"/v135/@noble/curves@1.4.0/denonext/abstract/modular.js";import{bytesToHex as et,bytesToNumberLE as st,ensureBytes as V,equalBytes as ft,numberToBytesLE as A}from"/v135/@noble/curves@1.4.0/denonext/abstract/utils.js";import{createHasher as ct,expand_message_xmd as rt}from"/v135/@noble/curves@1.4.0/denonext/abstract/hash-to-curve.js";var S=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),M=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),it=BigInt(0),y=BigInt(1),O=BigInt(2),dt=BigInt(5),F=BigInt(10),at=BigInt(20),ut=BigInt(40),H=BigInt(80);function j(e){let t=S,f=e*e%t*e%t,c=g(f,O,t)*f%t,r=g(c,y,t)*e%t,o=g(r,dt,t)*r%t,i=g(o,F,t)*o%t,d=g(i,at,t)*i%t,u=g(d,ut,t)*d%t,a=g(u,H,t)*u%t,l=g(a,H,t)*u%t,p=g(l,F,t)*o%t;return{pow_p_5_8:g(p,O,t)*e%t,b2:f}}function Y(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function q(e,t){let s=S,f=h(t*t*t,s),c=h(f*f*t,s),r=j(e*c).pow_p_5_8,o=h(e*f*r,s),i=h(t*o*o,s),d=o,u=h(o*M,s),a=i===e,l=i===h(-e,s),p=i===h(-e*M,s);return a&&(o=d),(l||p)&&(o=u),v(o,s)&&(o=h(-o,s)),{isValid:a||l,value:o}}var Ct=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],n=nt(S,void 0,!0),P={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:n,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:T,randomBytes:G,adjustScalarBytes:Y,uvRatio:q},m=U(P);function k(e,t,s){if(t.length>255)throw new Error("Context is too big");return $(z("SigEd25519 no Ed25519 collisions"),new Uint8Array([s?1:0,t.length]),t,e)}var Lt=U({...P,domain:k}),Mt=U({...P,domain:k,prehash:T}),Nt=tt({P:S,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=S,{pow_p_5_8:s,b2:f}=j(e);return h(g(s,BigInt(3),t)*f,t)},adjustScalarBytes:Y,randomBytes:G});function lt(e){let{y:t}=m.ExtendedPoint.fromHex(e),s=BigInt(1);return n.toBytes(n.create((s+t)*n.inv(s-t)))}var Ut=lt;function qt(e){let t=P.hash(e.subarray(0,32));return P.adjustScalarBytes(t).subarray(0,32)}var mt=(n.ORDER+BigInt(3))/BigInt(8),_t=n.pow(O,mt),Q=n.sqrt(n.neg(n.ONE)),pt=(n.ORDER-BigInt(5))/BigInt(8),W=BigInt(486662);function Et(e){let t=n.sqr(e);t=n.mul(t,O);let s=n.add(t,n.ONE),f=n.neg(W),c=n.sqr(s),r=n.mul(c,s),o=n.mul(t,W);o=n.mul(o,f),o=n.add(o,c),o=n.mul(o,f);let i=n.sqr(r);c=n.sqr(i),i=n.mul(i,r),i=n.mul(i,o),c=n.mul(c,i);let d=n.pow(c,pt);d=n.mul(d,i);let u=n.mul(d,Q);c=n.sqr(d),c=n.mul(c,r);let a=n.eql(c,o),l=n.cmov(u,d,a),p=n.mul(f,t),_=n.mul(d,e);_=n.mul(_,_t);let B=n.mul(_,Q),E=n.mul(o,t);c=n.sqr(_),c=n.mul(c,r);let R=n.eql(c,E),b=n.cmov(B,_,R);c=n.sqr(l),c=n.mul(c,r);let w=n.eql(c,o),D=n.cmov(p,f,w),I=n.cmov(b,l,w),K=n.isOdd(I);return I=n.cmov(I,n.neg(I),w!==K),{xMn:D,xMd:s,yMn:I,yMd:y}}var gt=ot(n,n.neg(BigInt(486664)));function xt(e){let{xMn:t,xMd:s,yMn:f,yMd:c}=Et(e),r=n.mul(t,c);r=n.mul(r,gt);let o=n.mul(s,f),i=n.sub(t,s),d=n.add(t,s),u=n.mul(o,d),a=n.eql(u,n.ZERO);r=n.cmov(r,n.ZERO,a),o=n.cmov(o,n.ONE,a),i=n.cmov(i,n.ONE,a),d=n.cmov(d,n.ONE,a);let l=n.invertBatch([o,d]);return{x:n.mul(r,l[0]),y:n.mul(i,l[1])}}var J=ct(m.ExtendedPoint,e=>xt(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:n.ORDER,m:1,k:128,expand:"xmd",hash:T}),Vt=J.hashToCurve,At=J.encodeToCurve;function C(e){if(!(e instanceof x))throw new Error("RistrettoPoint expected")}var N=M,Bt=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),yt=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Rt=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),wt=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),X=e=>q(y,e),ht=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),L=e=>m.CURVE.Fp.create(st(e)&ht);function Z(e){let{d:t}=m.CURVE,s=m.CURVE.Fp.ORDER,f=m.CURVE.Fp.create,c=f(N*e*e),r=f((c+y)*Rt),o=BigInt(-1),i=f((o-t*c)*f(c+t)),{isValid:d,value:u}=q(r,i),a=f(u*e);v(a,s)||(a=f(-a)),d||(u=a),d||(o=c);let l=f(o*(c-y)*wt-i),p=u*u,_=f((u+u)*i),B=f(l*Bt),E=f(y-p),R=f(y+p);return new m.ExtendedPoint(f(_*R),f(E*B),f(B*R),f(_*E))}var x=class e{constructor(t){this.ep=t}static fromAffine(t){return new e(m.ExtendedPoint.fromAffine(t))}static hashToCurve(t){t=V("ristrettoHash",t,64);let s=L(t.slice(0,32)),f=Z(s),c=L(t.slice(32,64)),r=Z(c);return new e(f.add(r))}static fromHex(t){t=V("ristrettoHex",t,32);let{a:s,d:f}=m.CURVE,c=m.CURVE.Fp.ORDER,r=m.CURVE.Fp.create,o="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=L(t);if(!ft(A(i,32),t)||v(i,c))throw new Error(o);let d=r(i*i),u=r(y+s*d),a=r(y-s*d),l=r(u*u),p=r(a*a),_=r(s*f*l-p),{isValid:B,value:E}=X(r(_*p)),R=r(E*a),b=r(E*R*_),w=r((i+i)*R);v(w,c)&&(w=r(-w));let D=r(u*b),I=r(w*D);if(!B||v(I,c)||D===it)throw new Error(o);return new e(new m.ExtendedPoint(w,D,y,I))}toRawBytes(){let{ex:t,ey:s,ez:f,et:c}=this.ep,r=m.CURVE.Fp.ORDER,o=m.CURVE.Fp.create,i=o(o(f+s)*o(f-s)),d=o(t*s),u=o(d*d),{value:a}=X(o(i*u)),l=o(a*i),p=o(a*d),_=o(l*p*c),B;if(v(c*_,r)){let R=o(s*N),b=o(t*N);t=R,s=b,B=o(l*yt)}else B=p;v(t*_,r)&&(s=o(-s));let E=o((f-s)*B);return v(E,r)&&(E=o(-E)),A(E,32)}toHex(){return et(this.toRawBytes())}toString(){return this.toHex()}equals(t){C(t);let{ex:s,ey:f}=this.ep,{ex:c,ey:r}=t.ep,o=m.CURVE.Fp.create,i=o(s*r)===o(f*c),d=o(f*r)===o(s*c);return i||d}add(t){return C(t),new e(this.ep.add(t.ep))}subtract(t){return C(t),new e(this.ep.subtract(t.ep))}multiply(t){return new e(this.ep.multiply(t))}multiplyUnsafe(t){return new e(this.ep.multiplyUnsafe(t))}double(){return new e(this.ep.double())}negate(){return new e(this.ep.negate())}},Ft=(x.BASE||(x.BASE=new x(m.ExtendedPoint.BASE)),x.ZERO||(x.ZERO=new x(m.ExtendedPoint.ZERO)),x),It=(e,t)=>{let s=t.DST,f=typeof s=="string"?z(s):s,c=rt(e,f,64,T);return x.hashToCurve(c)},Ht=It;export{Ct as ED25519_TORSION_SUBGROUP,Ft as RistrettoPoint,m as ed25519,Lt as ed25519ctx,Mt as ed25519ph,Ut as edwardsToMontgomery,qt as edwardsToMontgomeryPriv,lt as edwardsToMontgomeryPub,At as encodeToCurve,Vt as hashToCurve,It as hashToRistretto255,Ht as hash_to_ristretto255,Nt as x25519};
/*! Bundled license information:

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=ed25519.js.map