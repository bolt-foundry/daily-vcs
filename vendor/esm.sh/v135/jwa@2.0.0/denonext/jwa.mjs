/* esm.sh - esbuild bundle(jwa@2.0.0) denonext production */
import * as __0$ from "/v135/buffer-equal-constant-time@1.0.1/denonext/buffer-equal-constant-time.mjs";
import * as __1$ from "/v135/safe-buffer@5.2.1/denonext/safe-buffer.mjs";
import * as __2$ from "node:crypto";
import * as __3$ from "/v135/ecdsa-sig-formatter@1.0.11/denonext/ecdsa-sig-formatter.mjs";
import * as __4$ from "node:util";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"buffer-equal-constant-time":return e(__0$);case"safe-buffer":return e(__1$);case"crypto":return e(__2$);case"ecdsa-sig-formatter":return e(__3$);case"util":return e(__4$);default:throw new Error("module \""+n+"\" not found");}};
var N=Object.create;var d=Object.defineProperty;var V=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var p=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var B=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),q=(r,t)=>{for(var e in t)d(r,e,{get:t[e],enumerable:!0})},_=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of G(t))!j.call(r,n)&&n!==e&&d(r,n,{get:()=>t[n],enumerable:!(i=V(t,n))||i.enumerable});return r},c=(r,t,e)=>(_(r,t,"default"),e&&_(e,t,"default")),E=(r,t,e)=>(e=r!=null?N(T(r)):{},_(t||!r||!r.__esModule?d(e,"default",{value:r,enumerable:!0}):e,r));var A=B((er,K)=>{var C=p("buffer-equal-constant-time"),S=p("safe-buffer").Buffer,a=p("crypto"),P=p("ecdsa-sig-formatter"),I=p("util"),M=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,v="secret must be a string or buffer",s="key must be a string or a buffer",O="key must be a string, a buffer or an object",m=typeof a.createPublicKey=="function";m&&(s+=" or a KeyObject",v+="or a KeyObject");function R(r){if(!S.isBuffer(r)&&typeof r!="string"&&(!m||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw o(s)}function b(r){if(!S.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw o(O)}function x(r){if(!S.isBuffer(r)){if(typeof r=="string")return r;if(!m||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw o(v)}}function l(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function w(r){r=r.toString();var t=4-r.length%4;if(t!==4)for(var e=0;e<t;++e)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function o(r){var t=[].slice.call(arguments,1),e=I.format.bind(I,r).apply(null,t);return new TypeError(e)}function F(r){return S.isBuffer(r)||typeof r=="string"}function g(r){return F(r)||(r=JSON.stringify(r)),r}function D(r){return function(e,i){x(i),e=g(e);var n=a.createHmac("sha"+r,i),f=(n.update(e),n.digest("base64"));return l(f)}}function J(r){return function(e,i,n){var f=D(r)(e,n);return C(S.from(i),S.from(f))}}function h(r){return function(e,i){b(i),e=g(e);var n=a.createSign("RSA-SHA"+r),f=(n.update(e),n.sign(i,"base64"));return l(f)}}function H(r){return function(e,i,n){R(n),e=g(e),i=w(i);var f=a.createVerify("RSA-SHA"+r);return f.update(e),f.verify(n,i,"base64")}}function Y(r){return function(e,i){b(i),e=g(e);var n=a.createSign("RSA-SHA"+r),f=(n.update(e),n.sign({key:i,padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return l(f)}}function $(r){return function(e,i,n){R(n),e=g(e),i=w(i);var f=a.createVerify("RSA-SHA"+r);return f.update(e),f.verify({key:n,padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},i,"base64")}}function z(r){var t=h(r);return function(){var i=t.apply(null,arguments);return i=P.derToJose(i,"ES"+r),i}}function Q(r){var t=H(r);return function(i,n,f){n=P.joseToDer(n,"ES"+r).toString("base64");var y=t(i,n,f);return y}}function U(){return function(){return""}}function W(){return function(t,e){return e===""}}K.exports=function(t){var e={hs:D,rs:h,ps:Y,es:z,none:U},i={hs:J,rs:H,ps:$,es:Q,none:W},n=t.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!n)throw o(M,t);var f=(n[1]||n[3]).toLowerCase(),y=n[2];return{sign:e[f](y),verify:i[f](y)}}});var u={};q(u,{default:()=>k});var X=E(A());c(u,E(A()));var{default:L,...Z}=X,k=L!==void 0?L:Z;export{k as default};
//# sourceMappingURL=jwa.mjs.map