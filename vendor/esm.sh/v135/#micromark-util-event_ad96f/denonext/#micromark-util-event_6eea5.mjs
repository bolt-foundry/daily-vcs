/* esm.sh - esbuild bundle(micromark-util-events-to-acorn@2.0.2) denonext production */
import{visit as P}from"/v135/estree-util-visit@2.0.0/denonext/estree-util-visit.mjs";import{VFileMessage as S}from"/v135/vfile-message@4.0.2/denonext/vfile-message.mjs";function B(c,s){let n=s.prefix||"",f=s.suffix||"",o=Object.assign({},s.acornOptions),r=[],u=[],p=o.onComment,h=o.onToken,w=!1,i,y,v=Object.assign({},o,{onComment:r,preserveParens:!0});h&&(v.onToken=u);let E=U(c,s.tokenTypes),a=E.value,g=n+a+f,b=s.expression&&C(a);if(b&&!s.allowEmpty)throw new S("Unexpected empty expression",{place:m(0),ruleId:"unexpected-empty-expression",source:"micromark-extension-mdx-expression"});try{i=s.expression&&!b?s.acorn.parseExpressionAt(g,0,v):s.acorn.parse(g,v)}catch(e){let t=e,l=m(t.pos);t.message=String(t.message).replace(/ \(\d+:\d+\)$/,""),t.pos=l.offset,t.loc={line:l.line,column:l.column-1},y=t,w=t.raisedAt>=n.length+a.length||t.message==="Unterminated comment"}if(i&&s.expression&&!b)if(C(g.slice(i.end,g.length-f.length)))i={type:"Program",start:0,end:n.length+a.length,body:[{type:"ExpressionStatement",expression:i,start:0,end:n.length+a.length}],sourceType:"module",comments:[]};else{let e=m(i.end),t=new Error("Unexpected content after expression");t.pos=e.offset,t.loc={line:e.line,column:e.column-1},y=t,i=void 0}if(i){if(i.comments=r,P(i,function(e,t,l,A){let x=A[A.length-1],d=t;e.type==="ParenthesizedExpression"&&x&&d&&(typeof l=="number"&&(x=x[d],d=l),x[d]=e.expression),k(e)}),Array.isArray(p))p.push(...r);else if(typeof p=="function")for(let e of r)p(e.type==="Block",e.value,e.start,e.end,e.loc.start,e.loc.end);for(let e of u)e.end<=n.length||e.start-n.length>=a.length||(k(e),Array.isArray(h)?h.push(e):h(e))}return{estree:i,error:y,swallow:w};function k(e){let t=m(e.start),l=m(e.end);e.start=t.offset,e.end=l.offset,e.loc={start:{line:t.line,column:t.column-1,offset:t.offset},end:{line:l.line,column:l.column-1,offset:l.offset}},e.range=[e.start,e.end]}function m(e){let t=e-n.length;t<0?t=0:t>a.length&&(t=a.length);let l=j(E.stops,t);return l||(l={line:s.start.line,column:s.start.column,offset:s.start.offset}),l}}function C(c){return/^\s*$/.test(c.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/[^\r\n]*(\r\n|\n|\r)/g,""))}function U(c,s){let n={value:"",stops:[]},f=-1;for(;++f<c.length;){let o=c[f];if(o[0]==="enter"){let r=o[1].type;if(r==="lineEnding"||s.includes(r)){let u=o[2].sliceStream(o[1]);for(;u.length>0&&u[0]===-1;)u.shift();let p=z(u);n.stops.push([n.value.length,o[1].start]),n.value+=p,n.stops.push([n.value.length,o[1].end])}}}return n}function j(c,s){let n=0;for(;n<c.length&&c[n][0]<=s;)n+=1;if(n===0)return;let[f,o]=c[n-1],r=s-f;return{line:o.line,column:o.column+r,offset:o.offset+r}}function z(c){let s=-1,n=[],f;for(;++s<c.length;){let o=c[s],r;if(typeof o=="string")r=o;else switch(o){case-5:{r="\r";break}case-4:{r=`
`;break}case-3:{r=`\r
`;break}case-2:{r="	";break}case-1:{if(f)continue;r=" ";break}default:r=String.fromCharCode(o)}f=o===-2,n.push(r)}return n.join("")}export{B as eventsToAcorn};
//# sourceMappingURL=micromark-util-events-to-acorn.mjs.map