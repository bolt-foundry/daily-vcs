/* esm.sh - esbuild bundle(@tensorflow/tfjs-core@4.20.0/dist/ops/conv_util) denonext production */
import*as m from"/v135/@tensorflow/tfjs-core@4.20.0/denonext/dist/util.js";function K(t,n,e,s,l="NHWC",i){let r=t[3],o=[...n,r],c=J(l);return V(t,o,e,i,s,null,null,c)}function Q(t,n,e,s,l,i,r="channelsLast"){let[o,c]=k(n),f;if(r==="channelsLast")f=[o,c,t[3],t[3]];else if(r==="channelsFirst")f=[o,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${r}`);return V(t,f,e,s,l,i,!1,r)}function Y(t,n,e,s,l,i,r="NDHWC"){let[o,c,f]=N(n),h,u;if(r==="NDHWC")u="channelsLast",h=[o,c,f,t[4],t[4]];else if(r==="NCDHW")u="channelsFirst",h=[o,c,f,t[1],t[1]];else throw new Error(`Unknown dataFormat ${r}`);return j(t,h,e,s,l,!1,u,i)}function V(t,n,e,s,l,i,r=!1,o="channelsLast"){let[c,f,h,u]=[-1,-1,-1,-1];if(o==="channelsLast")[c,f,h,u]=t;else if(o==="channelsFirst")[c,u,f,h]=t;else throw new Error(`Unknown dataFormat ${o}`);let[w,g,,p]=n,[D,b]=k(e),[E,y]=k(s),I=x(w,E),C=x(g,y),{padInfo:L,outHeight:$,outWidth:M}=q(l,f,h,D,b,I,C,i,o),a=r?p*u:p,A;return o==="channelsFirst"?A=[c,a,$,M]:o==="channelsLast"&&(A=[c,$,M,a]),{batchSize:c,dataFormat:o,inHeight:f,inWidth:h,inChannels:u,outHeight:$,outWidth:M,outChannels:a,padInfo:L,strideHeight:D,strideWidth:b,filterHeight:w,filterWidth:g,effectiveFilterHeight:I,effectiveFilterWidth:C,dilationHeight:E,dilationWidth:y,inShape:t,outShape:A,filterShape:n}}function j(t,n,e,s,l,i=!1,r="channelsLast",o){let[c,f,h,u,w]=[-1,-1,-1,-1,-1];if(r==="channelsLast")[c,f,h,u,w]=t;else if(r==="channelsFirst")[c,w,f,h,u]=t;else throw new Error(`Unknown dataFormat ${r}`);let[g,p,D,,b]=n,[E,y,I]=N(e),[C,L,$]=N(s),M=x(g,C),a=x(p,L),A=x(D,$),{padInfo:B,outDepth:U,outHeight:W,outWidth:O}=G(l,f,h,u,E,y,I,M,a,A,o),T=i?b*w:b,H;return r==="channelsFirst"?H=[c,T,U,W,O]:r==="channelsLast"&&(H=[c,U,W,O,T]),{batchSize:c,dataFormat:r,inDepth:f,inHeight:h,inWidth:u,inChannels:w,outDepth:U,outHeight:W,outWidth:O,outChannels:T,padInfo:B,strideDepth:E,strideHeight:y,strideWidth:I,filterDepth:g,filterHeight:p,filterWidth:D,effectiveFilterDepth:M,effectiveFilterHeight:a,effectiveFilterWidth:A,dilationDepth:C,dilationHeight:L,dilationWidth:$,inShape:t,outShape:H,filterShape:n}}function F(t,n,e,s,l){s==null&&(s=P(t,n,e));let i=t[0],r=t[1],o=v((i-n+2*s)/e+1,l),c=v((r-n+2*s)/e+1,l);return[o,c]}function X(t,n,e,s,l,i){l==null&&(l=P(t,n[0],s[0]));let r=[0,0,0,e];for(let o=0;o<3;o++)t[o]+2*l>=n[o]&&(r[o]=v((t[o]-n[o]+2*l)/s[o]+1,i));return r}function P(t,n,e,s=1){let l=x(n,s);return Math.floor((t[0]*(e-1)-e+l)/2)}function k(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function N(t){return typeof t=="number"?[t,t,t]:t}function x(t,n){return n<=1?t:t+(t-1)*(n-1)}function q(t,n,e,s,l,i,r,o,c){let f,h,u;if(typeof t=="number"){f={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};let g=F([n,e],i,s,t,o);h=g[0],u=g[1]}else if(t==="same"){h=Math.ceil(n/s),u=Math.ceil(e/l);let w=Math.max(0,(h-1)*s+i-n),g=Math.max(0,(u-1)*l+r-e),p=Math.floor(w/2),D=w-p,b=Math.floor(g/2),E=g-b;f={top:p,bottom:D,left:b,right:E,type:"SAME"}}else if(t==="valid")f={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((n-i+1)/s),u=Math.ceil((e-r+1)/l);else if(typeof t=="object"){let w=c==="channelsLast"?t[1][0]:t[2][0],g=c==="channelsLast"?t[1][1]:t[2][1],p=c==="channelsLast"?t[2][0]:t[3][0],D=c==="channelsLast"?t[2][1]:t[3][1];f={top:w,bottom:g,left:p,right:D,type:w===0&&g===0&&p===0&&D===0?"VALID":"EXPLICIT"},h=v((n-i+w+g)/s+1,o),u=v((e-r+p+D)/l+1,o)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:f,outHeight:h,outWidth:u}}function G(t,n,e,s,l,i,r,o,c,f,h){let u,w,g,p;if(t==="valid"&&(t=0),typeof t=="number"){u={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};let b=X([n,e,s,1],[o,c,f],1,[l,i,r],t,h);w=b[0],g=b[1],p=b[2]}else if(t==="same"){w=Math.ceil(n/l),g=Math.ceil(e/i),p=Math.ceil(s/r);let D=(w-1)*l+o-n,b=(g-1)*i+c-e,E=(p-1)*r+f-s,y=Math.floor(D/2),I=D-y,C=Math.floor(b/2),L=b-C,$=Math.floor(E/2),M=E-$;u={top:C,bottom:L,left:$,right:M,front:y,back:I,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outDepth:w,outHeight:g,outWidth:p}}function v(t,n){if(!n)return Math.trunc(t);switch(n){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${n}`)}}function R(t){let[n,e,s]=k(t);return n===1&&e===1&&s===1}function Z(t,n){return R(t)||R(n)}function _(t){return k(t).every(n=>n>0)}function J(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function z(t,n,e){if(e!=null){if(typeof n=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${n}.`);if(typeof n=="number")m.assert(m.isInt(n),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${n}.`);else if(typeof n=="object")n.forEach(s=>{s.forEach(l=>{m.assert(m.isInt(l),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${e} but got pad ${l}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${n}`)}}export{z as checkPadOnDimRoundingMode,V as computeConv2DInfo,j as computeConv3DInfo,P as computeDefaultPad,K as computeDilation2DInfo,Q as computePool2DInfo,Y as computePool3DInfo,J as convertConv2DDataFormat,Z as eitherStridesOrDilationsAreOne,_ as stridesOrDilationsArePositive,R as tupleValuesAreOne};
/*! Bundled license information:

@tensorflow/tfjs-core/dist/ops/conv_util.js:
  (**
   * @license
   * Copyright 2020 Google LLC. All Rights Reserved.
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   * =============================================================================
   *)
*/
//# sourceMappingURL=conv_util.js.map