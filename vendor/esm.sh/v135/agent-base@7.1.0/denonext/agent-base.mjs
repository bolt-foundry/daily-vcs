/* esm.sh - esbuild bundle(agent-base@7.1.0) denonext production */
import { Buffer as __Buffer$ } from "node:buffer";
import * as __0$ from "node:http";
import * as __1$ from "node:http";
import * as __2$ from "node:https";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"http":return e(__0$);case"https":return e(__2$);default:throw new Error("module \""+n+"\" not found");}};
var B=Object.create;var h=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var A=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var d=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var b=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),N=(t,e)=>{for(var r in e)h(t,r,{get:e[r],enumerable:!0})},l=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of E(e))!D.call(t,i)&&i!==r&&h(t,i,{get:()=>e[i],enumerable:!(n=q(e,i))||n.enumerable});return t},f=(t,e,r)=>(l(t,e,"default"),r&&l(r,e,"default")),g=(t,e,r)=>(r=t!=null?B(A(t)):{},l(e||!t||!t.__esModule?h(r,"default",{value:t,enumerable:!0}):r,t));var v=b(o=>{"use strict";var I=o&&o.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),R=o&&o.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),O=o&&o.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&I(e,t,r);return R(e,t),e};Object.defineProperty(o,"__esModule",{value:!0});o.req=o.json=o.toBuffer=void 0;var C=O(d("http")),J=O(d("https"));async function y(t){let e=0,r=[];for await(let n of t)e+=n.length,r.push(n);return __Buffer$.concat(r,e)}o.toBuffer=y;async function L(t){let r=(await y(t)).toString("utf8");try{return JSON.parse(r)}catch(n){let i=n;throw i.message+=` (input: ${r})`,i}}o.json=L;function T(t,e={}){let n=((typeof t=="string"?t:t.href).startsWith("https:")?J:C).request(t,e),i=new Promise((a,M)=>{n.once("response",a).once("error",M).end()});return n.then=i.then.bind(i),n}o.req=T});var p=b(u=>{"use strict";var S=u&&u.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),W=u&&u.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),$=u&&u.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&S(e,t,r);return W(e,t),e},z=u&&u.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&S(e,t,r)};Object.defineProperty(u,"__esModule",{value:!0});u.Agent=void 0;var j=$(d("http"));z(v(),u);var c=Symbol("AgentBaseInternalState"),_=class extends j.Agent{constructor(e){super(e),this[c]={}}isSecureEndpoint(e){if(e){if(typeof e.secureEndpoint=="boolean")return e.secureEndpoint;if(typeof e.protocol=="string")return e.protocol==="https:"}let{stack:r}=new Error;return typeof r!="string"?!1:r.split(`
`).some(n=>n.indexOf("(https.js:")!==-1||n.indexOf("node:https:")!==-1)}createSocket(e,r,n){let i={...r,secureEndpoint:this.isSecureEndpoint(r)};Promise.resolve().then(()=>this.connect(e,i)).then(a=>{if(a instanceof j.Agent)return a.addRequest(e,i);this[c].currentSocket=a,super.createSocket(e,r,n)},n)}createConnection(){let e=this[c].currentSocket;if(this[c].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[c].defaultPort??(this.protocol==="https:"?443:80)}set defaultPort(e){this[c]&&(this[c].defaultPort=e)}get protocol(){return this[c].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[c]&&(this[c].protocol=e)}};u.Agent=_});var s={};N(s,{Agent:()=>G,__esModule:()=>F,default:()=>V,json:()=>K,req:()=>H,toBuffer:()=>Q});var w=g(p());f(s,g(p()));var{__esModule:F,Agent:G,req:H,json:K,toBuffer:Q}=w,{default:P,...U}=w,V=P!==void 0?P:U;export{G as Agent,F as __esModule,V as default,K as json,H as req,Q as toBuffer};
//# sourceMappingURL=agent-base.mjs.map