/* esm.sh - esbuild bundle(unified@11.0.4) denonext production */
import{bail as C}from"/v135/bail@2.0.2/denonext/bail.mjs";import w from"/v135/extend@3.0.2/denonext/extend.mjs";import{ok as m}from"/v135/devlop@1.1.0/denonext/devlop.mjs";import z from"/v135/is-plain-obj@4.1.0/denonext/is-plain-obj.mjs";import{trough as j}from"/v135/trough@2.1.0/denonext/trough.mjs";import{VFile as A}from"/v135/vfile@6.0.1/denonext/vfile.mjs";var I=function(n){let t=this.constructor.prototype,i=t[n],c=function(){return i.apply(c,arguments)};Object.setPrototypeOf(c,t);let a=Object.getOwnPropertyNames(i);for(let p of a){let u=Object.getOwnPropertyDescriptor(i,p);u&&Object.defineProperty(c,p,u)}return c};var S={}.hasOwnProperty,P=class n extends I{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=j()}copy(){let e=new n,r=-1;for(;++r<this.attachers.length;){let t=this.attachers[r];e.use(...t)}return e.data(w(!0,{},this.namespace)),e}data(e,r){return typeof e=="string"?arguments.length===2?(x("data",this.frozen),this.namespace[e]=r,this):S.call(this.namespace,e)&&this.namespace[e]||void 0:e?(x("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;let e=this;for(;++this.freezeIndex<this.attachers.length;){let[r,...t]=this.attachers[this.freezeIndex];if(t[0]===!1)continue;t[0]===!0&&(t[0]=void 0);let i=r.call(e,...t);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();let r=y(e),t=this.parser||this.Parser;return g("parse",t),t(String(r),r)}process(e,r){let t=this;return this.freeze(),g("process",this.parser||this.Parser),b("process",this.compiler||this.Compiler),r?i(void 0,r):new Promise(i);function i(c,a){let p=y(e),u=t.parse(p);t.run(u,p,function(o,f,h){if(o||!f||!h)return s(o);let l=f,d=t.stringify(l,h);N(d)?h.value=d:h.result=d,s(o,h)});function s(o,f){o||!f?a(o):c?c(f):(m(r,"`done` is defined if `resolve` is not"),r(void 0,f))}}}processSync(e){let r=!1,t;return this.freeze(),g("processSync",this.parser||this.Parser),b("processSync",this.compiler||this.Compiler),this.process(e,i),T("processSync","process",r),m(t,"we either bailed on an error or have a tree"),t;function i(c,a){r=!0,C(c),t=a}}run(e,r,t){O(e),this.freeze();let i=this.transformers;return!t&&typeof r=="function"&&(t=r,r=void 0),t?c(void 0,t):new Promise(c);function c(a,p){m(typeof r!="function","`file` can\u2019t be a `done` anymore, we checked");let u=y(r);i.run(e,u,s);function s(o,f,h){let l=f||e;o?p(o):a?a(l):(m(t,"`done` is defined if `resolve` is not"),t(void 0,l,h))}}}runSync(e,r){let t=!1,i;return this.run(e,r,c),T("runSync","run",t),m(i,"we either bailed on an error or have a tree"),i;function c(a,p){C(a),i=p,t=!0}}stringify(e,r){this.freeze();let t=y(r),i=this.compiler||this.Compiler;return b("stringify",i),O(e),i(e,t)}use(e,...r){let t=this.attachers,i=this.namespace;if(x("use",this.frozen),e!=null)if(typeof e=="function")u(e,r);else if(typeof e=="object")Array.isArray(e)?p(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function c(s){if(typeof s=="function")u(s,[]);else if(typeof s=="object")if(Array.isArray(s)){let[o,...f]=s;u(o,f)}else a(s);else throw new TypeError("Expected usable value, not `"+s+"`")}function a(s){if(!("plugins"in s)&&!("settings"in s))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");p(s.plugins),s.settings&&(i.settings=w(!0,i.settings,s.settings))}function p(s){let o=-1;if(s!=null)if(Array.isArray(s))for(;++o<s.length;){let f=s[o];c(f)}else throw new TypeError("Expected a list of plugins, not `"+s+"`")}function u(s,o){let f=-1,h=-1;for(;++f<t.length;)if(t[f][0]===s){h=f;break}if(h===-1)t.push([s,...o]);else if(o.length>0){let[l,...d]=o,E=t[h][1];z(E)&&z(l)&&(l=w(!0,E,l)),t[h]=[s,l,...d]}}}},F=new P().freeze();function g(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `parser`")}function b(n,e){if(typeof e!="function")throw new TypeError("Cannot `"+n+"` without `compiler`")}function x(n,e){if(e)throw new Error("Cannot call `"+n+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function O(n){if(!z(n)||typeof n.type!="string")throw new TypeError("Expected node, got `"+n+"`")}function T(n,e,r){if(!r)throw new Error("`"+n+"` finished async. Use `"+e+"` instead")}function y(n){return D(n)?n:new A(n)}function D(n){return!!(n&&typeof n=="object"&&"message"in n&&"messages"in n)}function N(n){return typeof n=="string"||L(n)}function L(n){return!!(n&&typeof n=="object"&&"byteLength"in n&&"byteOffset"in n)}export{F as unified};
//# sourceMappingURL=unified.mjs.map