/* esm.sh - esbuild bundle(@graphql-tools/executor@1.2.0) denonext production */
import{assertValidSchema as ee,getDirectiveValues as Se,GraphQLError as $e,isAbstractType as Fe,isLeafType as Oe,isListType as Ae,isNonNullType as re,isObjectType as P,Kind as te,locatedError as g,SchemaMetaFieldDef as K,TypeMetaFieldDef as B,TypeNameMetaFieldDef as H}from"/v135/graphql@16.8.1/denonext/graphql.mjs";import{ValueOrPromise as ne}from"/v135/value-or-promise@1.0.12/denonext/value-or-promise.mjs";import{collectSubFields as je,addPath as F,collectFields as oe,createGraphQLError as b,getArgumentValues as se,getDefinedRootType as De,GraphQLStreamDirective as qe,inspect as V,isAsyncIterable as T,isIterableObject as Pe,isObjectLike as k,isPromise as v,mapAsyncIterator as _e,memoize1 as Le,memoize3 as Te,pathToArray as w,promiseReduce as ke}from"/v135/@graphql-tools/utils@10.0.11/denonext/utils.mjs";function G(e){let r=e[Symbol.asyncIterator](),t,n,o=!1;async function s(){if(o)return{value:void 0,done:!0};try{if(!t){if(n)return await n,await s();let l;n=new Promise(c=>{l=c});let a=await r.next();return a.done?(o=!0,await s()):(t=a.value[Symbol.asyncIterator](),n=void 0,l(),await s())}let i=t,u=await t.next();return u.done?(t===i&&(t=void 0),await s()):u}catch(i){throw o=!0,i}}return{next:s,async return(){return o=!0,await Promise.all([t?.return?.(),r.return?.()]),{value:void 0,done:!0}},async throw(i){throw o=!0,await Promise.all([t?.throw?.(i),r.throw?.(i)]),i},[Symbol.asyncIterator](){return this}}}function j(e,r){if(!e)throw new Error(r??"Unexpected invariant triggered.")}async function D(e,r){let t=Object.create(null);return await new Promise((n,o)=>{r?.addEventListener("abort",()=>{n()}),Promise.all(Object.entries(e).map(async([s,i])=>{t[s]=await i})).then(()=>n(),o)}),t}import{coerceInputValue as be,isInputType as ve,isNonNullType as U,print as we,typeFromAST as ye,valueFromAST as ge}from"/v135/graphql@16.8.1/denonext/graphql.mjs";import{createGraphQLError as O,hasOwnProperty as Ie,inspect as q,printPathArray as Ee}from"/v135/@graphql-tools/utils@10.0.11/denonext/utils.mjs";function J(e,r,t,n){let o=[],s=n?.maxErrors;try{let i=Ve(e,r,t,u=>{if(s!=null&&o.length>=s)throw O("Too many errors processing variables, error limit reached. Execution aborted.");o.push(u)});if(o.length===0)return{coerced:i}}catch(i){o.push(i)}return{errors:o}}function Ve(e,r,t,n){let o={};for(let s of r){let i=s.variable.name.value,u=ye(e,s.type);if(!ve(u)){let a=we(s.type);n(O(`Variable "$${i}" expected value of type "${a}" which cannot be used as an input type.`,{nodes:s.type}));continue}if(!Ie(t,i)){if(s.defaultValue)o[i]=ge(s.defaultValue,u);else if(U(u)){let a=q(u);n(O(`Variable "$${i}" of required type "${a}" was not provided.`,{nodes:s}))}continue}let l=t[i];if(l===null&&U(u)){let a=q(u);n(O(`Variable "$${i}" of non-null type "${a}" must not be null.`,{nodes:s}));continue}o[i]=be(l,u,(a,c,p)=>{let f=`Variable "$${i}" got invalid value `+q(c);a.length>0&&(f+=` at "${i}${Ee(a)}"`),n(O(f+"; "+p.message,{nodes:s,originalError:p.originalError}))})}return o}var Re=Te((e,r,t)=>je(e.schema,e.fragments,e.variableValues,r,t));function R(e){let r=ae(e);return"schema"in r?ie(r):{errors:r.map(t=>(Object.defineProperty(t,"extensions",{value:{...t.extensions,http:{...t.extensions?.http,status:400}}}),t))}}function ie(e){return new ne(()=>Qe(e)).then(r=>{let t=W(r,e.errors);return e.subsequentPayloads.size>0?{initialResult:{...t,hasNext:!0},subsequentResults:er(e)}:t},r=>(e.errors.push(r),W(null,e.errors))).resolve()}function br(e){let r=R(e);if(v(r)||"initialResult"in r)throw new Error("GraphQL execution failed to complete synchronously.");return r}function W(e,r){return r.length===0?{data:e}:{errors:r,data:e}}function vr(e,r,t){console.assert(!!r,"Must provide document."),ee(e),console.assert(t==null||k(t),"Variables must be provided as an Object where each property is a variable value. Perhaps look to see if an unparsed JSON string was provided.")}var ze=Le(function(r){let t=Object.create(null);for(let n of r.definitions)n.kind===te.FRAGMENT_DEFINITION&&(t[n.name.value]=n);return t});function ae(e){let{schema:r,document:t,rootValue:n,contextValue:o,variableValues:s,operationName:i,fieldResolver:u,typeResolver:l,subscribeFieldResolver:a,signal:c}=e;ee(r);let p=ze(t),f;for(let h of t.definitions)switch(h.kind){case te.OPERATION_DEFINITION:if(i==null){if(f!==void 0)return[b("Must provide operation name if query contains multiple operations.")];f=h}else h.name?.value===i&&(f=h);break;default:}if(f==null)return i!=null?[b(`Unknown operation named "${i}".`)]:[b("Must provide an operation.")];let m=f.variableDefinitions??[],d=J(r,m,s??{},{maxErrors:50});return d.errors?d.errors:{schema:r,fragments:p,rootValue:n,contextValue:o,operation:f,variableValues:d.coerced,fieldResolver:u??N,typeResolver:l??He,subscribeFieldResolver:a??N,subsequentPayloads:new Set,errors:[],signal:c}}function Me(e,r){return{...e,rootValue:r,subsequentPayloads:new Set,errors:[]}}function Qe(e){let{operation:r,schema:t,fragments:n,variableValues:o,rootValue:s}=e,i=De(t,r.operation,[r]);i==null&&b(`Schema is not configured to execute ${r.operation} operation.`,{nodes:r});let{fields:u,patches:l}=oe(t,n,o,i,r.selectionSet),a=void 0,c;r.operation==="mutation"?c=Ge(e,i,s,a,u):c=z(e,i,s,a,u);for(let p of l){let{label:f,fields:m}=p;me(e,i,s,m,f,a)}return c}function Ge(e,r,t,n,o){let s=!1;return ke(o,(i,[u,l])=>{let a=F(n,u,r.name);return e.signal?.aborted?(i[u]=null,i):new ne(()=>ue(e,r,t,l,a)).then(c=>(c===void 0||(i[u]=c,e.signal?.aborted&&!s&&(e.errors.push(b("Execution aborted",{nodes:l,path:w(a),originalError:e.signal?.reason})),s=!0)),i))},Object.create(null)).resolve()}function z(e,r,t,n,o,s){let i=Object.create(null),u=!1,l=!1;try{for(let[a,c]of o){if(e.signal?.aborted){i[a]=null;continue}let p=F(n,a,r.name),f=ue(e,r,t,c,p,s);f!==void 0&&(i[a]=f,v(f)&&(u=!0)),e.signal?.aborted&&!l&&(e.errors.push(b("Execution aborted",{nodes:c,path:w(p),originalError:e.signal?.reason})),l=!0)}}catch(a){if(u)return D(i,e.signal).finally(()=>{throw a});throw a}return u?D(i,e.signal):i}function ue(e,r,t,n,o,s){let i=s?.errors??e.errors,u=de(e.schema,r,n[0]);if(!u)return;let l=u.type,a=u.resolve??e.fieldResolver,c=le(e,u,n,r,o);try{let p=se(u,n[0],e.variableValues),f=e.contextValue,m=a(t,p,f,c),d;return v(m)?d=m.then(h=>S(e,l,n,c,o,h,s)):d=S(e,l,n,c,o,m,s),v(d)?d.then(void 0,h=>{let $=g(h,n,w(o)),I=E($,l,i);return y(e,o,s),I}):d}catch(p){let f=g(p,n,w(o)),m=E(f,l,i);return y(e,o,s),m}}function le(e,r,t,n,o){return{fieldName:r.name,fieldNodes:t,returnType:r.type,parentType:n,path:o,schema:e.schema,fragments:e.fragments,rootValue:e.rootValue,operation:e.operation,variableValues:e.variableValues}}function E(e,r,t){if(re(r))throw e;return t.push(e),null}function S(e,r,t,n,o,s,i){if(s instanceof Error)throw s;if(re(r)){let u=S(e,r.ofType,t,n,o,s,i);if(u===null)throw new Error(`Cannot return null for non-nullable field ${n.parentType.name}.${n.fieldName}.`);return u}if(s==null)return null;if(Ae(r))return Je(e,r,t,n,o,s,i);if(Oe(r))return Ke(r,s);if(Fe(r))return Be(e,r,t,n,o,s,i);if(P(r))return _(e,r,t,n,o,s,i);console.assert(!1,"Cannot complete value of unexpected output type: "+V(r))}function ce(e,r,t){if(typeof t.key=="number")return;let n=Se(qe,r[0],e.variableValues);if(n&&n.if!==!1)return j(typeof n.initialCount=="number","initialCount must be a number"),j(n.initialCount>=0,"initialCount must be a positive integer"),{initialCount:n.initialCount,label:typeof n.label=="string"?n.label:void 0}}async function Ue(e,r,t,n,o,s,i){e.signal?.addEventListener("abort",()=>{s.return?.(),e.errors.push(b("Execution aborted",{nodes:t,path:w(o),originalError:e.signal?.reason}))});let u=i?.errors??e.errors,l=ce(e,t,o),a=!1,c=[],p=0;for(;;){if(l&&typeof l.initialCount=="number"&&p>=l.initialCount){Ce(p,s,e,t,n,r,o,l.label,i);break}let f=F(o,p,void 0),m;try{if(m=await s.next(),m.done)break}catch(d){let h=g(d,t,w(f));c.push(E(h,r,u));break}fe(m.value,c,u,e,r,t,n,f,i)&&(a=!0),p+=1}return a?Promise.all(c):c}function Je(e,r,t,n,o,s,i){let u=r.ofType,l=i?.errors??e.errors;if(T(s)){let d=s[Symbol.asyncIterator]();return Ue(e,u,t,n,o,d,i)}if(!Pe(s))throw b(`Expected Iterable, but did not find one for field "${n.parentType.name}.${n.fieldName}".`);let a=ce(e,t,o),c=!1,p=i,f=[],m=0;for(let d of s){let h=F(o,m,void 0);if(a&&typeof a.initialCount=="number"&&m>=a.initialCount){p=Ze(o,h,d,e,t,n,u,a.label,p),m++;continue}fe(d,f,l,e,u,t,n,h,i)&&(c=!0),m++}return c?Promise.all(f):f}function fe(e,r,t,n,o,s,i,u,l){try{let a;if(v(e)?a=e.then(c=>S(n,o,s,i,u,c,l)):a=S(n,o,s,i,u,e,l),v(a))return r.push(a.then(void 0,c=>{let p=g(c,s,w(u)),f=E(p,o,t);return y(n,u,l),f})),!0;r.push(a)}catch(a){let c=g(a,s,w(u)),p=E(c,o,t);y(n,u,l),r.push(p)}return!1}function Ke(e,r){let t;try{t=e.serialize(r)}catch(n){throw n instanceof $e?new Error(n.message):n}if(t==null)throw new Error(`Expected \`${V(e)}.serialize(${V(r)})\` to return non-nullable value, returned: ${V(t)}`);return t}function Be(e,r,t,n,o,s,i){let u=r.resolveType??e.typeResolver,l=e.contextValue,a=u(s,l,n,r);return v(a)?a.then(c=>_(e,X(c,e,r,t,n,s),t,n,o,s,i)):_(e,X(a,e,r,t,n,s),t,n,o,s,i)}function X(e,r,t,n,o,s){if(e==null)throw b(`Abstract type "${t.name}" must resolve to an Object type at runtime for field "${o.parentType.name}.${o.fieldName}". Either the "${t.name}" type should provide a "resolveType" function or each possible type should provide an "isTypeOf" function.`,{nodes:n});if(P(e))throw b("Support for returning GraphQLObjectType from resolveType was removed in graphql-js@16.0.0 please return type name instead.");if(typeof e!="string")throw b(`Abstract type "${t.name}" must resolve to an Object type at runtime for field "${o.parentType.name}.${o.fieldName}" with value ${V(s)}, received "${V(e)}".`);let i=r.schema.getType(e);if(i==null)throw b(`Abstract type "${t.name}" was resolved to a type "${e}" that does not exist inside the schema.`,{nodes:n});if(!P(i))throw b(`Abstract type "${t.name}" was resolved to a non-object type "${e}".`,{nodes:n});if(!r.schema.isSubType(t,i))throw b(`Runtime Object type "${i.name}" is not a possible type for "${t.name}".`,{nodes:n});return i}function _(e,r,t,n,o,s,i){if(r.isTypeOf){let u=r.isTypeOf(s,e.contextValue,n);if(v(u))return u.then(l=>{if(!l)throw Y(r,s,t);return Z(e,r,t,o,s,i)});if(!u)throw Y(r,s,t)}return Z(e,r,t,o,s,i)}function Y(e,r,t){return b(`Expected value of type "${e.name}" but got: ${V(r)}.`,{nodes:t})}function Z(e,r,t,n,o,s){let{fields:i,patches:u}=Re(e,r,t),l=z(e,r,o,n,i,s);for(let a of u){let{label:c,fields:p}=a;me(e,r,o,p,c,n,s)}return l}var He=function(e,r,t,n){if(k(e)&&typeof e.__typename=="string")return e.__typename;let o=t.schema.getPossibleTypes(n),s=[];for(let i=0;i<o.length;i++){let u=o[i];if(u.isTypeOf){let l=u.isTypeOf(e,r,t);if(v(l))s[i]=l;else if(l)return u.name}}if(s.length)return Promise.all(s).then(i=>{for(let u=0;u<i.length;u++)if(i[u])return o[u].name})},N=function(e,r,t,n){if(k(e)||typeof e=="function"){let o=e[n.fieldName];return typeof o=="function"?e[n.fieldName](r,t,n):o}};function pe(e){let r=ae(e);if(!("schema"in r))return{errors:r.map(n=>(Object.defineProperty(n,"extensions",{value:{...n.extensions,http:{...n.extensions?.http,status:400}}}),n))};let t=Xe(r);return v(t)?t.then(n=>C(r,n)):C(r,t)}function M(e,r){let t=e.subsequentResults,n=!1,o=!1;return r?.addEventListener("abort",()=>{o=!0,t.throw?.(r?.reason)}),{[Symbol.asyncIterator](){return this},next(){return o?Promise.resolve({value:void 0,done:o}):n?t.next():(n=!0,Promise.resolve({value:e.initialResult,done:o}))},return(){return o=!0,t.return()},throw(s){return o=!0,t.throw(s)}}}async function*We(e,r){"initialResult"in e?yield*M(e,r):yield e}function C(e,r){return T(r)?G(_e(r[Symbol.asyncIterator](),async t=>We(await ie(Me(e,t)),e.signal),async function*(t){yield{errors:[b(t.message,{originalError:t,nodes:[e.operation]})]}})):r}function Xe(e){try{let r=Ye(e);return v(r)?r.then(void 0,t=>({errors:[t]})):r}catch(r){return{errors:[r]}}}function Ye(e){let{schema:r,fragments:t,operation:n,variableValues:o,rootValue:s}=e,i=r.getSubscriptionType();if(i==null)throw b("Schema is not configured to execute subscription operation.",{nodes:n});let{fields:u}=oe(r,t,o,i,n.selectionSet),[l,a]=[...u.entries()][0],c=a[0].name.value,p=de(r,i,a[0]);if(!p)throw b(`The subscription field "${c}" is not defined.`,{nodes:a});let f=F(void 0,l,i.name),m=le(e,p,a,i,f);try{let d=se(p,a[0],o),h=e.contextValue,I=(p.subscribe??e.subscribeFieldResolver)(s,d,h,m);return v(I)?I.then(x).then(void 0,he=>{throw g(he,a,w(f))}):x(I,e.signal)}catch(d){throw g(d,a,w(f))}}function x(e,r){if(e instanceof Error)throw e;if(!T(e))throw b(`Subscription field must return Async Iterable. Received: ${V(e)}.`);return{[Symbol.asyncIterator](){let t=e[Symbol.asyncIterator]();return r?.addEventListener("abort",()=>{t.return?.()}),t}}}function me(e,r,t,n,o,s,i){let u=new L({label:o,path:s,parentContext:i,exeContext:e}),l;try{l=z(e,r,t,s,n,u),v(l)&&(l=l.then(null,a=>(u.errors.push(a),null)))}catch(a){u.errors.push(a),l=null}u.addData(l)}function Ze(e,r,t,n,o,s,i,u,l){let a=new A({label:u,path:r,parentContext:l,exeContext:n}),c;try{try{v(t)?c=t.then(f=>S(n,i,o,s,r,f,a)):c=S(n,i,o,s,r,t,a),v(c)&&(c=c.then(void 0,f=>{let m=g(f,o,w(r)),d=E(m,i,a.errors);return y(n,r,a),d}))}catch(f){let m=g(f,o,w(r));c=E(m,i,a.errors),y(n,r,a)}}catch(f){return a.errors.push(f),y(n,e,a),a.addItems(null),a}let p;return v(c)?p=c.then(f=>[f],f=>(a.errors.push(f),y(n,e,a),null)):p=[c],a.addItems(p),a}async function Ne(e,r,t,n,o,s,i){let u;try{let{value:a,done:c}=await e.next();if(c)return s.setIsCompletedIterator(),{done:c,value:void 0};u=a}catch(a){let c=g(a,t,w(i));return{done:!0,value:E(c,o,s.errors)}}let l;try{return l=S(r,o,t,n,i,u,s),v(l)&&(l=l.then(void 0,a=>{let c=g(a,t,w(i)),p=E(c,o,s.errors);return y(r,i,s),p})),{done:!1,value:l}}catch(a){let c=g(a,t,w(i)),p=E(c,o,s.errors);return y(r,i,s),{done:!1,value:p}}}async function Ce(e,r,t,n,o,s,i,u,l){let a=e,c=l??void 0;for(;;){let p=F(i,a,void 0),f=new A({label:u,path:p,parentContext:c,iterator:r,exeContext:t}),m;try{m=await Ne(r,t,n,o,s,f,p)}catch(I){f.errors.push(I),y(t,i,f),f.addItems(null),r?.return&&r.return().catch(()=>{});return}let{done:d,value:h}=m,$;if(v(h)?$=h.then(I=>[I],I=>(f.errors.push(I),y(t,i,f),null)):$=[h],f.addItems($),d)break;c=f,a++}}function y(e,r,t){let n=w(r);e.subsequentPayloads.forEach(o=>{if(o!==t){for(let s=0;s<n.length;s++)if(o.path[s]!==n[s])return;Q(o)&&o.iterator?.return&&o.iterator.return().catch(()=>{}),e.subsequentPayloads.delete(o)}})}function xe(e){let r=[];for(let t of e.subsequentPayloads){let n={};if(t.isCompleted){if(e.subsequentPayloads.delete(t),Q(t)){let o=t.items;if(t.isCompletedIterator)continue;n.items=o}else{let o=t.data;n.data=o??null}n.path=t.path,t.label&&(n.label=t.label),t.errors.length>0&&(n.errors=t.errors),r.push(n)}}return r}function er(e){let r=!1;async function t(){if(r)return{value:void 0,done:!0};if(await Promise.race(Array.from(e.subsequentPayloads).map(i=>i.promise)),r)return{value:void 0,done:!0};let o=xe(e),s=e.subsequentPayloads.size>0;return!o.length&&s?t():(s||(r=!0),{value:o.length?{incremental:o,hasNext:s}:{hasNext:s},done:!1})}function n(){let o=[];return e.subsequentPayloads.forEach(s=>{Q(s)&&s.iterator?.return&&o.push(s.iterator.return())}),Promise.all(o)}return{[Symbol.asyncIterator](){return this},next:t,async return(){return await n(),r=!0,{value:void 0,done:!0}},async throw(o){return await n(),r=!0,Promise.reject(o)}}}var L=class{constructor(r){this.type="defer",this.label=r.label,this.path=w(r.path),this.parentContext=r.parentContext,this.errors=[],this._exeContext=r.exeContext,this._exeContext.subsequentPayloads.add(this),this.isCompleted=!1,this.data=null,this.promise=new Promise(t=>{this._resolve=n=>{t(n)}}).then(t=>{this.data=t,this.isCompleted=!0})}addData(r){let t=this.parentContext?.promise;if(t){this._resolve?.(t.then(()=>r));return}this._resolve?.(r)}},A=class{constructor(r){this.type="stream",this.items=null,this.label=r.label,this.path=w(r.path),this.parentContext=r.parentContext,this.iterator=r.iterator,this.errors=[],this._exeContext=r.exeContext,this._exeContext.subsequentPayloads.add(this),this.isCompleted=!1,this.items=null,this.promise=new Promise(t=>{this._resolve=n=>{t(n)}}).then(t=>{this.items=t,this.isCompleted=!0})}addItems(r){let t=this.parentContext?.promise;if(t){this._resolve?.(t.then(()=>r));return}this._resolve?.(r)}setIsCompletedIterator(){this.isCompletedIterator=!0}};function Q(e){return e.type==="stream"}function de(e,r,t){let n=t.name.value;return n===K.name&&e.getQueryType()===r?K:n===B.name&&e.getQueryType()===r?B:n===H.name?H:r.getFields()[n]}function wr(e){return"incremental"in e}import{getOperationAST as rr}from"/v135/graphql@16.8.1/denonext/graphql.mjs";import{ValueOrPromise as tr}from"/v135/value-or-promise@1.0.12/denonext/value-or-promise.mjs";function Vr(e){let r=rr(e.document,e.operationName);if(r==null)throw new Error("Must provide an operation.");return r.operation==="subscription"?pe(e):new tr(()=>R(e)).then(t=>"initialResult"in t?M(t,e.signal):t).resolve()}export{vr as assertValidExecutionArguments,ae as buildExecutionContext,le as buildResolveInfo,N as defaultFieldResolver,He as defaultTypeResolver,R as execute,br as executeSync,M as flattenIncrementalResults,de as getFieldDef,ze as getFragmentsFromDocument,J as getVariableValues,wr as isIncrementalResult,Vr as normalizedExecutor,pe as subscribe};
//# sourceMappingURL=executor.mjs.map