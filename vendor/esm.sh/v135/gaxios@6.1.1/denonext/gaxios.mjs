/* esm.sh - esbuild bundle(gaxios@6.1.1) denonext production */
import __Process$ from "node:process";
import { Buffer as __Buffer$ } from "node:buffer";
import * as __0$ from "node:url";
import * as __1$ from "/v135/extend@3.0.2/denonext/extend.mjs";
import * as __2$ from "node:https";
import * as __3$ from "/v135/node_fetch.js";
import * as __4$ from "node:querystring";
import * as __5$ from "/v135/is-stream@2.0.1/denonext/is-stream.mjs";
import * as __6$ from "node:url";
import * as __7$ from "/v135/https-proxy-agent@7.0.2/denonext/https-proxy-agent.mjs";
var require=n=>{const e=m=>typeof m.default<"u"?m.default:m,c=m=>Object.assign({},m);switch(n){case"url":return e(__0$);case"extend":return e(__1$);case"https":return e(__2$);case"node-fetch":return c(__3$);case"querystring":return e(__4$);case"is-stream":return e(__5$);case"https-proxy-agent":return c(__7$);default:throw new Error("module \""+n+"\" not found");}};
var M=Object.create;var _=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var u=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var y=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),z=(r,t)=>{for(var e in t)_(r,e,{get:t[e],enumerable:!0})},m=(r,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of B(t))!H.call(r,o)&&o!==e&&_(r,o,{get:()=>t[o],enumerable:!(s=N(t,o))||s.enumerable});return r},f=(r,t,e)=>(m(r,t,"default"),e&&m(e,t,"default")),T=(r,t,e)=>(e=r!=null?M(F(r)):{},m(t||!r||!r.__esModule?_(e,"default",{value:r,enumerable:!0}):e,r));var x=y(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.defaultErrorRedactor=d.GaxiosError=void 0;var J=u("url"),v=class extends Error{constructor(t,e,s,o){if(super(t),this.config=e,this.response=s,this.error=o,this.response){try{this.response.data=I(e.responseType,s?.data)}catch{}this.status=this.response.status}if(o&&"code"in o&&o.code&&(this.code=o.code),e.errorRedactor){let n=e.errorRedactor;this.config={...e},this.response&&(this.response={...this.response,config:{...this.response.config}});let a=n({config:e,response:s});this.config={...e,...a.config},this.response&&(this.response={...this.response,...a.response,config:e})}}};d.GaxiosError=v;function I(r,t){switch(r){case"stream":return t;case"json":return JSON.parse(JSON.stringify(t));case"arraybuffer":return JSON.parse(__Buffer$.from(t).toString("utf8"));case"blob":return JSON.parse(t.text());default:return t}}function E(r){let t="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function e(n){if(n)for(let a of Object.keys(n))/^authentication$/.test(a)&&(n[a]=t)}function s(n,a){if(typeof n=="object"&&n!==null&&typeof n[a]=="string"){let p=n[a];(/grant_type=/.test(p)||/assertion=/.test(p))&&(n[a]=t)}}function o(n){typeof n=="object"&&n!==null&&("grant_type"in n&&(n.grant_type=t),"assertion"in n&&(n.assertion=t))}if(r.config){e(r.config.headers),s(r.config,"data"),o(r.config.data),s(r.config,"body"),o(r.config.body);try{let n=new J.URL(r.config.url||"");n.searchParams.has("token")&&n.searchParams.set("token",t),r.config.url=n.toString()}catch{}}return r.response&&(E({config:r.response.config}),e(r.response.headers),s(r.response,"data"),o(r.response.data)),r}d.defaultErrorRedactor=E});var A=y(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.getRetryConfig=void 0;async function W(r){var t;let e=q(r);if(!r||!r.config||!e&&!r.config.retry)return{shouldRetry:!1};e=e||{},e.currentRetryAttempt=e.currentRetryAttempt||0,e.retry=e.retry===void 0||e.retry===null?3:e.retry,e.httpMethodsToRetry=e.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],e.noResponseRetries=e.noResponseRetries===void 0||e.noResponseRetries===null?2:e.noResponseRetries;let s=[[100,199],[429,429],[500,599]];if(e.statusCodesToRetry=e.statusCodesToRetry||s,r.config.retryConfig=e,!await(e.shouldRetry||X)(r))return{shouldRetry:!1,config:r.config};let a=(e.currentRetryAttempt?0:(t=e.retryDelay)!==null&&t!==void 0?t:100)+(Math.pow(2,e.currentRetryAttempt)-1)/2*1e3;r.config.retryConfig.currentRetryAttempt+=1;let p=e.retryBackoff?e.retryBackoff(r,a):new Promise(j=>{setTimeout(j,a)});return e.onRetryAttempt&&e.onRetryAttempt(r),await p,{shouldRetry:!0,config:r.config}}h.getRetryConfig=W;function X(r){var t;let e=q(r);if(r.name==="AbortError"||((t=r.error)===null||t===void 0?void 0:t.name)==="AbortError"||!e||e.retry===0||!r.response&&(e.currentRetryAttempt||0)>=e.noResponseRetries||!r.config.method||e.httpMethodsToRetry.indexOf(r.config.method.toUpperCase())<0)return!1;if(r.response&&r.response.status){let s=!1;for(let[o,n]of e.statusCodesToRetry){let a=r.response.status;if(a>=o&&a<=n){s=!0;break}}if(!s)return!1}return e.currentRetryAttempt=e.currentRetryAttempt||0,!(e.currentRetryAttempt>=e.retry)}function q(r){if(r&&r.config&&r.config.retryConfig)return r.config.retryConfig}});var D=y(l=>{"use strict";var R=l&&l.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(l,"__esModule",{value:!0});l.Gaxios=void 0;var Y=R(u("extend")),$=u("https"),Q=R(u("node-fetch")),K=R(u("querystring")),V=R(u("is-stream")),P=u("url"),g=x(),Z=A(),ee=u("https-proxy-agent"),te=ne()?window.fetch:Q.default;function re(){return typeof window<"u"&&!!window}function ne(){return re()&&!!window.fetch}function se(){return typeof __Buffer$<"u"}function O(r,t){return!!S(r,t)}function S(r,t){t=t.toLowerCase();for(let e of Object.keys(r?.headers||{}))if(t===e.toLowerCase())return r.headers[e]}var w;function k(){var r,t,e,s;let o=((r=__Process$?.env)===null||r===void 0?void 0:r.HTTPS_PROXY)||((t=__Process$?.env)===null||t===void 0?void 0:t.https_proxy)||((e=__Process$?.env)===null||e===void 0?void 0:e.HTTP_PROXY)||((s=__Process$?.env)===null||s===void 0?void 0:s.http_proxy);return o&&(w=ee.HttpsProxyAgent),o}k();function oe(r){var t;let e=(t=__Process$.env.NO_PROXY)!==null&&t!==void 0?t:__Process$.env.no_proxy;if(!e)return!1;let s=e.split(","),o=new P.URL(r);return!!s.find(n=>n.startsWith("*.")||n.startsWith(".")?(n=n.replace(/^\*\./,"."),o.hostname.endsWith(n)):n===o.origin||n===o.hostname)}function ae(r){if(!oe(r))return k()}var b=class{constructor(t){this.agentCache=new Map,this.defaults=t||{}}async request(t={}){return t=this.validateOpts(t),this._request(t)}async _defaultAdapter(t){let s=await(t.fetchImplementation||te)(t.url,t),o=await this.getResponseData(t,s);return this.translateResponse(t,s,o)}async _request(t={}){try{let e;if(t.adapter?e=await t.adapter(t,this._defaultAdapter.bind(this)):e=await this._defaultAdapter(t),!t.validateStatus(e.status)){if(t.responseType==="stream"){let s="";await new Promise(o=>{(e?.data).on("data",n=>{s+=n}),(e?.data).on("end",o)}),e.data=s}throw new g.GaxiosError(`Request failed with status code ${e.status}`,t,e)}return e}catch(e){let s=e instanceof g.GaxiosError?e:new g.GaxiosError(e.message,t,void 0,e),{shouldRetry:o,config:n}=await(0,Z.getRetryConfig)(s);if(o&&n)return s.config.retryConfig.currentRetryAttempt=n.retryConfig.currentRetryAttempt,this._request(s.config);throw s}}async getResponseData(t,e){switch(t.responseType){case"stream":return e.body;case"json":{let s=await e.text();try{s=JSON.parse(s)}catch{}return s}case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"text":return e.text();default:return this.getResponseDataFromContentType(e)}}validateOpts(t){let e=(0,Y.default)(!0,{},this.defaults,t);if(!e.url)throw new Error("URL is required.");let s=e.baseUrl||e.baseURL;if(s&&(e.url=s+e.url),e.paramsSerializer=e.paramsSerializer||this.paramsSerializer,e.params&&Object.keys(e.params).length>0){let n=e.paramsSerializer(e.params);n.startsWith("?")&&(n=n.slice(1));let a=e.url.includes("?")?"&":"?";e.url=e.url+a+n}if(typeof t.maxContentLength=="number"&&(e.size=t.maxContentLength),typeof t.maxRedirects=="number"&&(e.follow=t.maxRedirects),e.headers=e.headers||{},e.data){let n=typeof FormData>"u"?!1:e?.data instanceof FormData;V.default.readable(e.data)?e.body=e.data:se()&&__Buffer$.isBuffer(e.data)?(e.body=e.data,O(e,"Content-Type")||(e.headers["Content-Type"]="application/json")):typeof e.data=="object"?n||(S(e,"content-type")==="application/x-www-form-urlencoded"?e.body=e.paramsSerializer(e.data):(O(e,"Content-Type")||(e.headers["Content-Type"]="application/json"),e.body=JSON.stringify(e.data))):e.body=e.data}e.validateStatus=e.validateStatus||this.validateStatus,e.responseType=e.responseType||"unknown",!e.headers.Accept&&e.responseType==="json"&&(e.headers.Accept="application/json"),e.method=e.method||"GET";let o=ae(e.url);if(o)if(this.agentCache.has(o))e.agent=this.agentCache.get(o);else{if(e.cert&&e.key){let n=new P.URL(o);e.agent=new w({port:n.port,host:n.host,protocol:n.protocol,cert:e.cert,key:e.key})}else e.agent=new w(o);this.agentCache.set(o,e.agent)}else e.cert&&e.key&&(this.agentCache.has(e.key)?e.agent=this.agentCache.get(e.key):(e.agent=new $.Agent({cert:e.cert,key:e.key}),this.agentCache.set(e.key,e.agent)));return typeof e.errorRedactor!="function"&&e.errorRedactor!==!1&&(e.errorRedactor=g.defaultErrorRedactor),e}validateStatus(t){return t>=200&&t<300}paramsSerializer(t){return K.default.stringify(t)}translateResponse(t,e,s){let o={};return e.headers.forEach((n,a)=>{o[a]=n}),{config:t,data:s,headers:o,status:e.status,statusText:e.statusText,request:{responseURL:e.url}}}async getResponseDataFromContentType(t){let e=t.headers.get("Content-Type");if(e===null)return t.text();if(e=e.toLowerCase(),e.includes("application/json")){let s=await t.text();try{s=JSON.parse(s)}catch{}return s}else return e.includes("text/plain")||e.includes("text/html")?t.text():t.blob()}};l.Gaxios=b});var C=y(i=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.request=i.instance=i.Gaxios=i.GaxiosError=void 0;var G=D();Object.defineProperty(i,"Gaxios",{enumerable:!0,get:function(){return G.Gaxios}});var ie=x();Object.defineProperty(i,"GaxiosError",{enumerable:!0,get:function(){return ie.GaxiosError}});i.instance=new G.Gaxios;async function ue(r){return i.instance.request(r)}i.request=ue});var c={};z(c,{Gaxios:()=>le,GaxiosError:()=>pe,__esModule:()=>ce,default:()=>he,instance:()=>de,request:()=>fe});var U=T(C());f(c,T(C()));var{__esModule:ce,request:fe,instance:de,Gaxios:le,GaxiosError:pe}=U,{default:L,...ye}=U,he=L!==void 0?L:ye;export{le as Gaxios,pe as GaxiosError,ce as __esModule,he as default,de as instance,fe as request};
//# sourceMappingURL=gaxios.mjs.map