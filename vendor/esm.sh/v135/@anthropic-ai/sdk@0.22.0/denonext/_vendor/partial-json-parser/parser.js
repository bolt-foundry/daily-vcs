/* esm.sh - esbuild bundle(@anthropic-ai/sdk@0.22.0/_vendor/partial-json-parser/parser) denonext production */
var p=e=>{let l=0,r=[];for(;l<e.length;){let a=e[l];if(a==="\\"){l++;continue}if(a==="{"){r.push({type:"brace",value:"{"}),l++;continue}if(a==="}"){r.push({type:"brace",value:"}"}),l++;continue}if(a==="["){r.push({type:"paren",value:"["}),l++;continue}if(a==="]"){r.push({type:"paren",value:"]"}),l++;continue}if(a===":"){r.push({type:"separator",value:":"}),l++;continue}if(a===","){r.push({type:"delimiter",value:","}),l++;continue}if(a==='"'){let t="",u=!1;for(a=e[++l];a!=='"';){if(l===e.length){u=!0;break}if(a==="\\"){if(l++,l===e.length){u=!0;break}t+=a+e[l],a=e[++l]}else t+=a,a=e[++l]}a=e[++l],u||r.push({type:"string",value:t});continue}if(a&&/\s/.test(a)){l++;continue}let h=/[0-9]/;if(a&&h.test(a)||a==="-"||a==="."){let t="";for(a==="-"&&(t+=a,a=e[++l]);a&&h.test(a)||a===".";)t+=a,a=e[++l];r.push({type:"number",value:t});continue}let f=/[a-z]/i;if(a&&f.test(a)){let t="";for(;a&&f.test(a)&&l!==e.length;)t+=a,a=e[++l];if(t=="true"||t=="false")r.push({type:"name",value:t});else throw new Error(`Invalid token: ${t} is not a valid token!`);continue}l++}return r},i=e=>{if(e.length===0)return e;let l=e[e.length-1];switch(l.type){case"separator":return e=e.slice(0,e.length-1),i(e);break;case"number":let r=l.value[l.value.length-1];if(r==="."||r==="-")return e=e.slice(0,e.length-1),i(e);case"string":let a=e[e.length-2];if(a?.type==="delimiter")return e=e.slice(0,e.length-1),i(e);if(a?.type==="brace"&&a.value==="{")return e=e.slice(0,e.length-1),i(e);break;case"delimiter":return e=e.slice(0,e.length-1),i(e);break}return e},c=e=>{let l=[];return e.map(r=>{r.type==="brace"&&(r.value==="{"?l.push("}"):l.splice(l.lastIndexOf("}"),1)),r.type==="paren"&&(r.value==="["?l.push("]"):l.splice(l.lastIndexOf("]"),1))}),l.length>0&&l.reverse().map(r=>{r==="}"?e.push({type:"brace",value:"}"}):r==="]"&&e.push({type:"paren",value:"]"})}),e},s=e=>{let l="";return e.map(r=>{switch(r.type){case"string":l+='"'+r.value+'"';break;default:l+=r.value;break}}),l},v=e=>JSON.parse(s(c(i(p(e)))));export{v as partialParse};
//# sourceMappingURL=parser.js.map